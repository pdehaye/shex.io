<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta name="viewport" content="width=device-width" /><meta charset="utf-8" /><meta name="generator" content="ReSpec 24.32.1" /><style>/* --- EXAMPLES --- */
span.example-title {
    text-transform: none;
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example span.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
.issue-label {
    text-transform: initial;
}

.warning &gt; p:first-child { margin-top: 0 }
.warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
span.warning { padding: .1em .5em .15em; }

.issue.closed span.issue-number {
    text-decoration: line-through;
}

.warning {
    border-color: #f11;
    border-width: .2em;
    border-style: solid;
    background: #fbe9e9;
}

.warning-title:before{
    content: "⚠"; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
}

li.task-list-item {
    list-style: none;
}

input.task-list-item-checkbox {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
}

.issue a.respec-gh-label {
  padding: 5px;
  margin: 0 2px 0 2px;
  font-size: 10px;
  text-transform: none;
  text-decoration: none;
  font-weight: bold;
  border-radius: 4px;
  position: relative;
  bottom: 2px;
  border: none;
}

.issue a.respec-label-dark {
  color: #fff;
  background-color: #000;
}

.issue a.respec-label-light {
  color: #000;
  background-color: #fff;
}
</style>
    
    
    <title>Shape Expressions Language 2.1</title>
    
    <link rel="stylesheet" href="local.css" />

    
    
    <script src="jquery-2.1.4.min.js" type="text/javascript"></script>

    

    <script src="./shex-parser-browserify.js"></script>
    <script type="text/javascript" src="scripts.js"></script>
  <style id="respec-mainstyle">/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

@keyframes pop {
  0% {
    transform: scale(1, 1);
  }
  25% {
    transform: scale(1.25, 1.25);
    opacity: 0.75;
  }
  100% {
    transform: scale(1, 1);
  }
}

/* Override code highlighter background */
.hljs {
  background: transparent !important;
}

/* --- INLINES --- */
h1 abbr,
h2 abbr,
h3 abbr,
h4 abbr,
h5 abbr,
h6 abbr,
a abbr {
  border: none;
}

dfn {
  font-weight: bold;
}

a.internalDFN {
  color: inherit;
  border-bottom: 1px solid #99c;
  text-decoration: none;
}

a.externalDFN {
  color: inherit;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
}

a.bibref {
  text-decoration: none;
}

.respec-offending-element:target {
  animation: pop 0.25s ease-in-out 0s 1;
}

.respec-offending-element,
a[href].respec-offending-element {
  text-decoration: red wavy underline;
}
@supports not (text-decoration: red wavy underline) {
  .respec-offending-element:not(pre) {
    display: inline-block;
  }
  .respec-offending-element {
    /* Red squiggly line */
    background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=)
      bottom repeat-x;
  }
}

#references :target {
  background: #eaf3ff;
  animation: pop 0.4s ease-in-out 0s 1;
}

cite .bibref {
  font-style: normal;
}

code {
  color: #c83500;
}

th code {
  color: inherit;
}

a[href].orcid {
    padding-left: 4px;
    padding-right: 4px;
}

a[href].orcid &gt; svg {
    margin-bottom: -2px;
}

/* --- TOC --- */

.toc a,
.tof a {
  text-decoration: none;
}

a .secno,
a .figno {
  color: #000;
}

ul.tof,
ol.tof {
  list-style: none outside none;
}

.caption {
  margin-top: 0.5em;
  font-style: italic;
}

/* --- TABLE --- */

table.simple {
  border-spacing: 0;
  border-collapse: collapse;
  border-bottom: 3px solid #005a9c;
}

.simple th {
  background: #005a9c;
  color: #fff;
  padding: 3px 5px;
  text-align: left;
}

.simple th[scope="row"] {
  background: inherit;
  color: inherit;
  border-top: 1px solid #ddd;
}

.simple td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
  background: #f0f6ff;
}

/* --- DL --- */

.section dd &gt; p:first-child {
  margin-top: 0;
}

.section dd &gt; p:last-child {
  margin-bottom: 0;
}

.section dd {
  margin-bottom: 1em;
}

.section dl.attrs dd,
.section dl.eldef dd {
  margin-bottom: 0;
}

#issue-summary &gt; ul,
.respec-dfn-list {
  column-count: 2;
}

#issue-summary li,
.respec-dfn-list li {
  list-style: none;
}

details.respec-tests-details {
  margin-left: 1em;
  display: inline-block;
  vertical-align: top;
}

details.respec-tests-details &gt; * {
  padding-right: 2em;
}

details.respec-tests-details[open] {
  z-index: 999999;
  position: absolute;
  border: thin solid #cad3e2;
  border-radius: 0.3em;
  background-color: white;
  padding-bottom: 0.5em;
}

details.respec-tests-details[open] &gt; summary {
  border-bottom: thin solid #cad3e2;
  padding-left: 1em;
  margin-bottom: 1em;
  line-height: 2em;
}

details.respec-tests-details &gt; ul {
  width: 100%;
  margin-top: -0.3em;
}

details.respec-tests-details &gt; li {
  padding-left: 1em;
}

a[href].self-link:hover {
  opacity: 1;
  text-decoration: none;
  background-color: transparent;
}

h2,
h3,
h4,
h5,
h6 {
  position: relative;
}

aside.example .marker &gt; a.self-link {
  color: inherit;
}

h2 &gt; a.self-link,
h3 &gt; a.self-link,
h4 &gt; a.self-link,
h5 &gt; a.self-link,
h6 &gt; a.self-link {
  border: none;
  color: inherit;
  font-size: 83%;
  height: 2em;
  left: -1.6em;
  opacity: 0.5;
  position: absolute;
  text-align: center;
  text-decoration: none;
  top: 0;
  transition: opacity 0.2s;
  width: 2em;
}

h2 &gt; a.self-link::before,
h3 &gt; a.self-link::before,
h4 &gt; a.self-link::before,
h5 &gt; a.self-link::before,
h6 &gt; a.self-link::before {
  content: "§";
  display: block;
}

@media (max-width: 767px) {
  dd {
    margin-left: 0;
  }

  /* Don't position self-link in headings off-screen */
  h2 &gt; a.self-link,
  h3 &gt; a.self-link,
  h4 &gt; a.self-link,
  h5 &gt; a.self-link,
  h6 &gt; a.self-link {
    left: auto;
    top: auto;
  }
}

@media print {
  .removeOnSave {
    display: none;
  }
}
</style><link rel="canonical" href="https://www.w3.org/TR/shex-semantics/" /><style>/*

github.com style (c) Vasily Polovnyov &lt;vast@whiteants.net&gt;

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
}

.hljs-comment,
.hljs-quote {
  color: #998;
  font-style: italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
  color: #333;
  font-weight: bold;
}

.hljs-number,
.hljs-literal,
.hljs-variable,
.hljs-template-variable,
.hljs-tag .hljs-attr {
  color: #008080;
}

.hljs-string,
.hljs-doctag {
  color: #d14;
}

.hljs-title,
.hljs-section,
.hljs-selector-id {
  color: #900;
  font-weight: bold;
}

.hljs-subst {
  font-weight: normal;
}

.hljs-type,
.hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
}

.hljs-tag,
.hljs-name,
.hljs-attribute {
  color: #000080;
  font-weight: normal;
}

.hljs-regexp,
.hljs-link {
  color: #009926;
}

.hljs-symbol,
.hljs-bullet {
  color: #990073;
}

.hljs-built_in,
.hljs-builtin-name {
  color: #0086b3;
}

.hljs-meta {
  color: #999;
  font-weight: bold;
}

.hljs-deletion {
  background: #fdd;
}

.hljs-addition {
  background: #dfd;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
</style><style>var {
  position: relative;
  cursor: pointer;
}

var[data-type]::before,
var[data-type]::after {
  position: absolute;
  left: 50%;
  top: -6px;
  opacity: 0;
  transition: opacity 0.4s;
  pointer-events: none;
}

/* the triangle or arrow or caret or whatever */
var[data-type]::before {
  content: "";
  transform: translateX(-50%);
  border-width: 4px 6px 0 6px;
  border-style: solid;
  border-color: transparent;
  border-top-color: #000;
}

/* actual text */
var[data-type]::after {
  content: attr(data-type);
  transform: translateX(-50%) translateY(-100%);
  background: #000;
  text-align: center;
  /* additional styling */
  font-family: "Dank Mono", "Fira Code", monospace;
  font-style: normal;
  padding: 6px;
  border-radius: 3px;
  color: #daca88;
  text-indent: 0;
  font-weight: normal;
}

var[data-type]:hover::after,
var[data-type]:hover::before {
  opacity: 1;
}
</style><script id="initialUserConfig" type="application/json">{
  "github": "https://github.com/shexSpec/spec/",
  "localBiblio": {
    "shex-vocab": {
      "authors": [
        "Gregg Kellogg"
      ],
      "title": "Shape Expression Vocabulary",
      "href": "http://www.w3.org/ns/shex#",
      "id": "shex-vocab"
    },
    "shape-map": {
      "authors": [
        "Eric Prud'hommeaux",
        "Thomas Baker"
      ],
      "title": "ShapeMap Structure and Language",
      "href": "http://shex.io/shape-map/",
      "id": "shape-map"
    }
  },
  "specStatus": "CG-FINAL",
  "shortName": "shex-semantics",
  "latestVersion": "http://shex.io/shex-semantics/",
  "prevVersion": "http://shex.io/shex-semantics-20170713",
  "edDraftURI": "https://shexspec.github.io/spec/",
  "previousPublishDate": "2014-06-02",
  "previousMaturity": "Member-SUBM",
  "testSuiteURI": "https://github.com/shexSpec/shexTest",
  "issueBase": "https://github.com/shexSpec/shex/issues",
  "githubAPI": "https://api.github.com/repos/shexSpec/spec",
  "editors": [
    {
      "name": "Eric Prud'hommeaux",
      "url": "http://www.w3.org/People/Eric/",
      "company": "W3C/MIT",
      "companyURL": "http://www.w3.org/"
    },
    {
      "name": "Iovka Boneva",
      "url": "http://cristal.univ-lille.fr/~boneva/",
      "company": "University of Lille",
      "companyURL": "http://www.univ-lille1.fr/"
    },
    {
      "name": "Jose Emilio Labra Gayo",
      "url": "http://di002.edv.uniovi.es/~labra/",
      "company": "University of Oviedo",
      "companyURL": "http://www.uniovi.es/"
    },
    {
      "name": "Gregg Kellogg",
      "url": "http://greggkellogg.net/",
      "company": "Spec-Ops",
      "companyURL": "https://spec-ops.io/",
      "w3cid": "44770"
    }
  ],
  "wg": "Shape Expressions Community Group",
  "wgURI": "https://www.w3.org/community/shex/",
  "bugTracker": {
    "open": "https://github.com/shexSpec/spec/issues",
    "new": "https://github.com/shexSpec/spec/issues/new"
  },
  "otherLinks": [
    {
      "key": "Participate",
      "data": [
        {
          "value": "GitHub shexSpec/spec",
          "href": "https://github.com/shexSpec/spec/"
        },
        {
          "value": "File a bug",
          "href": "https://github.com/shexSpec/spec/issues/"
        },
        {
          "value": "Commit history",
          "href": "https://github.com/shexSpec/spec/commits/gh-pages"
        },
        {
          "value": "Pull requests",
          "href": "https://github.com/shexSpec/spec/pulls/"
        }
      ]
    },
    {
      "key": "ShEx language",
      "data": [
        {
          "value": "Homepage",
          "href": "https://shex.io/"
        },
        {
          "value": "Issues",
          "href": "https://github.com/shexSpec/shex/issues"
        },
        {
          "value": "Gitter chat",
          "href": "https://gitter.im/shapeExpressions/Lobby"
        }
      ]
    }
  ],
  "publishISODate": "2019-07-31T00:00:00.000Z",
  "generatedSubtitle": "Final Community Group Report 9 August 2019"
}</script><meta name="description" content="The Shape Expressions (ShEx) language describes RDF nodes and graph structures.&#10;        A node constraint describes an RDF node (IRI, blank node or literal) and a shape describes the triples involving nodes in an RDF graph.&#10;        These descriptions identify predicates and their associated cardinalities and datatypes.&#10;        ShEx shapes can be used to communicate data structures associated with some process or interface, generate or validate data, or drive user interfaces." /><link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/cg-final" /></head>
  
  <body class="h-entry"><div class="head">
      <a class="logo" href="https://www.w3.org/"><img alt="W3C" width="72" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" /></a>
      <h1 class="title p-name" id="title">Shape Expressions Language 2.1</h1>
      
      <h2>
        Final Community Group Report
        <time class="dt-published" datetime="2019-07-31">8 October 2019</time>
      </h2>
      <dl>
        
        <dt>This version:</dt><dd><a href="http://shex.io/shex-semantics-20191008/">http://shex.io/shex-semantics-20191008/</a></dd>
        <dt>Latest published version:</dt><dd>
                <a href="http://shex.io/shex-semantics/">http://shex.io/shex-semantics/</a>
              </dd>
        <dt>Editor's draft:</dt><dd><a href="https://shexspec.github.io/spec/">https://shexspec.github.io/spec/</a></dd>
        <dt>Previous version:</dt><dd><a href="http://shex.io/shex-semantics-20181122/">http://shex.io/shex-semantics-20181122/</a></dd>
        <dt>Test suite:</dt><dd><a href="https://github.com/shexSpec/shexTest">https://github.com/shexSpec/shexTest</a></dd>
        
        <dt>Bug tracker:</dt><dd><a href="https://github.com/shexSpec/spec/issues/new">File a bug</a> (<a href="https://github.com/shexSpec/spec/issues">open bugs</a>)</dd>
        
        <dt>Editors:</dt>
        <dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="http://www.w3.org/People/Eric/">Eric Prud'hommeaux</a>
            (<a class="p-org org h-org h-card" href="http://www.w3.org/">W3C/MIT</a>)
          </dd><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="http://cristal.univ-lille.fr/~boneva/">Iovka Boneva</a>
            (<a class="p-org org h-org h-card" href="http://www.univ-lille1.fr/">University of Lille</a>)
          </dd><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="http://di002.edv.uniovi.es/~labra/">Jose Emilio Labra Gayo</a>
            (<a class="p-org org h-org h-card" href="http://www.uniovi.es/">University of Oviedo</a>)
          </dd><dd class="p-author h-card vcard" data-editor-id="44770"><a class="u-url url p-name fn" href="http://greggkellogg.net/">Gregg Kellogg</a>
            (<a class="p-org org h-org h-card" href="https://spec-ops.io/">Spec-Ops</a>)
          </dd>
        
        
        <dt>Participate:</dt><dd>
      <a href="https://github.com/shexSpec/spec/">GitHub shexSpec/spec</a>
    </dd><dd>
      <a href="https://github.com/shexSpec/spec/issues/">File a bug</a>
    </dd><dd>
      <a href="https://github.com/shexSpec/spec/commits/gh-pages">Commit history</a>
    </dd><dd>
      <a href="https://github.com/shexSpec/spec/pulls/">Pull requests</a>
    </dd><dt>ShEx language:</dt><dd>
      <a href="https://shex.io/">Homepage</a>
    </dd><dd>
      <a href="https://github.com/shexSpec/shex/issues">Issues</a>
    </dd><dd>
      <a href="https://gitter.im/shapeExpressions/Lobby">Gitter chat</a>
    </dd>
      </dl>
      
      <p class="copyright">
        <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
        ©
        2019
        
        the Contributors to the Shape Expressions Language 2.1 Specification, published by the
        <a href="https://www.w3.org/community/shex/">Shape Expressions Community Group</a> under the
        <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable
              <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a>
              is available.
            
      </p>
      <hr title="Separator for header" />
    </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
        The Shape Expressions (ShEx) language describes <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">RDF nodes</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> structures.
        A <span class="math">node constraint</span> describes an RDF node (<a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a>) and a <span class="math">shape</span> describes the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a> involving nodes in an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a>.
        These descriptions identify <a data-lt="predicate" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicates</a> and their associated cardinalities and datatypes.
        ShEx shapes can be used to communicate data structures associated with some process or interface, generate or validate data, or drive user interfaces.
      </p>
      <p>
        This document defines the ShEx language.
        See the <a href="../primer/index.html">Shape Expressions Primer</a> for a non-normative description of ShEx.
      </p>
    </section>

    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This specification was published by the
      <a href="https://www.w3.org/community/shex/">Shape Expressions Community Group</a>. It is not a W3C Standard nor is it
      on the W3C Standards Track.
      
            Please note that under the
            <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>
            there is a limited opt-out and other conditions apply.
          
      Learn more about
      <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>.
    </p>
      <p>
        ShEx 2.1 adds IMPORTS and language tag value sets to <a href="http://shex.io/shex-semantics-20181122/">ShEx 2.1</a>.
        No tests changed as a result of this and no implementations or applications are known to have been affected.
      </p>
      <p>
        If you wish to make comments regarding this document, please raise them as GitHub issues.
        There are separate interfaces for <a href="https://github.com/shexSpec/spec/issues">specification</a>, <a href="https://github.com/shexSpec/shex/issues">language</a> and <a href="https://github.com/shexSpec/shexTest/issues">test</a> issues.
        Only send comments to <a href="mailto:public-shex@w3.org">public-shex@w3.org</a>     (<a href="mailto:public-shex-request@w3.org?subject=subscribe">subscribe</a>,
    <a href="https://lists.w3.org/Archives/Public/public-shex/">archives</a>) if you are unable to raise issues on GitHub. All comments are welcome.
      </p>
    </section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#notation"><bdi class="secno">2. </bdi>Notation</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#json-grammar"><bdi class="secno">2.1 </bdi>JSON Grammar</a></li><li class="tocline"><a class="tocxref" href="#shex-references"><bdi class="secno">2.2 </bdi>References</a></li><li class="tocline"><a class="tocxref" href="#style"><bdi class="secno">2.3 </bdi>Document style</a></li><li class="tocline"><a class="tocxref" href="#graphAccess"><bdi class="secno">2.4 </bdi>Graph access</a></li><li class="tocline"><a class="tocxref" href="#process"><bdi class="secno">2.5 </bdi>Validation process</a></li></ol></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">3. </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">4. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#shapes-language"><bdi class="secno">5. </bdi>The Shape Expressions Language</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#shapes-schema"><bdi class="secno">5.1 </bdi>Shapes Schema</a></li><li class="tocline"><a class="tocxref" href="#validation"><bdi class="secno">5.2 </bdi>Validation Definition</a></li><li class="tocline"><a class="tocxref" href="#shape-expressions"><bdi class="secno">5.3 </bdi>Shape Expressions</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#shape-expressions-shexj"><bdi class="secno">5.3.1 </bdi>JSON Syntax</a></li><li class="tocline"><a class="tocxref" href="#shape-expression-semantics"><bdi class="secno">5.3.2 </bdi>Semantics</a></li></ol></li><li class="tocline"><a class="tocxref" href="#node-constraints"><bdi class="secno">5.4 </bdi>Node Constraints</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#node-constraint-semantics"><bdi class="secno">5.4.1 </bdi>Semantics</a></li><li class="tocline"><a class="tocxref" href="#nodeKind"><bdi class="secno">5.4.2 </bdi>Node Kind Constraints</a></li><li class="tocline"><a class="tocxref" href="#datatype"><bdi class="secno">5.4.3 </bdi>Datatype Constraints</a></li><li class="tocline"><a class="tocxref" href="#xs-string"><bdi class="secno">5.4.4 </bdi>XML Schema String Facet Constraints</a></li><li class="tocline"><a class="tocxref" href="#xs-numeric"><bdi class="secno">5.4.5 </bdi>XML Schema Numeric Facet Constraints</a></li><li class="tocline"><a class="tocxref" href="#values"><bdi class="secno">5.4.6 </bdi>Values Constraint</a></li></ol></li><li class="tocline"><a class="tocxref" href="#shapes-and-TEs"><bdi class="secno">5.5 </bdi>Shapes and Triple Expressions</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#triple-expressions-abstract-syntax"><bdi class="secno">5.5.1 </bdi>JSON Syntax</a></li><li class="tocline"><a class="tocxref" href="#triple-expressions-semantics"><bdi class="secno">5.5.2 </bdi>Semantics</a></li></ol></li><li class="tocline"><a class="tocxref" href="#import"><bdi class="secno">5.6 </bdi>ShEx Import</a></li><li class="tocline"><a class="tocxref" href="#schema-requirements"><bdi class="secno">5.7 </bdi>Schema Requirements</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#validation-requirement"><bdi class="secno">5.7.1 </bdi>Schema Validation Requirement</a></li><li class="tocline"><a class="tocxref" href="#shapeExprRef-requirement"><bdi class="secno">5.7.2 </bdi>Shape Expression Reference Requirement</a></li><li class="tocline"><a class="tocxref" href="#tripleExprRef-requirement"><bdi class="secno">5.7.3 </bdi>Triple Expression Reference Requirement</a></li><li class="tocline"><a class="tocxref" href="#negation-requirement"><bdi class="secno">5.7.4 </bdi>Negation Requirement</a></li></ol></li><li class="tocline"><a class="tocxref" href="#semantic-actions"><bdi class="secno">5.8 </bdi>Semantic Actions</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#semantic-actions-semantics"><bdi class="secno">5.8.1 </bdi>Semantics</a></li><li class="tocline"><a class="tocxref" href="#semantic-actions-uses"><bdi class="secno">5.8.2 </bdi>Use - informative</a></li></ol></li><li class="tocline"><a class="tocxref" href="#annotations"><bdi class="secno">5.9 </bdi>Annotations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#annotations-semantics"><bdi class="secno">5.9.1 </bdi>Semantics - informative</a></li></ol></li><li class="tocline"><a class="tocxref" href="#validation-examples"><bdi class="secno">5.10 </bdi>Validation Examples</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#example-simple"><bdi class="secno">5.10.1 </bdi>Simple Examples</a></li><li class="tocline"><a class="tocxref" href="#example-disjunction"><bdi class="secno">5.10.2 </bdi>Disjunction Example</a></li><li class="tocline"><a class="tocxref" href="#example-dependent-shape"><bdi class="secno">5.10.3 </bdi>Dependent Shape Example</a></li><li class="tocline"><a class="tocxref" href="#example-recursion"><bdi class="secno">5.10.4 </bdi>Recursion Example</a></li><li class="tocline"><a class="tocxref" href="#example-simple-repeated-property"><bdi class="secno">5.10.5 </bdi>Simple Repeated Property Examples</a></li><li class="tocline"><a class="tocxref" href="#example-repeated-property-with-dependent-shapes"><bdi class="secno">5.10.6 </bdi>Repeated Property With Dependent Shapes Example</a></li><li class="tocline"><a class="tocxref" href="#example-negation"><bdi class="secno">5.10.7 </bdi>Negation Example</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#shexc"><bdi class="secno">6. </bdi>ShEx Compact syntax (ShExC)</a></li><li class="tocline"><a class="tocxref" href="#shexj"><bdi class="secno">A. </bdi>ShEx JSON Syntax (ShExJ)</a></li><li class="tocline"><a class="tocxref" href="#shexr"><bdi class="secno">B. </bdi>ShEx Shape</a></li><li class="tocline"><a class="tocxref" href="#iana-considerations"><bdi class="secno">C. </bdi>IANA Considerations</a></li><li class="tocline"><a class="tocxref" href="#security"><bdi class="secno">D. </bdi>Security Considerations</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">E. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">E.1 </bdi>Normative references</a></li></ol></li></ol></nav>

    <section id="introduction">
      <h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction<a class="self-link" aria-label="§" href="#introduction"></a></h2>
      <p>
        The Shape Expressions (<dfn data-dfn-type="dfn" id="dfn-shex">ShEx</dfn>) language provides a structural schema for RDF data.
        This can be used to document APIs or datasets, aid in development of API-conformant messages, minimize defensive programming, guide user interfaces, or anything else that involves a machine-readable description of data organization and typing requirements.
      </p>
      <p>
        ShEx describes <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a> [<cite><a class="bibref" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax" data-link-type="biblio">RDF11-CONCEPTS</a></cite>] structures as sets of potentially connected <a data-lt="shape" href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shapes</a>.
        These constrain the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a> involving nodes in an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a>.
        <code>Node Constraints</code> constrain RDF nodes by constraining their node kind (<a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">Literal</a>), enumerating permissible values in value sets, specifying their datatype, and constraining value ranges of Literals.
        Additionally, they constrain lexical forms of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">Literals</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRIs</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">labeled blank nodes</a>.
        Shape Expressions schemas share blank nodes with the constrained <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graphs</a> in the same way that graphs in <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF datasets</a> [<cite><a class="bibref" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax" data-link-type="biblio">rdf11-concepts</a></cite>] share blank nodes.
      </p>
      <p>
        ShEx can be represented in JSON structures (<a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a>) or a compact syntax (<a href="#dfn-shexc" class="internalDFN" data-link-type="dfn">ShExC</a>).
        The compact syntax is intended for human consumption; the JSON structure for machine processing.
        This document defines ShEx in terms of <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> and includes a <a href="#shexc">section on the ShEx Compact Syntax (ShEx)</a>.
      </p>
    </section>

    <section id="notation">
      <h2 id="x2-notation"><bdi class="secno">2. </bdi>Notation<a class="self-link" aria-label="§" href="#notation"></a></h2>
      <p>
        The JSON [<cite><a class="bibref" href="#bib-rfc7159" title="The JavaScript Object Notation (JSON) Data Interchange Format" data-link-type="biblio">rfc7159</a></cite>] Syntax serves as a serializable proxy for an abstract syntax.
      </p>

      <p>
        <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-term">RDF terms</a> are represented as <a href="https://www.w3.org/TR/json-ld/#dfn-node">JSON-LD nodes</a>.
        </p><ul>
          <li><a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRIs</a> are represented as a <a href="https://tools.ietf.org/html/rfc7159#section-7">JSON string</a> consisting of the IRI string, e.g. <br /><code class="json">"http://example.org/resource"</code></li>
          <li><a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">Blank nodes</a> are represented as a JSON string composed of the concatenation of "<code>_:</code>" and a <dfn data-lt="blank node identifiers|labeled blank nodes|blank node identifier" data-dfn-type="dfn" id="dfn-blank-node-identifiers" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a></dfn>, e.g. <br /><code class="json">"_:blank3"</code></li>
          <li><a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">Literals</a> are represented as a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7159#section-4">JSON object</a>s following the composition rules for <a href="https://www.w3.org/TR/json-ld/#dfn-json-ld-value">JSON-LD values</a>, i.e.
          <ul>
            <li>literals with the datatype <code>http://www.w3.org/2001/XMLSchema#string</code> are represented with the <span class="param">value</span> property, e.g. <br /><code class="json">{ "value": "abc" }</code>.</li>
            <li><a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged strings</a> are represented with an additional <span class="param">language</span> property, e.g. <br /><code class="json">{ "value": "hello world", "langague": "en-US" }</code></li>
            <li>datatyped literals are represented with an additional <span class="param">datatype</span> property, e.g. <br /><code class="json">{ "value": "123", "datatype": "http://www.w3.org/2001/XMLSchema#integer" }</code></li>
          </ul></li>
        </ul>
      <p></p>

      <section id="json-grammar">
        <h3 id="x2-1-json-grammar"><bdi class="secno">2.1 </bdi>JSON Grammar<a class="self-link" aria-label="§" href="#json-grammar"></a></h3>
      <p>
        This specification uses a <dfn data-dfn-type="dfn" id="dfn-json-grammar">JSON grammar</dfn> to describe the set of JSON documents that can be interpreted as a ShEx schema.
        ShEx data structures are represented as <dfn data-lt="json object|JSON objects" data-dfn-type="dfn" id="dfn-json-object" data-no-export=""><a href="https://tools.ietf.org/html/rfc7159#section-4">JSON objects</a></dfn> with a member with the name "<code>type</code>" (i.e. an object with a <span class="param">type</span> attribute):
      </p>
      <div class="json">
        <pre class="json nohighlight">{ "type": "typeName", member<sub>0…n</sub> }</pre>
      </div>
      <p>
        These are expressed in JSON grammar as <span class="shexj">typeName { member* }</span>.
        <a href="https://tools.ietf.org/html/rfc7159#section-2">RFC7159 Section 2</a> provides syntactic constraints for JSON — the grammar constraining those to valid <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> constructs is composed of:
      </p>
      <ul>
        <li><code>typeName</code> is the name of the typed data structure.
        Types are referenced in the definitions of object members and in the definitions of the semantics for those data structures.</li>
        <li><code>member*</code> is a list of zero or more terminals or references to other typeExpressions.</li>
        <li>A <code>typeExpression</code> is one of:
        <ul>
          <li><code>typeName</code> — an object of corresponding type</li>
          <li><code>array</code>: <span class="shexj">[ typeExpression+ ]</span>— an array of one or more JSON values matching the typeExpression.</li>
          <li><code>choice</code>: <span class="shexj">typeExpression1 | typeExpression2 | …</span>— a choice between two or more typeExressions.</li>
        </ul>
        </li>
        <li>Cardinalities are represented as by the strings <code>?</code>, <code>+</code>, <code>*</code> following the <a href="https://www.w3.org/TR/xml/#sec-notation">notation in the XML specification</a>[<cite><a class="bibref" href="#bib-xml" title="Extensible Markup Language (XML) 1.0 (Fifth Edition)" data-link-type="biblio">XML</a></cite>] or <code>{m,}</code> to indicate a that at least <code>m</code> elements are required.</li>
      </ul>

      <p>
        The following examples are excerpts from the definitions below.
        In the JSON notation,
      </p>

      <div class="shexj simupre"><a class="obj internalDFN" href="#dfn-shapes-schema" data-link-type="dfn">Schema</a> { <a class="param internalDFN" href="#dfn-startacts" data-link-type="dfn">startActs</a>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <a class="param internalDFN" href="#dfn-start" data-link-type="dfn">start</a>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>? <a class="param internalDFN" href="#dfn-imports" data-link-type="dfn">imports</a>:[<a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a>+]? <a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>+]? }</div>
      <p>
        signifies that a <code>Schema</code> has four optional components called <a class="param internalDFN" href="#dfn-startacts" data-link-type="dfn">startActs</a>, <a class="param internalDFN" href="#dfn-start" data-link-type="dfn">start</a>, <a class="param internalDFN" href="#dfn-imports" data-link-type="dfn">imports</a> and <a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a>:
      </p>
      <ul>
        <li><span class="param">startActs</span> is a list of one or more <a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>.</li>
        <li><span class="param">start</span> is a <a class="objref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>.</li>
        <li><span class="param">imports</span> is a list of one or more <a class="objref" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a>.</li>
        <li><span class="param">shapes</span> is an array of <a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>.</li>
      </ul>

      <div class="shexj simupre"><a class="nob internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a> = <a class="objref internalDFN" href="#dfn-shapeor" data-link-type="dfn">ShapeOr</a> | <a class="objref internalDFN" href="#dfn-shapeand" data-link-type="dfn">ShapeAnd</a> | <a class="objref internalDFN" href="#dfn-shapenot" data-link-type="dfn">ShapeNot</a>
          | <a class="objref internalDFN" href="#dfn-nodeconstraint" data-link-type="dfn">NodeConstraint</a> | <a class="objref internalDFN" href="#dfn-shape" data-link-type="dfn">Shape</a> | <a class="objref internalDFN" href="#dfn-shapeexternal" data-link-type="dfn">ShapeExternal</a> ;</div>
      <p>
        signifies that a <a href="#dfn-shapeexpr" class="internalDFN" data-link-type="dfn">shapeExpr</a> is one of seven object types: <a class="objref .shexj internalDFN" href="#dfn-shapeor" data-link-type="dfn">ShapeOr</a> | <a class="objref internalDFN" href="#dfn-shapeand" data-link-type="dfn">ShapeAnd</a> | ….
      </p>

      <div class="shexj simupre"><a class="obj internalDFN" href="#dfn-nodeconstraint" data-link-type="dfn">NodeConstraint</a> { <span class="param">nodeKind</span>:(<span class="literal">"iri"</span> | <span class="literal">"bnode"</span> | <span class="literal">"nonliteral"</span> | <span class="literal">"literal"</span>)? <a class="nobref internalDFN" href="#dfn-xsfacet" data-link-type="dfn">xsFacet</a>* }
<a class="nob internalDFN" href="#dfn-xsfacet" data-link-type="dfn">xsFacet</a>        = <a class="nobref internalDFN" href="#dfn-stringfacet" data-link-type="dfn">stringFacet</a> | <a class="nobref internalDFN" href="#dfn-numericfacet" data-link-type="dfn">numericFacet</a> ;</div>
      <p>
        signifies that a <code>NodeConstraint</code> has a <code class="param">nodeKind</code> of one of the four literals followed by any number of <a class="objref .shexj internalDFN" href="#dfn-xsfacet" data-link-type="dfn">xsFacet</a> and an <a class="objref .shexj internalDFN" href="#dfn-xsfacet" data-link-type="dfn">xsFacet</a> is either a <a class="objref .shexj internalDFN" href="#dfn-stringfacet" data-link-type="dfn">stringFacet</a> or a <a class="objref .shexj internalDFN" href="#dfn-numericfacet" data-link-type="dfn">numericFacet</a>.
      </p>
      </section>

      <section id="shex-references">
        <h3 id="x2-2-references"><bdi class="secno">2.2 </bdi>References<a class="self-link" aria-label="§" href="#shex-references"></a></h3>
        <p>
          <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> is a dialect of JSON-LD [<cite><a class="bibref" href="#bib-json-ld" title="JSON-LD 1.0" data-link-type="biblio">JSON-LD</a></cite>] and the member <dfn class="param" data-dfn-type="dfn" id="dfn-id">id</dfn> is used as a <a href="https://www.w3.org/TR/json-ld/#node-identifiers">node identifier</a>.
          An object may be represented inline or referenced by its <span class="param">id</span> which may be either a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> or an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a>.
        </p>
        <div class="shexj simupre"><a class="obj internalDFN" href="#dfn-shapeor" data-link-type="dfn">ShapeOr</a>         { <a class="param internalDFN" href="#dfn-id" data-link-type="dfn">id</a>:<a class="nobjref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <a class="param internalDFN" href="#dfn-shapeexprs" data-link-type="dfn">shapeExprs</a>:[<a class="nobjref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>{2,}] }
<a class="nob internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>  = <a class="nobref internalDFN" href="#dfn-iriref" data-link-type="dfn">IRIREF</a> | <a class="objref internalDFN" href="#dfn-bnode" data-link-type="dfn">BNODE</a> ;
<a class="obj internalDFN" href="#dfn-eachof" data-link-type="dfn">EachOf</a>          { <a class="param internalDFN" href="#dfn-id" data-link-type="dfn">id</a>:<a class="nobjref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a>? <a class="param internalDFN" href="#dfn-expressions" data-link-type="dfn">expressions</a>:[<a class="nobjref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>{2,}] ... }
<a class="nob internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a> = <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a> | <a href="#dfn-bnode" class="internalDFN" data-link-type="dfn">BNODE</a> ;</div>
        <p>
          The JSON structure may include references to <a data-lt="shape" href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape expressions</a> and <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expressions</a>:
        </p>
        <div class="shexj simupre"><a class="obj internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>     = <a class="objref internalDFN" href="#dfn-shapeor" data-link-type="dfn">ShapeOr</a> | ... | <a class="nobjref internalDFN" href="#dfn-shapeexprrefs" data-link-type="dfn">shapeExprRef</a> ;
<a class="nob internalDFN" href="#dfn-shapeexprrefs" data-link-type="dfn">shapeExprRef</a>  = <a class="nobjref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a> ;
<a class="nobjref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>    = <a class="objref internalDFN" href="#dfn-eachof" data-link-type="dfn">EachOf</a> | ... | <a class="nobjref internalDFN" href="#dfn-tripleexprref" data-link-type="dfn">tripleExprRef</a> ;
<a class="nob internalDFN" href="#dfn-tripleexprref" data-link-type="dfn">tripleExprRef</a> = <a class="objref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a> ;</div>
        <p>
          An object with a circular reference must be referenced by an <span class="param">id</span>.
          This example uses a nested shape reference on a value expression (<a data-lt="TripleConstraint" href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">defined below</a>).
        </p>
        <div class="json">
          <pre class="json nohighlight">{ "type": "Schema", "shapes": [
    { "id": "<span class="lookit">http://schema.example/#IssueShape</span>",
      "type": "Shape", "expression": {
        "type": "TripleConstraint", "predicate": "http://schema.example/#related",
        "valueExpr": "<span class="lookit">http://schema.example/#IssueShape</span>", "min": 0 } } ] }</pre>
        </div>
        <p>
          Not captured in this JSON syntax definition is the rule that every <a class="nobjref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a> nested in a schema's <a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a> must have an <span class="param">id</span> and no other <a class="nobjref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a> may have an <span class="param">id</span>.
          The JSON syntax definitition simplifies this by adding <span style="border: thin solid #888888; background-color: #F8F8F0;"><a class="param internalDFN" href="#dfn-id" data-link-type="dfn">id</a>:<a class="nobjref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>?</span> to every <a class="nobjref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>.
          This example includes a nested shape. Nested shapes are not permitted to have <span class="param">ids</span>.
        </p>
        <div class="json">
          <pre class="json nohighlight">{ "type": "Schema", "shapes": [
    { "id": "http://schema.example/#IssueShape",
      "type": "Shape", "expression": {
        "type": "TripleConstraint", "predicate": "http://schema.example/#submittedBy",
        "valueExpr": {
          "type": "Shape", "expression": {
            "type": "TripleConstraint", "predicate": "http://schema.example/#name",
            "valueExpr": {
              "type": "NodeConstraint", "nodeKind": "literal"
            } } } } } ] }</pre>
        </div>

        <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span></div><p class="">
          The shape expressions in a schema are expressed as a list of shape expressions with <span class="param">id</span> attributes because JSON-LD 1.0 has no provision for defining as JSON object as representing a map of URL→object.
          Drafts of JSON-LD 1.1 <a href="https://www.w3.org/TR/2018/WD-json-ld11-20181011/#id-maps">include this expressivity</a> and, once JSON-LD 1.1 exits Candidate Recommendation, future versions of ShExJ will likely adopt it while requiring backard-compatibility with the list of shape expressions with <span class="param">id</span> attributes.
        </p></div>
      </section>
      <section id="style">
        <h3 id="x2-3-document-style"><bdi class="secno">2.3 </bdi>Document style<a class="self-link" aria-label="§" href="#style"></a></h3>
        <p>
          JSON examples are rendered in a <span class="json">.json</span> CSS style.
          Partial examples include ranges in a <span class="comment">.comment</span> CSS style to indicate text which would be substituted in a complete example.
          For example  <span class="json">{ "type": "ShapeAnd", "shapeExprs": [ <span class="comment">SE<sub>1</sub></span>, <span class="comment">…</span> ] }</span> indicates that both <span class="comment">SE<sub>1</sub></span> and <span class="comment">…</span> would be substituted in a complete example.
        </p>
        <p>
          In javascript-enabled browsers, schemas with a <button class="show-repchoice">json</button> button can be converted between the JSON representation and the compact syntax by clicking the button.
          The button text indicates the currently shown representation.
          Selecting the example and pressing "j" or "c" converts the example to the JSON (ShExJ) or compact form (ShExC).
          Pressing "shift J" or "shift C" converts all such examples to ShExJ or ShExC.
        </p>
      
      </section>
      <section id="graphAccess">
        <h3 id="x2-4-graph-access"><bdi class="secno">2.4 </bdi>Graph access<a class="self-link" aria-label="§" href="#graphAccess"></a></h3>
      <p>
        The validation process defined in this document relies on matching <a data-link-type="dfn" href="https://www.w3.org/TR/sparql11-query/#defn_TriplePattern">triple patterns</a> in the form <code>(subject, predicate, object)</code> where each position may be supplied by a constant, a previously defined term, or the underscore "<code>_</code>", which represents a previously undefined element or wildcard.
        This corresponds to a <dfn data-lt="triple pattern|triple patterns|SPARQL Triple Pattern" data-dfn-type="dfn" id="dfn-triple-pattern" data-no-export=""><a href="https://www.w3.org/TR/sparql11-query/#defn_TriplePattern">SPARQL Triple Pattern</a></dfn> where each "_" is replaced by a unique <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a>.
        Matching such a <a data-link-type="dfn" href="https://www.w3.org/TR/sparql11-query/#defn_TriplePattern">triple pattern</a> against a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> is defined by <a href="https://www.w3.org/TR/sparql11-query/#BGPsparql">SPARQL Basic Graph Pattern Matching</a> (BGP) with a BGP containing only that <a data-link-type="dfn" href="https://www.w3.org/TR/sparql11-query/#defn_TriplePattern">triple pattern</a>.
      </p>
      </section>
      

      <section id="process">
        <h3 id="x2-5-validation-process"><bdi class="secno">2.5 </bdi>Validation process<a class="self-link" aria-label="§" href="#process"></a></h3>
        <div>
          <p>
            ShEx validation is defined in this document by the <a class="function" href="#isValid">isValid</a> function.
            This process takes as input a <a href="#dfn-shapes-schema" class="internalDFN" data-link-type="dfn">shapes schema</a>, an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a>, and a <dfn data-lt="shapemap|fixed ShapeMap" data-dfn-type="dfn" id="dfn-shapemap" data-no-export=""><a href="http://shex.io/shape-map/#dfn-fixed-shapemap">fixed ShapeMap</a></dfn> (abbreviated as "ShapeMap" in this document).
            ShEx validation results may be reported as a <dfn data-dfn-type="dfn" id="dfn-result-shapemap" data-no-export=""><a href="http://shex.io/shape-map/#dfn-result-shapemap">result ShapeMap</a></dfn> [<cite><a class="bibref" href="#bib-shape-map" title="ShapeMap Structure and Language" data-link-type="biblio">shape-map</a></cite>].
            For illustration purposes in this specification, both the fixed ShapeMap input and the result ShapeMap output are represented in a table with four columns: <span class="data fake-example">node</span>: a ShapeMap nodeSelector, <span class="schema fake-example">shape</span>: a ShapeMap shapeLabel, <span class="fake-example">result</span>: "<span class="pass">pass</span>" (for "conformant" status) or "<span class="fail">fail</span>" ("nonconformant" status), and an optional <span class="fake-example">reason</span>: an informal, human-readable explanation.
          </p>
        <table class="example">
          <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
          <tr class="pass"><td>&lt;node1&gt;</td><td>&lt;Shape1&gt;</td><td>pass</td><td class="noreason"></td></tr>
          <tr class="fail"><td>&lt;node2&gt;</td><td>&lt;Shape1&gt;</td><td>fail</td><td class="fail">no <code>ex:state</code> supplied.</td></tr>
        </tbody></table>
        </div>
        </section>
      
      
      
      
      
      
      
      
    </section>

    <section id="terminology">
      <h2 id="x3-terminology"><bdi class="secno">3. </bdi>Terminology<a class="self-link" aria-label="§" href="#terminology"></a></h2>
      <p>Shape expressions are defined using terms from RDF semantics [<cite><a class="bibref" href="#bib-rdf11-mt" title="RDF 1.1 Semantics" data-link-type="biblio">rdf11-mt</a></cite>]:</p>
      <ul>
        <li><dfn data-lt="nodes|rdf node|rdf nodes|Node" data-dfn-type="dfn" id="dfn-nodes" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">Node</a></dfn>: one of <dfn data-lt="iris|IRI" data-dfn-type="dfn" id="dfn-iris" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a></dfn>, <dfn data-lt="bnodes|blank nodes|blank node" data-dfn-type="dfn" id="dfn-bnodes" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a></dfn>, <dfn data-lt="literal|literals|RDF Literal|RDF Literals|Literal" data-dfn-type="dfn" data-plurals="rdf literals|rdf literal" id="dfn-literal" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">Literal</a></dfn></li>
        <li><dfn data-lt="RDF Graph|RDF Graphs|Graph" data-dfn-type="dfn" data-plurals="rdf graphs|rdf graph" id="dfn-rdf-graph" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">Graph</a></dfn>: a set of <dfn data-lt="triple|rdf triple|rdf triples|Triples" data-dfn-type="dfn" id="dfn-triple" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">Triples</a></dfn> of (<dfn data-dfn-type="dfn" id="dfn-subject" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a></dfn>, <dfn data-dfn-type="dfn" id="dfn-predicate" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a></dfn>, <dfn data-dfn-type="dfn" id="dfn-object" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a></dfn>)</li>
      </ul>

      <p>This specification makes use of the following namespaces:</p>
      <dl>
        <dt><code>foaf</code>:</dt>
        <dd><code>http://xmlns.com/foaf/0.1/</code></dd>
        <dt><code>rdf</code>:</dt>
        <dd><code>http://www.w3.org/1999/02/22-rdf-syntax-ns#</code></dd>
        <dt><code>rdfs</code>:</dt>
        <dd><code>http://www.w3.org/2000/01/rdf-schema#</code></dd>
        <dt><code>shex</code>:</dt>
        <dd><code>http://www.w3.org/ns/shex#</code></dd>
        <dt><code>xsd</code>:</dt>
        <dd><code>http://www.w3.org/2001/XMLSchema#</code></dd>
      </dl>

      <p>
  The following functions access the elements of an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a> <span class="math">G</span> containing a node <span class="math">n</span>:</p>
  <ul>
    <li>
      <span class="math"><dfn data-dfn-type="dfn" id="dfn-arcsout">arcsOut</dfn>(G, n)</span> is the set of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> <span class="math">G</span> with <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a> <span class="math">n</span>.
    </li>
    <li>
      <span class="math"><dfn data-dfn-type="dfn" id="dfn-predicatesout">predicatesOut</dfn>(G, n)</span> is the set of <a data-lt="predicate" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicates</a> in <span class="math"><a href="#dfn-arcsout" class="internalDFN" data-link-type="dfn">arcsOut</a>(G, n)</span>.
    </li>
    <li>
      <span class="math"><dfn data-dfn-type="dfn" id="dfn-arcsin">arcsIn</dfn>(G, n)</span> is the set of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triples</a> in a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> <span class="math">G</span> with <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a> <span class="math">n</span>.
    </li>
    <li>
      <span class="math"><dfn data-dfn-type="dfn" id="dfn-predicatesin">predicatesIn</dfn>(G, n)</span> is the set of <a data-lt="predicate" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicates</a> in <span class="math"><a href="#dfn-arcsin" class="internalDFN" data-link-type="dfn">arcsIn</a>(G, n)</span>.
    </li>
    <li>
      <span class="math"><dfn data-dfn-type="dfn" id="dfn-neigh">neigh</dfn>(G, n)</span> is the neighbourhood of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> <span class="math">n</span> in the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> <span class="math">G</span>.<br /><span class="math"><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, n) = <a href="#dfn-arcsout" class="internalDFN" data-link-type="dfn">arcsOut</a>(G, n) ∪ <a href="#dfn-arcsin" class="internalDFN" data-link-type="dfn">arcsIn</a>(G, n)</span>
    </li>
    <li>
      <span class="math"><dfn data-dfn-type="dfn" id="dfn-predicates">predicates</dfn>(G, n)</span> is the set of <a data-lt="predicate" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicates</a> in <span class="math"><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, n)</span>.<br /><span class="math"><a href="#dfn-predicates" class="internalDFN" data-link-type="dfn">predicates</a>(G, n) = <a href="#dfn-predicatesout" class="internalDFN" data-link-type="dfn">predicatesOut</a>(G, n) ∪ <a href="#dfn-predicatesin" class="internalDFN" data-link-type="dfn">predicatesIn</a>(G, n)</span>
    </li>
  </ul>

      <div class="example">
  <p>
    Consider the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a> <span class="math">G</span> represented in Turtle:
  </p>

  <pre class="data" aria-busy="false"><code class="hljs">PREFIX ex: http://schema.example/#
PREFIX inst: http://inst.example/#
PREFIX foaf: http://xmlns.com/foaf/
PREFIX xsd: http://www.w3.org/2001/XMLSchema#

inst:Issue1 
    ex:state      ex:unassigned ;
    ex:reportedBy _:User2 .

_:User2
    foaf:name     "Bob Smith" ;
    foaf:mbox     &lt;mailto:bob@example.org&gt; .</code></pre>
  <p>
    There are two arcs out of <span class="pre">_:User2</span>; <span class="math"><a href="#dfn-arcsout" class="internalDFN" data-link-type="dfn">arcsOut</a>(G, <span class="pre">_:User2</span>)</span>:
  </p>
  <pre class="data" aria-busy="false"><code class="hljs">_:User2  foaf:name  "Bob Smith" .
_:User2  foaf:mbox  &lt;mailto:bob@example.org&gt; .</code></pre>
  <p>
    There is one arc into <span class="pre">_:User2</span>; <span class="math"><a href="#dfn-arcsin" class="internalDFN" data-link-type="dfn">arcsIn</a>(G, <span class="pre">_:User2</span>)</span>:
  </p>
  <pre class="data" aria-busy="false"><code class="hljs">inst:Issue1 ex:reportedBy  _:User2 .</code></pre>
  <p>
    There are three arcs in the neighbourhood of <span class="pre">_:User2</span> set, <span class="math"><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, <span class="pre">_:User2</span>)</span>:
  </p>
  <pre class="data" aria-busy="false"><code class="hljs">_:User2  foaf:name  "Bob Smith" .
_:User2  foaf:mbox  &lt;mailto:bob@example.org&gt; .
inst:Issue1 ex:reportedBy  _:User2 .</code></pre>
      </div>
    </section>

    <section id="conformance"><h2 id="x4-conformance"><bdi class="secno">4. </bdi>Conformance<a class="self-link" aria-label="§" href="#conformance"></a></h2><p>
      As well as sections marked as non-normative, all authoring guidelines,
      diagrams, examples, and notes in this specification are non-normative.
      Everything else in this specification is normative.
    </p><p>
            The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, and <em class="rfc2119">SHOULD NOT</em> in this document
            are to be interpreted as described in
            <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>
            [<cite><a class="bibref" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels" data-link-type="biblio">RFC2119</a></cite>]
            [<cite><a class="bibref" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words" data-link-type="biblio">RFC8174</a></cite>] when, and only when, they appear
            in all capitals, as shown here.
          </p>
      <p>Conformance criteria are relevant to authors and authoring tool implementers. As well
        as sections marked as non-normative, all authoring guidelines, diagrams, examples,
        and notes in this specification are non-normative. Everything else in this
        specification is normative.</p>

      <ul>
        <li>A <a href="#dfn-shexc" class="internalDFN" data-link-type="dfn">ShExC</a> document complies with this specification if it
          conforms to the grammar described in <a href="#shexc" class="sectionRef sec-ref">§ <bdi class="secno">6. </bdi>ShEx Compact syntax (ShExC)</a> resulting
          in a valid <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> document.</li>
        <li>A <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> document complies with this specification if it is a valid
          JSON-LD document [<cite><a class="bibref" href="#bib-json-ld" title="JSON-LD 1.0" data-link-type="biblio">JSON-LD</a></cite>], and conforms to the <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> syntax, as described in <a href="#shexj" class="sectionRef sec-ref">§ <bdi class="secno">A. </bdi>ShEx JSON Syntax (ShExJ)</a>.</li>
        <li>JSON documents can be interpreted as <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> by following the normative statements in
          <a href="https://www.w3.org/TR/json-ld/#interpreting-json-as-json-ld">Section 4.8 Interpreting JSON as JSON-LD</a> in [<cite><a class="bibref" href="#bib-json-ld" title="JSON-LD 1.0" data-link-type="biblio">JSON-LD</a></cite>].</li>
        <li>Other RDF documents comply with this specification, if they are <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-isomorphism">graph isomorphic</a>[<cite><a class="bibref" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax" data-link-type="biblio">rdf11-concepts</a></cite>] to the RDF interpretation of some <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> document.</li>
      </ul>
    </section>

    <section id="shapes-language">
      <h2 id="x5-the-shape-expressions-language"><bdi class="secno">5. </bdi>The Shape Expressions Language<a class="self-link" aria-label="§" href="#shapes-language"></a></h2>
      <p>
        A Shape Expressions (ShEx) schema is a collection of labeled <a data-lt="shape" href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shapes</a> and <a href="#node-constraints">Node Constraints</a>.
        These can be used to describe or test nodes in <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graphs</a>.
        ShEx does not prescribe a language for associating <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">nodes</a> with <a data-lt="shape" href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a> but several approaches are <a href="../primer/index.html#associating-nodes-with-shapes">described in the ShEx Primer</a>.
      </p>

      <section id="shapes-schema">
      <h3 id="x5-1-shapes-schema"><bdi class="secno">5.1 </bdi>Shapes Schema<a class="self-link" aria-label="§" href="#shapes-schema"></a></h3>
      <p>
        A shapes schema is captured in a <span class="jobjref"><dfn data-lt="shapes schema|Schema" data-dfn-type="dfn" id="dfn-shapes-schema">Schema</dfn></span> object:
      </p>
      <div class="shexjTable">
        <table class="shexj">
  <tbody><tr class="obj"><th class="obj"><a href="#dfn-shapes-schema" class="internalDFN" data-link-type="dfn">Schema</a></th><td>{</td><td><dfn class="param" data-dfn-type="dfn" id="dfn-startacts">startActs</dfn>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <dfn class="param" data-dfn-type="dfn" id="dfn-start">start</dfn>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>? <dfn class="param" data-dfn-type="dfn" id="dfn-imports">imports</dfn>:[<a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a>+]? <dfn class="param" data-dfn-type="dfn" id="dfn-shapes">shapes</dfn>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>+]? }</td></tr>
        </tbody></table>
      </div>
      <p>
        where <a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a> is a mapping from shape label to <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a>.
      </p>
      <div class="repchoice incomplete" tabindex="0">
        <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape", <span class="comment">…</span> },
  { "id": "_:UserShape", <span class="comment">…</span> },
  { "id": "http://schema.example/#EmployeeShape", <span class="comment">…</span> } ] }</pre>
        <pre class="shexc nohighlight rephidden">                                                         
ex:IssueShape { … }
_:UserShape { … }
ex:EmployeeShape { … }</pre>
      <button>json</button></div>
      </section>

      <section id="validation">
      <h3 id="x5-2-validation-definition"><bdi class="secno">5.2 </bdi>Validation Definition<a class="self-link" aria-label="§" href="#validation"></a></h3>

      <p>
	<dfn id="isValid" label="isValid" data-dfn-type="dfn">isValid</dfn>: For a graph <span class="math">G</span>, a schema  <span class="math">Sch</span> and a fixed ShapeMap <span class="math">ism</span>, <code class="function">isValid(<span class="math">G</span>, <span class="math">Sch</span>, <span class="math">ism</span>)</code> indicates that for every RDFnode/shapeLabel pair <span class="math">(n, sl)</span> in <span class="math">ism</span>, the node <span class="math">n</span> satisfies the shape expression identified by <span class="math">sl</span>.
	The latter is captured by the expression <code class="function">satisfies(<span class="math">n</span>, <span class="math">s</span>, <span class="math">G</span>, <span class="math">Sch</span>, <a href="#completeTyping">completeTyping</a>(<span class="math">G</span>, <span class="math">Sch</span>))</code>.
	The function <code class="function">satisfies</code>  is defined for every kind of <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a>.
      </p>

      
      <p>
	The validation of an RDF graph <span class="math">G</span> against a ShEx schema <span class="math">Sch</span> is based on the existence of <a href="#completeTyping"><code class="function">completeTyping(<span class="math">G</span>, <span class="math">Sch</span>)</code></a>.
	For an RDF graph <span class="math">G</span> and a shapes schema <span class="math">Sch</span>, a <dfn data-dfn-type="dfn" id="dfn-typing">typing</dfn> is a set of pairs of the form <span class="math">(n, s)</span> where <span class="math">n</span> is a node in <span class="math">G</span> and <span class="math">s</span> is a <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a> that appears in some shape expression in the <span class="param">shapes</span> mapping of <span class="math">Sch</span>.
	A <dfn label="correct typing" data-dfn-type="dfn" id="dfn-correct-typing">correct typing</dfn> is a <span class="math">typing</span> such that for every RDFnode/shape pair <span class="math">(n,s)</span> in <span class="math">typing</span>, <a href="#satisfies-Shape"><code class="function">matchesShape(<span class="math">n</span>, <span class="math">s</span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">typing</span>)</code></a> holds.
	<code class="function">completeTyping(<span class="math">G</span>, <span class="math">Sch</span>)</code> is a unique correct typing that exists for every graph and every ShEx schema that satisfies the <a href="#schema-requirements">schema requirements</a>.
      </p>
      

      <p>
	<dfn id="completeTyping" data-dfn-type="dfn">completeTyping</dfn>: the definition of <code class="function">completeTyping(<span class="math">G</span>, <span class="math">Sch</span>)</code> is based on a <a href="#dfn-stratification" class="internalDFN" data-link-type="dfn">stratification</a> of <span class="math">Sch</span>.
	
	The number of <dfn data-dfn-type="dfn" id="dfn-strata">strata</dfn> of <span class="math">Sch</span> is the number of maximal strongly connected components of the <a href="#dfn-dependency-graph" class="internalDFN" data-link-type="dfn">dependency graph</a> of <span class="math">Sch</span>.
	A <dfn data-dfn-type="dfn" id="dfn-stratification">stratification</dfn> of a schema <span class="math">Sch</span> with <span class="math">k</span> strata is a function <code class="function">stratum</code> that associates with every <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a> in <span class="math">Sch</span> a natural number between <span class="math">1</span> and <span class="math">k</span> such that:
      </p>
      <ul>
	<li>
	  If <span class="math">s1</span> and <span class="math">s2</span> belong to the same maximal strongly connected component, then <code class="function">stratum(<span class="math">s1</span>)</code> = <code class="function">stratum(<span class="math">s2</span>)</code>.
	</li>
	<li>
	  If there is a <a href="#dfn-reference" class="internalDFN" data-link-type="dfn">reference</a> from <span class="math">s1</span> to <span class="math">s2</span> and <span class="math">s1</span> and <span class="math">s2</span> do not belong to the same maximal strongly connected component, then <code class="function">stratum(<span class="math">s2</span>)</code> &lt; <code class="function">stratum(<span class="math">s1</span>)</code>.
	</li>
      </ul>
      <p>
	The existence of a stratification for every schema is guaranteed by the <a href="#negation-requirement">negation requirement</a>.
      </p>

      
      <p>
	Given a <a href="#dfn-stratification" class="internalDFN" data-link-type="dfn">stratification</a> <code class="function">stratum</code> of <span class="math">Sch</span> with <span class="math">k</span> strata, define inductively the series of <span class="math">k</span> typings <code class="function">completeTypingOn(<span class="math">1</span>, <span class="math">G</span>, <span class="math">Sch</span>)</code> … <code class="function">completeTypingOn(<span class="math">k</span>, <span class="math">G</span>, <span class="math">Sch</span>)</code>.
      </p>
      <ul>
	<li>
	  <code class="function">completeTypingOn(<span class="math">1</span>, <span class="math">G</span>, <span class="math">Sch</span>)</code> is the union of all correct typings that contain only RDFnode/shape pairs <span class="math">(n,s)</span> with <code class="function">stratum(<span class="math">s</span>)</code> = <span class="math">1</span>;
	</li>
	<li>
	  for every <span class="math">i</span> between <span class="math">2</span> and <span class="math">k</span>, <code class="function">completeTypingOn(<span class="math">i</span>, <span class="math">G</span>, <span class="math">Sch</span>)</code> is the union of all correct typings that:
	  <ul>
	    <li> contain only RDFnode/shape pairs <span class="math">(n,s)</span> with <code class="function">stratum(<span class="math">s</span>)</code> ≤ <span class="math">i</span>
	    </li>
	    <li> are equal to <code class="function">completeTypingOn(<span class="math">i</span>-1, <span class="math">G</span>, <span class="math">Sch</span>)</code> when restricted to their RDFnode/shape pairs <span class="math">(n1,s1)</span> for which <code class="function">stratum(<span class="math">s1</span>)</code> &lt; i.
	    </li>
	  </ul>
	</li>
      </ul>
      <p>
	Then <code class="function">completeTyping(<span class="math">G</span>, <span class="math">Sch</span>)</code> = <code class="function">completeTypingOn(<span class="math">k</span>, <span class="math">G</span>, <span class="math">Sch</span>)</code>.
      </p>

      <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="4"><span>Note</span></div><div class="">
	The definition on strogly connected component and maximal strongly connected component of a graph can be found on Wikipedia <a href="https://en.wikipedia.org/wiki/Strongly_connected_component">https://en.wikipedia.org/wiki/Strongly_connected_component</a>.
      </div></div>
      
      <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="4"><span>Note</span></div><div class="">
	<p>
	  The schema <span class="math">Sch</span> might have several different stratifications but <code class="function">completeTyping(<span class="math">G</span>, <span class="math">Sch</span>)</code> is the same for all these stratifications.
	  This property is reminiscent of the use of stratified negiation in Datalog.	  
	</p>
	<p>
	  In order to decide isValid(Sch, G, m), it is sufficient to compute only a portion of completeTyping using an appropriate algorithm.
	</p>
      </div></div>
      <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span>Note</span></div><div class="">
	<p>
	  Popular methods for constructing the input fixed ShapeMaps can be found on <a href="https://www.w3.org/2001/sw/wiki/ShEx/ShapeMap">https://www.w3.org/2001/sw/wiki/ShEx/ShapeMap</a>.
      </p>

      </div></div>


      </section>

      <section id="shape-expressions">
        <h3 id="x5-3-shape-expressions"><bdi class="secno">5.3 </bdi>Shape Expressions<a class="self-link" aria-label="§" href="#shape-expressions"></a></h3>
        <p>
          A <dfn data-lt="shape expressions|shape expression" data-dfn-type="dfn" id="dfn-shape-expressions">shape expression</dfn> is composed of four kinds of objects combined with the algebraic operators And, Or and Not:
        </p>
        <ul>
          <li>
            a node constraint (<span class="jobjref"><a href="#dfn-nodeconstraint" class="internalDFN" data-link-type="dfn">NodeConstraint</a></span>) that defines the set of allowed values of a node.
            These include specification of RDF node kind, literal datatype, XML String and numeric facets and enumeration of value sets.
          </li>
          <li>
            a shape constraint (<span class="jobjref"><a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a></span>) that defines a constraint on the allowed neighbourhood of a node, that is, the allowed triples that contain this node as subject or object.
          </li>
          <li>
            an external shape (<span class="jobjref"><a href="#dfn-shapeexternal" class="internalDFN" data-link-type="dfn">ShapeExternal</a></span>) which is an extension mechanism to externally define e.g. functional shapes or prohibitively large value sets.
          </li>
          <li>
            a shape reference (<span class="jobjref"><a href="#dfn-shapeexprlabel" class="internalDFN" data-link-type="dfn">shapeExprLabel</a></span>) identifies another shape in the schema or an <a href="#import">imported schema</a>.
          </li>
        </ul>

        <section id="shape-expressions-shexj">
          <h4 id="x5-3-1-json-syntax"><bdi class="secno">5.3.1 </bdi>JSON Syntax<a class="self-link" aria-label="§" href="#shape-expressions-shexj"></a></h4>

      <div class="shexjTable">
        <table class="shexj">
  <tbody><tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-shapeexpr">shapeExpr</dfn></th>         <td>=</td> <td><a class="objref internalDFN" href="#dfn-shapeor" data-link-type="dfn">ShapeOr</a> | <a class="objref internalDFN" href="#dfn-shapeand" data-link-type="dfn">ShapeAnd</a> | <a class="objref internalDFN" href="#dfn-shapenot" data-link-type="dfn">ShapeNot</a> | <a class="objref internalDFN" href="#dfn-nodeconstraint" data-link-type="dfn">NodeConstraint</a> | <a class="objref internalDFN" href="#dfn-shape" data-link-type="dfn">Shape</a> | <a class="objref internalDFN" href="#dfn-shapeexternal" data-link-type="dfn">ShapeExternal</a> | <a class="objref internalDFN" href="#dfn-shapeexprrefs" data-link-type="dfn">shapeExprRef</a> ;</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-shapeor">ShapeOr</dfn></th>             <td>{</td> <td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <dfn class="param" data-dfn-type="dfn" id="dfn-shapeexprs">shapeExprs</dfn>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>{2,}] }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-shapeand">ShapeAnd</dfn></th>           <td>{</td> <td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">shapeExprs</span>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>{2,}] }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-shapenot">ShapeNot</dfn></th>           <td>{</td> <td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">shapeExpr</span>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a> }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-shapeexternal">ShapeExternal</dfn></th> <td>{</td> <td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? }</td></tr>
  <tr class="nob"><th class="nob"><dfn data-lt="shapeExprRefs|shapeExprRef" data-dfn-type="dfn" data-plurals="shapeexprrefs" id="dfn-shapeexprrefs">shapeExprRef</dfn></th>           <td>=</td> <td><a class="objref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a> ;</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-shapeexprlabel">shapeExprLabel</dfn></th>       <td>=</td> <td><a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a href="#dfn-bnode" class="internalDFN" data-link-type="dfn">BNODE</a> ;</td></tr>
        </tbody></table>
      </div>
      <div class="example">
  <p>
    Examples of shape expressions:
  </p>

  <div class="repchoice incomplete" tabindex="0">
    <pre class="json nohighlight repchosen">{ "type": "Shape", <span class="comment">…</span> }    </pre>
    <pre class="shexc nohighlight rephidden">{ <span class="comment">…</span> }                     </pre>
  <button>json</button></div>
  <div style="clear:both;"> </div>
  <div class="repchoice incomplete" tabindex="0">
    <pre class="json nohighlight repchosen">{ "type": "ShapeAnd", "shapeExprs": [
  { "type": "NodeConstraint", "nodeKind": "iri" },
  { "type": "ShapeOr", "shapeExprs": [
    "http://schema.example/#IssueShape",
    { "type": "ShapeNot", "shapeExpr": { "type": "Shape", <span class="comment">…</span> } }
    ] } ] }</pre>
    <pre class="shexc nohighlight rephidden">                                                               
<span class="keyword">IRI</span> AND
(
  @&lt;http://schema.example/#IssueShape&gt;
  OR NOT { <span class="comment">…</span> }
)</pre>
  <button>json</button></div>
  <p>
    In this ShapeOr's <span class="param">shapeExprs</span>, "http://schema.example/#IssueShape" is a reference to the <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> with the id "http://schema.example/#IssueShape".
  </p>
      </div>
      </section>
      <section id="shape-expression-semantics">
      <h4 id="x5-3-2-semantics"><bdi class="secno">5.3.2 </bdi>Semantics<a class="self-link" aria-label="§" href="#shape-expression-semantics"></a></h4>
      <p>
        <span class="label" id="satisfies">satisfies</span>: The expression <code class="function">satisfies(<span class="math">n</span>, <span class="math">se</span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">t</span>)</code> indicates that a node <span class="math">n</span> and a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> <span class="math">G</span> satisfy a <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> <span class="math">se</span> with <a href="#dfn-typing" class="internalDFN" data-link-type="dfn">typing</a> <span class="math">t</span> for schema <span class="math">Sch</span>.<br />
        <span class="label" id="notSatisfies">notSatisfies</span>: Conversely, <code class="function">notSatisfies(<span class="math">n</span>, <span class="math">se</span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">t</span>)</code> indicates that <span class="math">n</span> and <span class="math">G</span> do not satisfy <span class="math">se</span> with the given <a href="#dfn-typing" class="internalDFN" data-link-type="dfn">typing</a> <span class="math">t</span>.
      </p>
      <p>
        <code class="function">satisfies(<span class="math">n</span>, <span class="math">se</span>, <span class="math">G</span>,<span class="math">Sch</span>, <span class="math">t</span>)</code> is true if and only if:
      </p>

      <ul>
        <li id="satisfies-NodeConstraint"><span class="math">se</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-nodeconstraint" data-link-type="dfn">NodeConstraint</a></span> and <code class="function"><a href="#satisfies2-NodeConstraint">satisfies2</a>(<span class="math">n</span>, <span class="math">se</span>)</code> as described below in <a href="#node-constraints">Node Constraints</a>.
        Note that testing if a node satisfies a node constraint does not require a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> or <a href="#dfn-typing" class="internalDFN" data-link-type="dfn">typing</a>.</li>
        <li id="satisfies-Shape-proxy"><span class="math">se</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-shape" data-link-type="dfn">Shape</a></span> and <span class="math">(n, se)</span> belongs to <span class="math">t</span>.
	</li>
        <li id="satisfies-ShapeOr"><span class="math">se</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-shapeor" data-link-type="dfn">ShapeOr</a></span> and there is some <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> <span class="math">se2</span> in <span class="math">se</span>.<span class="param">shapeExprs</span> such that <code class="function">satisfies(<span class="math">n</span>, <span class="math">se2</span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">t</span>)</code>.</li>
        <li id="satisfies-ShapeAnd"><span class="math">se</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-shapeand" data-link-type="dfn">ShapeAnd</a></span> and for every <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> <span class="math">se2</span> in <span class="math">se</span>.<span class="param">shapeExprs</span>, <code class="function">satisfies(<span class="math">n</span>, <span class="math">se2</span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">t</span>)</code>.</li>
        <li id="satisfies-ShapeNot"><span class="math">se</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-shapenot" data-link-type="dfn">ShapeNot</a></span> and for the <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> <span class="math">se2</span> at <span class="math">se</span>.<span class="param">shapeExpr</span>, <code class="function">notSatisfies(<span class="math">n</span>, <span class="math">se2</span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">t</span>)</code>.</li>
        <li id="satisfies-ShapeExternal"><span class="math">se</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-shapeexternal" data-link-type="dfn">ShapeExternal</a></span> and implementation-specific mechansims not defined in this specification indicate success.</li>
        <li id="satisfies-shapeExprRef"><span class="math">se</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-shapeexprrefs" data-link-type="dfn">shapeExprRef</a></span> and <code class="function">satisfies(<span class="math">n</span>, <span class="math">se2</span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">t</span>)</code> where <span class="math">se2</span> is the shape expression having <span class="math">se</span> as <span class="param">id</span>.
	</li>
      </ul>

      <div class="example">
  <p>
    Given the three shape expressions <span class="math">SE<sub>1</sub></span>, <span class="math">SE<sub>2</sub></span>, <span class="math">SE<sub>3</sub></span> in a <span class="jobjref"><a class="obj internalDFN" href="#dfn-shapes-schema" data-link-type="dfn">Schema</a></span> <span class="math">Sch</span>, such that:
  </p>
  <ul>
    <li><code class="function">satisfies(<span class="math">n</span>, <span class="math">SE<sub>1</sub></span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</code></li>
    <li><code class="function">satisfies(<span class="math">n</span>, <span class="math">SE<sub>2</sub></span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</code></li>
    <li><code class="function">notSatisfies(<span class="math">n</span>, <span class="math">SE<sub>3</sub></span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</code></li>
  </ul>
  <p>
    the following hold:
  </p>

  <ul class="codelist">
    <li><div><div style="float:left;" class="code function">satisfies(</div><div style="float:left;" class="code"><span class="math">n</span>,<br /><div class="inline json"><pre aria-busy="false"><code class="hljs json">{ <span class="hljs-attr">"type"</span>: <span class="hljs-string">"ShapeAnd"</span>, <span class="hljs-attr">"shapeExprs"</span>: [ SE1, SE2 ] }</code></pre></div>,<br /> <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</div><div style="clear:both;"></div></div></li>
    <li><div><div style="float:left;" class="code function">satisfies(</div><div style="float:left;" class="code"><span class="math">n</span>,<br /><div class="inline json"><pre aria-busy="false"><code class="hljs json">{ <span class="hljs-attr">"type"</span>: <span class="hljs-string">"ShapeOr"</span>, <span class="hljs-attr">"shapeExprs"</span>: [ SE1, SE2, SE3 ] }</code></pre></div>,<br /> <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</div><div style="clear:both;"></div></div></li>
    <li><div><div style="float:left;" class="code function">notSatisfies(</div><div style="float:left;" class="code"><span class="math">n</span>,<br /><div class="inline json code"><pre aria-busy="false"><code class="hljs javascript">{ <span class="hljs-string">"type"</span>: <span class="hljs-string">"ShapeNot"</span>, <span class="hljs-string">"shapeExpr"</span>: {
    { <span class="hljs-string">"type"</span>: <span class="hljs-string">"ShapeOr"</span>, <span class="hljs-string">"shapeExprs"</span>: [
        SE1,
        { <span class="hljs-string">"type"</span>: <span class="hljs-string">"ShapeAnd"</span>, <span class="hljs-string">"shapeExprs"</span>: [ SE2, SE3 ] }
      ] }
  } }</code></pre></div>,<br /> <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</div><div style="clear:both;"></div></div></li>
    </ul>

    <p>
      If <span class="math">Sch</span>'s <a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a> maps "<code>http://schema.example/#shape1</code>" to <span class="math">SE<sub>1</sub></span> then the following holds:
    </p>
  <ul class="codelist">
    <li><div><div style="float:left;" class="code function">satisfies(</div><div style="float:left;" class="code"><span class="math">n</span>,<br /><div class="inline json"><pre aria-busy="false"><code class="hljs javascript">http:<span class="hljs-comment">//schema.example/#shape1"</span></code></pre></div>,<br /> <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</div><div style="clear:both;"></div></div></li>
    </ul>
      </div>
      </section>
      </section>

      <section id="node-constraints">
        <h3 id="x5-4-node-constraints"><bdi class="secno">5.4 </bdi>Node Constraints<a class="self-link" aria-label="§" href="#node-constraints"></a></h3>
        <div class="shexjTable">
          <table class="shexj">
  <tbody><tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-nodeconstraint">NodeConstraint</dfn></th> <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">nodeKind</span>:(<span class="literal">"iri"</span> | <span class="literal">"bnode"</span> | <span class="literal">"nonliteral"</span> | <span class="literal">"literal"</span>)? <span class="param">datatype</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a>? <a class="nobref internalDFN" href="#dfn-xsfacet" data-link-type="dfn">xsFacet</a>* <span class="param">values</span>:[<a class="nobref internalDFN" href="#dfn-valuesetvalue" data-link-type="dfn">valueSetValue</a>+]? }</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-xsfacet">xsFacet</dfn></th>               <td>=</td><td><a class="nobref internalDFN" href="#dfn-stringfacet" data-link-type="dfn">stringFacet</a> | <a class="nobref internalDFN" href="#dfn-numericfacet" data-link-type="dfn">numericFacet</a> ;</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-stringfacet">stringFacet</dfn></th>       <td>=</td><td>(<span class="param">length</span>|<span class="param">minlength</span>|<span class="param">maxlength</span>):<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a> | <span class="param">pattern</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a> <span class="param">flags</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? ;</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-numericfacet">numericFacet</dfn></th>     <td>=</td><td>(<span class="param">mininclusive</span>|<span class="param">minexclusive</span>|<span class="param">maxinclusive</span>|<span class="param">maxexclusive</span>):<a class="nobref internalDFN" href="#dfn-numericliteral" data-link-type="dfn">numericLiteral</a> </td></tr>
    <tr><th></th><td>|</td><td>(<span class="param">totaldigits</span>|<span class="param">fractiondigits</span>):<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a> ;</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-numericliteral">numericLiteral</dfn></th> <td>=</td><td><a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a> | <a href="#dfn-decimal" class="internalDFN" data-link-type="dfn">DECIMAL</a> | <a href="#dfn-double" class="internalDFN" data-link-type="dfn">DOUBLE</a> ;</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-valuesetvalue">valueSetValue</dfn></th><td>=</td><td><a class="nobref internalDFN" href="#dfn-objectvalue" data-link-type="dfn">objectValue</a> | <a class="objref internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a> | <a class="objref internalDFN" href="#dfn-iristemrange" data-link-type="dfn">IriStemRange</a> | <a class="objref internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a> | <a class="objref internalDFN" href="#dfn-literalstemrange" data-link-type="dfn">LiteralStemRange</a> | <a class="objref internalDFN" href="#dfn-language" data-link-type="dfn">Language</a> | <a class="objref internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a> | <a class="objref internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a> ;</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-objectvalue">objectValue</dfn></th><td>=</td><td><a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a class="objref internalDFN" href="#dfn-objectliteral" data-link-type="dfn">ObjectLiteral</a> ;</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-objectliteral">ObjectLiteral</dfn></th><td>{</td><td><span class="param">value</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a> <span class="param">language</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? <span class="param">type</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-iristem">IriStem</dfn></th><td>{</td><td><span class="param">stem</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-iristemrange">IriStemRange</dfn></th><td>{</td><td><span class="param">stem</span>:(<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-iriref" data-link-type="dfn">IRIREF</a>|<a class="objref internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a> +] }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-literalstem">LiteralStem</dfn></th><td>{</td><td><span class="param">stem</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a> }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-literalstemrange">LiteralStemRange</dfn></th><td>{</td><td><span class="param">stem</span>:(<a class="nobref internalDFN" href="#dfn-string" data-link-type="dfn">STRING</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-string" data-link-type="dfn">STRING</a>|<a class="objref internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a> +] }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-language">Language</dfn></th><td>{</td><td><span class="param">languageTag</span>:<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-languagestem">LanguageStem</dfn></th><td>{</td><td><span class="param">stem</span>:<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-languagestemrange">LanguageStemRange</dfn></th><td>{</td><td><span class="param">stem</span>:(<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-langtag" data-link-type="dfn">LANGTAG</a>|<a class="objref internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a> +] }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-wildcard">Wildcard</dfn></th>             <td>{</td><td><span class="comment">/* empty */</span> }</td></tr>
          </tbody></table>
        </div>
        <section id="node-constraint-semantics">
          <h4 id="x5-4-1-semantics"><bdi class="secno">5.4.1 </bdi>Semantics<a class="self-link" aria-label="§" href="#node-constraint-semantics"></a></h4>
          <p id="satisfies2-NodeConstraint">
            For a node <span class="param">n</span> and constraint <span class="param">nc</span>, <code class="function">satisfies2(<span class="math">n</span>, <span class="math">nc</span>)</code> if and only if for every <span class="param">nodeKind</span>, <span class="param">datatype</span>, <span class="param">xsFacet</span> and <span class="param">values</span> constraint value <span class="math">v</span> present in <span class="param">nc</span> <code class="function">nodeSatisfies(<span class="math">n</span>, <span class="math">v</span>)</code>.
            The following sections define <code class="function">nodeSatisfies</code> for each of these types of constraints:
          </p>
          <ul>
            <li><a href="#nodeKind">Node Kind Constraints</a></li>
            <li><a href="#datatype">Datatype Constraints</a></li>
            <li><a href="#xs-string">XML Schema String Facet Constraints</a></li>
            <li><a href="#xs-numeric">XML Schema Numeric Facet Constraints</a></li>
            <li><a href="#values">Values Constraints</a></li>
          </ul>
        </section>

        <section id="nodeKind">
          <h4 id="x5-4-2-node-kind-constraints"><bdi class="secno">5.4.2 </bdi>Node Kind Constraints<a class="self-link" aria-label="§" href="#nodeKind"></a></h4>
          <p id="nodeSatisfies-nodeKind">
            For a node <span class="math">n</span> and constraint value <span class="math">v</span>, <code class="function">nodeSatisfies(<span class="math">n</span>, <span class="math">v</span>)</code> if:
          </p>
          <ul>
            <li><span class="math">v</span> = "iri" and <span class="math">n</span> is an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a>.</li>
            <li><span class="math">v</span> = "bnode" and <span class="math">n</span> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a>.</li>
            <li><span class="math">v</span> = "literal" and <span class="math">n</span> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">Literal</a>.</li>
            <li><span class="math">v</span> = "nonliteral" and <span class="math">n</span> is an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a>.</li>
          </ul>
          <div class="example">
            <div class="example-title marker"><span>Node Kind example 1</span></div>
            <p>
              The following examples use a <span class="jobjref"><a href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">TripleConstraint</a></span> object described later in the document.
              The 
            </p>
            <div class="repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#state",
      "valueExpr": { "type": "NodeConstraint", "nodeKind": "iri" } } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                              
    ex:IssueShape {
      ex:state IRI
    }
 </pre>
            <button>json</button></div>
            <pre class="data" aria-busy="false"><code class="hljs">&lt;issue1&gt; ex:state ex:HunkyDory .
&lt;issue2&gt; ex:taste ex:GoodEnough .
&lt;issue3&gt; ex:state "just fine" .</code></pre>
            <table>
              <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
              <tr class="pass"><td>&lt;issue1&gt;</td><td>&lt;IssueShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
              <tr class="fail"><td>&lt;issue2&gt;</td><td>&lt;IssueShape&gt;</td><td>fail</td><td class="fail">expected 1 <code>ex:state</code> property.</td></tr>
              <tr class="fail"><td>&lt;issue3&gt;</td><td>&lt;IssueShape&gt;</td><td>fail</td><td class="fail"><code>ex:state</code> expected to be an IRI, literal found.</td></tr>
            </tbody></table>
            <p>
              Note that &lt;issue2&gt; <span class="fail">fails</span> not because of a nodeKind violation but instead because of a <a href="#matches-cardinality">Cardinality</a> violation described below.
            </p>
          </div>
        </section>

        <section id="datatype">
          <h4 id="x5-4-3-datatype-constraints"><bdi class="secno">5.4.3 </bdi>Datatype Constraints<a class="self-link" aria-label="§" href="#datatype"></a></h4>
          <p id="nodeSatisfies-datatype">
            For a node <span class="math">n</span> and constraint value <span class="math">v</span>, <code class="function">nodeSatisfies(<span class="math">n</span>, <span class="math">v</span>)</code> if <span class="math">n</span> is an Literal with the datatype <span class="math">v</span> and, if <span class="math">v</span> is in the set of <a href="https://www.w3.org/TR/sparql11-query/#operandDataTypes">SPARQL operand data types</a>[<cite><a class="bibref" href="#bib-sparql11-query" title="SPARQL 1.1 Query Language" data-link-type="biblio">sparql11-query</a></cite>], an XML schema string with a value of the lexical form of <span class="math">n</span> can be cast to the target type <span class="math">v</span> per <a href="https://www.w3.org/TR/xpath-functions-31/#casting">XPath Functions 3.1 section 19 Casting</a>[<cite><a class="bibref" href="#bib-xpath-functions" title="XQuery 1.0 and XPath 2.0 Functions and Operators (Second Edition)" data-link-type="biblio">xpath-functions</a></cite>].
            The lexical form and numeric value (where applicable) of all datatypes required by <a href="https://www.w3.org/TR/sparql11-query/#FunctionMapping">SPARQL XPath Constructor Functions</a> <em class="rfc2119" title="MUST">MUST</em> be tested for conformance with the corresponding XML Schema form.
            ShEx extensions <em class="rfc2119" title="MAY">MAY</em> add support for other datatypes.
          </p>

          <div class="example">
            <div class="example-title marker"><span>Datatype example 1</span></div>
            <div class="repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#submittedOn",
      "valueExpr": {
        "type": "NodeConstraint",
        "datatype": "http://www.w3.org/2001/XMLSchema#date"
      } } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                                    
    ex:IssueShape {                                                          
      ex:submittedOn xsd:date
    }

    
    
 </pre>
            <button>json</button></div>
            <pre class="data" aria-busy="false"><code class="hljs">&lt;issue1&gt; ex:submittedOn "2016-07-08"^^xsd:date .
&lt;issue2&gt; ex:submittedOn "2016-07-08T01:23:45Z"^^xsd:dateTime .
&lt;issue3&gt; ex:submittedOn "2016-07"^^xsd:date .</code></pre>
            <table>
              <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
              <tr class="pass"><td>&lt;issue1&gt;</td><td>&lt;IssueShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
              <tr class="fail"><td>&lt;issue2&gt;</td><td>&lt;IssueShape&gt;</td><td>fail</td><td class="fail"><code>ex:submittedOn</code> expected to be an <code>xsd:date</code>, <code>xsd:dateTime</code> found.</td></tr>
              <tr class="fail"><td>&lt;issue3&gt;</td><td>&lt;IssueShape&gt;</td><td>fail</td><td class="fail"><code>2016-07</code> is not a valid <code>xsd:date</code>.</td></tr>
            </tbody></table>
          </div>

          <div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="5"><span>Note</span></div><div class="">
            <p>
              In RDF 1.1, <dfn data-lt="language-tagged string|language-tagged strings" data-dfn-type="dfn" id="dfn-language-tagged-string" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged strings</a></dfn>[<cite><a class="bibref" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax" data-link-type="biblio">rdf11-concepts</a></cite>] have the datatype <code>http://www.w3.org/1999/02/22-rdf-syntax-ns#langString</code>.
            </p>
            <p>
              RDF 1.0 included <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF literals</a> with no datatype or language tag.
              These are called "<a href="https://www.w3.org/TR/sparql11-query/#simple_literal">simple literals</a>" in SPARQL11[<cite><a class="bibref" href="#bib-sparql11-query" title="SPARQL 1.1 Query Language" data-link-type="biblio">sparql11-query</a></cite>].
              In RDF 1.1, these literals have the datatype <code>http://www.w3.org/2001/XMLSchema#string</code>.
            </p>
          </div></div>
          <div class="example">
            <div class="example-title marker"><span>Datatype example 2</span></div>
            <div class="repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint",
      "predicate": "http://www.w3.org/2000/01/rdf-schema#label",
      "valueExpr": {
        "type": "NodeConstraint",
        "datatype": "http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"
      } } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                           
  ex:IssueShape {
    rdfs:label rdf:langString
  }




 </pre>
            <button>json</button></div>
            <pre class="data" aria-busy="false"><code class="hljs">&lt;issue3&gt; rdfs:label "emits dense black smoke"@en .
&lt;issue4&gt; rdfs:label "unexpected odor" .</code></pre>
            <table>
              <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
              <tr class="pass"><td>&lt;issue3&gt;</td><td>&lt;IssueShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
              <tr class="fail"><td>&lt;issue4&gt;</td><td>&lt;IssueShape&gt;</td><td>fail</td><td class="fail"><code>rdfs:label</code> expected to be an <code>rdf:langString</code>, <code>xsd:string</code> found.</td></tr>
            </tbody></table>
          </div>
        </section>
      
      <section id="xs-string">
        <h4 id="x5-4-4-xml-schema-string-facet-constraints"><bdi class="secno">5.4.4 </bdi>XML Schema String Facet Constraints<a class="self-link" aria-label="§" href="#xs-string"></a></h4>
        
        <p>
          String facet constraints apply to the lexical form of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF Literals</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRIs</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> (see <a href="#blank-node-label">note below</a> regarding access to <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a>).<br />
          Let <span class="math">lex</span> =
        </p>
        <ul>
          <li>if the value <span class="math">n</span> is an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF Literal</a>, the <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">lexical form</a> of the literal (see [<cite><a class="bibref" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax" data-link-type="biblio">rdf11-concepts</a></cite>] <a href="https://www.w3.org/TR/rdf11-concepts/#section-Graph-Literal">section 3.3 Literals</a>).</li>
          <li>if the value <span class="math">n</span> is an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a>, the <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI string</a> (see [<cite><a class="bibref" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax" data-link-type="biblio">rdf11-concepts</a></cite>] <a href="https://www.w3.org/TR/rdf11-concepts/#section-iris">section 3.2 IRIs</a>).</li>
          <li>if the value <span class="math">n</span> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a>, the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a> (see [<cite><a class="bibref" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax" data-link-type="biblio">rdf11-concepts</a></cite>] <a href="https://www.w3.org/TR/rdf11-concepts/#section-blank-nodes">section 3.4 Blank Nodes</a>).</li>
        </ul>
        <p>
          Let <span class="math">len</span> = the number of unicode codepoints in <span class="math">lex</span><br />
          For a node <span class="math">n</span> and constraint value <span class="math">v</span>, <code class="function">nodeSatisfies(<span class="math">n</span>, <span class="math">v</span>)</code>:
        </p>
        <ul>
          <li id="nodeSatisfies-length">for "<code>length</code>" constraints, <span class="math">v = len</span>,</li>
          <li id="nodeSatisfies-minlength">for "<code>minlength</code>" constraints, <span class="math">v &gt;= len</span>,</li>
          <li id="nodeSatisfies-maxlength">for "<code>maxlength</code>" constraints, <span class="math">v &lt;= len</span>,</li>
          <li id="nodeSatisfies-pattern">
            for "<code>pattern</code>" constraints, <span class="math">v</span> is unescaped into a valid <a href="https://www.w3.org/TR/xpath-functions-31/#regex-syntax">XPath 3.1 regular expression</a>[<cite><a class="bibref" href="#bib-xpath-functions-31" title="XPath and XQuery Functions and Operators 3.1" data-link-type="biblio">xpath-functions-31</a></cite>] <span class="math">re</span> and invoking <code class="function"><a href="https://www.w3.org/TR/xpath-functions-31/#func-matches">fn:matches</a>(<span class="math">lex</span>, <span class="math">re</span>)</code> returns <code>fn:true</code>.
            If the <span class="param">flags</span> parameter is present, it is passed as a third argument to <code class="function">fn:matches</code>.
            The pattern may have XPath 3.1 regular expression escape sequences per the modified production [10] in <a href="https://www.w3.org/TR/xpath-functions-31/#matching-start-and-end">section 5.6.1.1</a> as well as numeric escape sequences of the form 'u' HEX HEX HEX HEX or 'U' HEX HEX HEX HEX HEX HEX HEX HEX.
            Unescaping replaces numeric escape sequences with the corresponding unicode codepoint.
          </li>
        </ul>
        <div class="example">
          <div class="example-title marker"><span>String Facets example 1</span></div>
          <div class="repchoice" tabindex="0">
            <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint",
      "predicate": "http://schema.example/#submittedBy",
      "valueExpr": { "type": "NodeConstraint", "minlength": 10 } } } ] }</pre>
            <pre class="shexc nohighlight rephidden">                                                                        
  ex:IssueShape {
    ex:submittedBy MINLENGTH 10
  }

 </pre>
          <button>json</button></div>
          <pre class="data" aria-busy="false"><code class="hljs">&lt;issue1&gt; ex:submittedBy &lt;http://a.example/bob&gt; . # 20 characters
&lt;issue2&gt; ex:submittedBy "Bob" . # 3 characters</code></pre>
          <table>
            <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
            <tr class="pass"><td>&lt;issue1&gt;</td><td>&lt;IssueShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="fail"><td>&lt;issue2&gt;</td><td>&lt;IssueShape&gt;</td><td>fail</td><td class="fail"><code>ex:submittedBy</code> expected to be &gt;= 10 characters,<br /> 3 characters found.</td></tr>
          </tbody></table>
        </div>

        <div class="note" role="note" id="blank-node-label"><div role="heading" class="note-title marker" id="h-note-4" aria-level="5"><span>Note</span></div><div class="">
          <p>
            Access to <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> may be impossible or unadvisable for many use cases.
            For instance, the SPARQL Query and SPARQL Update languages treat blank nodes in the query, labeled or otherwise, as variables.
            Lexical constraints on <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifiers</a> can only be implemented in systems which preserve such labels on data import.
          </p>
        </div></div>
        <div class="example">
          <div class="example-title marker"><span>String Facets example 2</span></div>
          <div class="repchoice" tabindex="0">
            <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint",
      "predicate": "http://schema.example/#submittedBy",
      "valueExpr": { "type": "NodeConstraint",
                     "pattern": "genuser[0-9]+", "flags": "i" }
} } ] }</pre>
            <pre class="shexc nohighlight rephidden">                                                               
  ex:IssueShape {
    ex:submittedBy /genuser[0-9]+/i
  }



 </pre>
          <button>json</button></div>
          <pre class="data" aria-busy="false"><code class="hljs">&lt;issue6&gt; ex:submittedBy _:genUser218 .
&lt;issue7&gt; ex:submittedBy _:genContact817 .</code></pre>
          <table>
            <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
            <tr class="pass"><td>&lt;issue6&gt;</td><td>&lt;IssueShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="fail"><td>&lt;issue7&gt;</td><td>&lt;IssueShape&gt;</td><td>fail</td><td class="fail"><code>_:genContact817</code> expected to match <code>genuser[0-9]+</code>.</td></tr>
          </tbody></table>
        </div>

        <p>
          When expressed as JSON strings, regular expressions are subject to the JSON string escaping rules.
        </p>

        <div class="example">
          <div class="example-title marker"><span>String Facets example 3</span></div>
          <div class="repchoice" tabindex="0">
            <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#ProductShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint",
      "predicate": "http://schema.example/#trademark",
      "valueExpr": { "type": "NodeConstraint",
                     "pattern": "^/\\t\\\\\uD835\uDCB8\\?$" }
} } ] }</pre>
            <pre class="shexc nohighlight rephidden">                                                             
  ex:ProductShape {
    ex:trademark /^\/\t\\\U0001D4B8\?$/
  }



 </pre>
          <button>json</button></div>
          <pre class="data" aria-busy="false"><code class="hljs">&lt;product6&gt; ex:trademark "	\\𝒸?" .
&lt;product7&gt; ex:trademark "\t\\\U0001D4B8?" . # Turtle literals have escape characters [tbnrf"'\].
&lt;product8&gt; ex:trademark "\t\\\\U0001D4B8?" .</code></pre>
          <table>
            <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
            <tr class="pass"><td>&lt;product6&gt;</td><td>&lt;ProductShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="pass"><td>&lt;product7&gt;</td><td>&lt;ProductShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="fail"><td>&lt;product8&gt;</td><td>&lt;ProductShape&gt;</td><td>fail</td><td class="fail">found "<code>\U0001D4B8</code>" instead of "<code>𝒸</code>" (codepoint U+1D4B8).</td></tr>
          </tbody></table>
        </div>
      </section>

      <section id="xs-numeric">
        <h4 id="x5-4-5-xml-schema-numeric-facet-constraints"><bdi class="secno">5.4.5 </bdi>XML Schema Numeric Facet Constraints<a class="self-link" aria-label="§" href="#xs-numeric"></a></h4>
        
        <p>
          Numeric facet constraints apply to the numeric value of <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF Literals</a> with datatypes listed in <a href="https://www.w3.org/TR/sparql11-query/#operandDataTypes">SPARQL 1.1 Operand Data Types</a>[<cite><a class="bibref" href="#bib-sparql11-query" title="SPARQL 1.1 Query Language" data-link-type="biblio">sparql11-query</a></cite>].
          Numeric constraints on non-numeric values fail.
          <code>totaldigits</code> and <code>fractiondigits</code> constraints on values not derived from <code>xsd:decimal</code> fail.
        </p>
        <p>
          Let <span class="math">num</span> be the numeric value of <span class="math">n</span>.<br />
          For a node <span class="math">n</span> and constraint value <span class="math">v</span>, <code class="function">nodeSatisfies(<span class="math">n</span>, <span class="math">v</span>)</code>:
        </p>
        <ul>
          <li id="nodeSatisfies-mininclusive">for "<code>mininclusive</code>" constraints, <span class="math">v &lt;= num</span>,</li>
          <li id="nodeSatisfies-minexclusive">for "<code>minexclusive</code>" constraints, <span class="math">v &lt; num</span>,</li>
          <li id="nodeSatisfies-maxinclusive">for "<code>maxinclusive</code>" constraints, <span class="math">v &gt;= num</span>,</li>
          <li id="nodeSatisfies-maxexclusive">for "<code>maxexclusive</code>" constraints, <span class="math">v &gt; num</span>,</li>
          <li id="nodeSatisfies-totaldigits">for "<code>totaldigits</code>" constraints, <span class="math">v</span> is less than or equals the number of digits in the <a href="https://www.w3.org/TR/xmlschema-2/#dt-canonical-representation">XML Schema canonical form</a>[<cite><a class="bibref" href="#bib-xmlschema-2" title="XML Schema Part 2: Datatypes Second Edition" data-link-type="biblio">xmlschema-2</a></cite>] of the value of <span class="math">n</span>,</li>
          <li id="nodeSatisfies-fractiondigits">for "<code>fractiondigits</code>" constraints, <span class="math">v</span> is less than or equals the number of digits to the right of the decimal place in the <a href="https://www.w3.org/TR/xmlschema-2/#dt-canonical-representation">XML Schema canonical form</a>[<cite><a class="bibref" href="#bib-xmlschema-2" title="XML Schema Part 2: Datatypes Second Edition" data-link-type="biblio">xmlschema-2</a></cite>] of the value of <span class="math">n</span>, ignoring trailing zeros.</li>
        </ul>
        <p>
          The operators <span class="math">&lt;=</span>, <span class="math">&lt;</span>, <span class="math">&gt;=</span> and <span class="math">&gt;</span> are evaluated after performing <a href="https://www.w3.org/TR/xpath20/#promotion">numeric type promotion</a>[<cite><a class="bibref" href="#bib-xpath20" title="XML Path Language (XPath) 2.0 (Second Edition)" data-link-type="biblio">xpath20</a></cite>].
        </p>
        <div class="example">
          <div class="example-title marker"><span>Numeric Facets example 1</span></div>
          <div class="repchoice" tabindex="0">
            <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint",
      "predicate": "http://schema.example/#confirmations",
      "valueExpr": { "type": "NodeConstraint", "mininclusive": 1 } } } ] }</pre>
            <pre class="shexc nohighlight rephidden">                                                                          
  ex:IssueShape {
    ex:confirmations MININCLUSIVE 1
  }

 </pre>
          <button>json</button></div>
            <pre class="data" aria-busy="false"><code class="hljs">&lt;issue1&gt; ex:confirmations 1 .
&lt;issue2&gt; ex:confirmations 2^^xsd:byte .
&lt;issue3&gt; ex:confirmations 0 .
&lt;issue4&gt; ex:confirmations "ii"^^ex:romanNumeral .</code></pre>
            <table>
              <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
              <tr class="pass"><td>&lt;issue1&gt;</td><td>&lt;IssueShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
              <tr class="pass"><td>&lt;issue2&gt;</td><td>&lt;IssueShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
              <tr class="fail"><td>&lt;issue3&gt;</td><td>&lt;IssueShape&gt;</td><td>fail</td><td class="fail"><code>0</code> is less than <code>1</code>.</td></tr>
              <tr class="fail"><td>&lt;issue4&gt;</td><td>&lt;IssueShape&gt;</td><td>fail</td><td class="fail"><code>ex:romanNumeral</code> is not a numeric datatype.</td></tr>
            </tbody></table>
          </div>
      </section>

      <section id="values">
        <h4 id="x5-4-6-values-constraint"><bdi class="secno">5.4.6 </bdi>Values Constraint<a class="self-link" aria-label="§" href="#values"></a></h4>
        <p>
          The <code>nodeSatisfies</code> semantics for <span class="jobjref"><a class="obj internalDFN" href="#dfn-nodeconstraint" data-link-type="dfn">NodeConstraint</a></span> <span class="param">values</span> depends on a <code>nodeIn</code> function <a href="#nodeIn">defined below</a>.
        </p>
        <p>
          For a node <span class="math">n</span> and constraint value <span class="math">v</span>, <code class="function">nodeSatisfies(<span class="math">n</span>, <span class="math">v</span>)</code> if <span class="math">n</span> matches some <a class="nobref internalDFN" href="#dfn-valuesetvalue" data-link-type="dfn">valueSetValue</a> <span class="math">vsv</span> in <span class="math">v</span>.
          A term matches a valueSetValue if:
        </p>
        <ul>
          <li><span class="math" id="nodeSatisfies-objectValue">vsv</span> is an <a class="nobref internalDFN" href="#dfn-objectvalue" data-link-type="dfn">objectValue</a> and <span class="math">n = vsv</span>.</li>
          <li><span class="math">vsv</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-language" data-link-type="dfn">Language</a></span> with <span class="param">languageTag</span> <span class="math">lt</span> and <span class="math">n</span> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a> with a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> <span class="math">l</span> and <span class="math function">l = lt</span>.</li>
          <li><span class="math" id="nodeSatisfies-Stem">vsv</span> is a <span class="jobjref"><a class="nobref internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a></span>, <span class="jobjref"><a class="nobref internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a></span> or <span class="jobjref"><a class="nobref internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a></span> with <span class="param">stem</span> <span class="math">st</span> and <span class="math">nodeIn(n, st)</span>.</li>
          <li><span class="math" id="nodeSatisfies-StemRange">vsv</span> is a <span class="jobjref"><a class="nobref internalDFN" href="#dfn-iristemrange" data-link-type="dfn">IriStemRange</a></span>, <span class="jobjref"><a class="nobref internalDFN" href="#dfn-literalstemrange" data-link-type="dfn">LiteralStemRange</a></span> or <span class="jobjref"><a class="nobref internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a></span> with <span class="param">stem</span> <span class="math">st</span> and <span class="param">exclusions</span> <span class="math">excls</span> and <span class="math function">nodeIn(n, st)</span> and there is no <span class="math">x</span> in <span class="math">excls</span> such that <span class="math function">nodeIn(n, excl)</span>.</li>
          <li><span class="math" id="nodeSatisfies-Wildcard">vsv</span> is a <span class="jobjref"><a class="nobref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a></span> with <span class="param">exclusions</span> <span class="math">excls</span> and there is no <span class="math">x</span> in <span class="math">excls</span> such that <span class="math function">nodeIn(n, excl)</span>.</li>
        </ul>
        <p>
          <span class="label" id="nodeIn">nodeIn</span>: asserts that an RDF node <span class="math">n</span> is equal to an RDF term <span class="math">s</span> or is in a set defined by a <span class="jobjref"><a class="obj internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a></span>, <span class="jobjref"><a class="obj internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a></span> or <span class="jobjref"><a class="obj internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a></span>.<br />
          The expression <code class="function">nodeIn(<span class="math">n</span>, <span class="math">s</span>)</code> is satisfied if:
        </p>
        <ul>
          <li><span class="math">n = s</span>.</li>
          <li><span class="math">s</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a></span>, <span class="jobjref"><a class="obj internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a></span> or <span class="jobjref"><a class="obj internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a></span> with <span class="param">stem</span> <span class="math">st</span> and:
          <ul>
            <li><span class="math">s</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a></span> and <span class="math">n</span> is an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a> and <span class="math function"><a href="https://www.w3.org/TR/xpath-functions-31/#func-starts-with">fn:starts-with</a>(n, st)</span>.</li>
            <li><span class="math">s</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a></span> and <span class="math">n</span> is an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">RDF Literal</a> with a lexical value <span class="math">l</span> and <span class="math function"><a href="https://www.w3.org/TR/xpath-functions-31/#func-starts-with">fn:starts-with</a>(l, st)</span>.</li>
            <li><span class="math">s</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a></span>, <span class="math">n</span> is a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a> with a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> <span class="math">l</span>, <span class="math">st</span> is a basic language range  per <a class="norm" href="http://www.ietf.org/rfc/rfc4647.txt">Matching of Language Tags</a> [<cite><a class="bibref" href="#bib-rfc4647" title="Matching of Language Tags" data-link-type="biblio">rfc4647</a></cite>] section 2.1 and <span class="math">l</span> matches <span class="math">st</span> per the basic filtering scheme defined in [<cite><a class="bibref" href="#bib-rfc4647" title="Matching of Language Tags" data-link-type="biblio">rfc4647</a></cite>] section 3.3.1.</li>
          </ul></li>
        </ul>
        <div class="example">
          <div class="example-title marker"><span>Values Constraint example 1</span></div>
          <p>NoActionIssueShape requires a state of Resolved or Rejected:</p>
          <div class="repchoice" tabindex="0">
            <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#NoActionIssueShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint",
      "predicate": "http://schema.example/#state",
      "valueExpr": {
        "type": "NodeConstraint", "values": [
          "http://schema.example/#Resolved",
          "http://schema.example/#Rejected" ] } } } ] }</pre>
            <pre class="shexc nohighlight rephidden">                                                       
  ex:NoActionIssueShape {
    ex:state [ ex:Resolved ex:Rejected ]
  }




 </pre>
          <button>json</button></div>
          <pre class="data" aria-busy="false"><code class="hljs">&lt;issue1&gt; ex:state ex:Resolved .
&lt;issue2&gt; ex:state ex:Unresolved .</code></pre>
          <table>
            <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
            <tr class="pass"><td>&lt;issue1&gt;</td><td>&lt;NoActionIssueShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="fail"><td>&lt;issue2&gt;</td><td>&lt;NoActionIssueShape&gt;</td><td>fail</td><td class="fail"><code>ex:state</code> expected to be <code>ex:Resolved</code> or <code>ex:Rejected</code>, <code>ex:Unresolved</code> found.</td></tr>
          </tbody></table>
        </div>

        <div class="example">
          <div class="example-title marker"><span>Values Constraint example 2</span></div>
          <p>An employee must have an email address that is the string "N/A" or starts with "engineering-"  or "sales-" but not "sales-contacts" or "sales-interns":</p>
          <div class="repchoice" tabindex="0">
            <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#EmployeeShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint",
      "predicate": "http://xmlns.com/foaf/0.1/mbox",
      "valueExpr": {
        "type": "NodeConstraint", "values": [
          {"value": "N/A"},
          { "type": "IriStem", "stem": "mailto:engineering-" },
          { "type": "IriStemRange", "stem": "mailto:sales-", "exclusions": [
              { "type": "IriStem", "stem": "mailto:sales-contacts" },
              { "type": "IriStem", "stem": "mailto:sales-interns" }
            ] }
        ] } } } ] }</pre>
            <pre class="shexc nohighlight rephidden">                                                                            
  ex:EmployeeShape {
    foaf:mbox [ "N/A"
                &lt;mailto:engineering-&gt;~
                &lt;mailto:sales-&gt;~
                    - &lt;mailto:sales-contacts&gt;~
                    - &lt;mailto:sales-interns&gt;~ ]
  }





 </pre>
          <button>json</button></div>
          <pre class="data" aria-busy="false"><code class="hljs">&lt;issue3&gt; foaf:mbox "N/A" .
&lt;issue4&gt; foaf:mbox &lt;mailto:engineering-2112@a.example&gt; .
&lt;issue5&gt; foaf:mbox &lt;mailto:sales-835@a.example&gt; .
&lt;issue6&gt; foaf:mbox "missing" .
&lt;issue7&gt; foaf:mbox &lt;mailto:sales-contacts-999@a.example&gt; .</code></pre>
          <table>
            <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
            <tr class="pass"><td>&lt;issue3&gt;</td><td>&lt;EmployeeShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="pass"><td>&lt;issue4&gt;</td><td>&lt;EmployeeShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="pass"><td>&lt;issue5&gt;</td><td>&lt;EmployeeShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="fail"><td>&lt;issue6&gt;</td><td>&lt;EmployeeShape&gt;</td><td>fail</td><td class="fail"><code>"missing"</code> is not in value set.</td></tr>
            <tr class="fail"><td>&lt;issue7&gt;</td><td>&lt;EmployeeShape&gt;</td><td>fail</td><td class="fail"><code>&lt;mailto:sales-contacts-999@a.example&gt;</code> is excluded.</td></tr>
          </tbody></table>
        </div>

        <div class="example">
          <div class="example-title marker"><span>Values Constraint example 3</span></div>
          <p>An employee must not have an email address that starts with "engineering-"  or "sales-":</p>
          <div class="repchoice" tabindex="0">
            <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#EmployeeShape",
    "type": "Shape", "expression": {
      "type": "TripleConstraint",
      "predicate": "http://xmlns.com/foaf/0.1/mbox",
      "valueExpr": {
        "type": "NodeConstraint", "values": [
          { "type": "IriStemRange", "stem": {"type": "Wildcard"},
            "exclusions": [
              { "type": "IriStem", "stem": "mailto:engineering-" },
              { "type": "IriStem", "stem": "mailto:sales-" }
            ] }
        ] } } } ] }</pre>
            <pre class="shexc nohighlight rephidden">                                                                   
  ex:EmployeeShape {
    foaf:mbox [ . - &lt;mailto:engineering-&gt;~ - &lt;mailto:sales-&gt;~ ]
  }








 </pre>
          <button>json</button></div>
          <pre class="data" aria-busy="false"><code class="hljs">&lt;issue8&gt; foaf:mbox 123 .
&lt;issue9&gt; foaf:mbox &lt;mailto:core-engineering-2112@a.example&gt; .
&lt;issue10&gt; foaf:mbox &lt;mailto:engineering-2112@a.example&gt; .</code></pre>
          <table>
            <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>reason</th></tr>
            <tr class="pass"><td>&lt;issue8&gt;</td><td>&lt;EmployeeShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="pass"><td>&lt;issue9&gt;</td><td>&lt;EmployeeShape&gt;</td><td>pass</td><td class="noreason"></td></tr>
            <tr class="fail"><td>&lt;issue10&gt;</td><td>&lt;EmployeeShape&gt;</td><td>fail</td><td class="fail"><code>&lt;mailto:engineering-2112@a.example&gt;</code> is excluded.</td></tr>
          </tbody></table>
        </div>

        <p>
          A value set can have a single value in it.
          This is used to indicate that a specific value is required, e.g. that an ex:state must be equal to &lt;http://schema.example/#Resolved&gt; or the rdf:type of some node must be foaf:Person.
        </p>
      </section>
    </section>
      <section id="shapes-and-TEs">
        <h3 id="x5-5-shapes-and-triple-expressions"><bdi class="secno">5.5 </bdi>Shapes and Triple Expressions<a class="self-link" aria-label="§" href="#shapes-and-TEs"></a></h3>
      
      <p>
        Triple expressions are used for defining patterns composed of triple constraints.
        Shapes associate <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expressions</a> with flags indicating whether triples match if they do not correspond to triple constraints in the <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a>.
        A <dfn data-lt="triple expressions|triple expression" data-dfn-type="dfn" id="dfn-triple-expressions">triple expression</dfn> is composed of <span class="jobjref"><a href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">TripleConstraint</a></span> and <span class="jobjref"><a href="#dfn-tripleexprref" class="internalDFN" data-link-type="dfn">tripleExprRef</a></span> objects composed with grouping and choice operators.
      </p>
      
      <section id="triple-expressions-abstract-syntax">
      <h4 id="x5-5-1-json-syntax"><bdi class="secno">5.5.1 </bdi>JSON Syntax<a class="self-link" aria-label="§" href="#triple-expressions-abstract-syntax"></a></h4>

      <div class="shexjTable">
        <table class="shexj">
  <tbody><tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-shape">Shape</dfn></th>                       <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">closed</span>:<a href="#dfn-bool" class="internalDFN" data-link-type="dfn">BOOL</a>? <span class="param">extra</span>:[<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a>+]? <span class="param">expression</span>:<a class="nobref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-tripleexpr">tripleExpr</dfn></th>             <td>=</td><td><a class="objref internalDFN" href="#dfn-eachof" data-link-type="dfn">EachOf</a> | <a class="objref internalDFN" href="#dfn-oneof" data-link-type="dfn">OneOf</a> | <a class="objref internalDFN" href="#dfn-tripleconstraint" data-link-type="dfn">TripleConstraint</a> | <a class="objref internalDFN" href="#dfn-tripleexprref" data-link-type="dfn">tripleExprRef</a> ;</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-eachof">EachOf</dfn></th>                     <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a>? <dfn class="param" data-dfn-type="dfn" id="dfn-expressions">expressions</dfn>:[<a class="nobref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>{2,}] <span class="param">min</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">max</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-oneof">OneOf</dfn></th>                       <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a>? <span class="param">expressions</span>:[<a class="nobref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>{2,}] <span class="param">min</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">max</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
  <tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-tripleconstraint">TripleConstraint</dfn></th> <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a>? <span class="param">inverse</span>:<a href="#dfn-bool" class="internalDFN" data-link-type="dfn">BOOL</a>? <a class="param" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> <span class="param">valueExpr</span>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>? <span class="param">min</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">max</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-tripleexprref">tripleExprRef</dfn></th>       <td>=</td><td><a class="objref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a> ;</td></tr>
  <tr class="nob"><th class="nob"><dfn data-dfn-type="dfn" id="dfn-tripleexprlabel">tripleExprLabel</dfn></th>   <td>=</td><td><a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a href="#dfn-bnode" class="internalDFN" data-link-type="dfn">BNODE</a> ;</td></tr>
        </tbody></table>
      </div>
      </section>
      
      <section id="triple-expressions-semantics">
        <h4 id="x5-5-2-semantics"><bdi class="secno">5.5.2 </bdi>Semantics<a class="self-link" aria-label="§" href="#triple-expressions-semantics"></a></h4>
        <p id="satisfies-Shape">
          The semantics of the <code>matchesShape</code> function are based on the <code>matches</code> function <a href="#matches">defined below</a>.
	  For a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> <span class="math">n</span>, <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> <span class="math">S</span>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> <span class="math">G</span>, a ShExSchema <span class="math">Sch</span>, and <a href="#dfn-typing" class="internalDFN" data-link-type="dfn">typing</a> <span class="math">m</span>, <code class="function">matchesShape(<span class="math">n</span>, <span class="math">S</span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</code> if and only if:
        </p>
        <ul>
          <li>
            <code class="function"><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(<span class="math">G</span>, <span class="math">n</span>)</code> can be partitioned into two sets <span class="math">matched</span> and <span class="math">remainder</span> such that <code class="function">matches(<span class="math">matched</span>, <span class="param">expression</span>, <span class="math">m</span>)</code>.
            If <span class="param">expression</span> is absent, <code class="function"><span class="math">remainder</span> = <a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(<span class="math">G</span>, <span class="math">n</span>)</code>.<br />
            Let <span class="label">outs</span> be the <span class="math"><a href="#dfn-arcsout" class="internalDFN" data-link-type="dfn">arcsOut</a></span> in <span class="math">remainder</span>:
            <code class="function"><span class="math">outs</span> = <span class="math">remainder</span> ∩ <a href="#dfn-arcsout" class="internalDFN" data-link-type="dfn">arcsOut</a>(<span class="math">G</span>, <span class="math">n</span>)</code>.<br />
            Let <span class="label">matchables</span> be the triples in <span class="math">outs</span> whose <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> appears in a <span class="jobjref"><a class="obj internalDFN" href="#dfn-tripleconstraint" data-link-type="dfn">TripleConstraint</a></span> in <span class="param">expression</span>.
            If <span class="param">expression</span> is absent, <code class="function"><span class="math">matchables</span> = <span class="math">Ø</span> (the empty set)</code>.<br />
            The complexity of partitioning is described briefly in the <a href="../primer/#partition-complexity">ShEx2 Primer</a>.
          </li>
          <li>
            There is no triple in <span class="label">matchables</span> which matches a <span class="jobjref"><a class="obj internalDFN" href="#dfn-tripleconstraint" data-link-type="dfn">TripleConstraint</a></span> in <span class="param">expression</span>.<br />
            Let <span class="label">unmatchables</span> be the triples in <span class="math">outs</span> which are not in <span class="math">matchables</span>.
            <code class="function"><span class="math">matchables</span> ∪ <span class="math">unmatchables</span> = <span class="math">outs</span></code>.
          </li>
          <li>
            There is no triple in <span class="math">matchables</span> whose <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> does not appear in <span class="param">extra</span>.
          </li>
          <li><span class="param">closed</span> is false or <span class="math">unmatchables</span> is empty.</li>
        </ul>
      <p>
        <span class="label" id="matches">matches</span>: asserts that a <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> is matched by a set of triples that come from the neighbourhood of a node in an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a>.
        The expression <code>matches(<span class="math">T</span>, <span class="math">expr</span>, <span class="math">m</span>)</code> indicates that a set of triples <span class="math">T</span> can satisfy these rules:
      </p>
      <ul>
        <li>
          <p id="matches-semActs"><span class="math">expr</span> has <span class="param">semActs</span> and <code class="function">matches(<span class="math">T</span>, <span class="math">expr</span>, <span class="math">m</span>)</code> by the remaining rules in this list and the evaluation of <span class="param">semActs</span> succeeds according to the section below on <a href="#semantic-actions">Semantic Actions</a>.</p>
          <div class="example">
            <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T,<br />
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "OneOf", "shapeExprs": [<span class="comment">te<sub>1</sub></span>, <span class="comment">te<sub>2</sub>, …</span>], "min": 2, "max": 3,     
  "semActs": [<span class="comment">SemAct<sub>1</sub></span>, <span class="comment">SemAct<sub>2</sub>, …</span>] }</pre>
              <pre class="shexc nohighlight rephidden">(<span class="comment">te<sub>1</sub></span> | <span class="comment">te<sub>2</sub> …</span>) {2,3}                                                     
        %&lt;SemAct<sub>1</sub>&gt;% %&lt;SemAct2&gt;% …</pre>
              <button>json</button></div>,<br />
              m)</div>
            </div>
            <div style="clear:both;">evaluates as:</div>
            <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T,<br />
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "OneOf", "shapeExprs": [<span class="comment">te<sub>1</sub></span>, <span class="comment">te<sub>2</sub>, …</span>], "min": 2, "max": 3 }     </pre>
              <pre class="shexc nohighlight rephidden">(<span class="comment">te<sub>1</sub></span> | <span class="comment">te<sub>2</sub> …</span>) {2,3}                                                      </pre>
              <button>json</button></div>,<br />
              m)</div>
            </div>
            <div style="clear:both;"></div>
            <span class="math function">and <a href="#semActsSatisfied">semActsSatisfied</a>(<span class="inline json">[<span class="comment">SemAct<sub>1</sub></span>, <span class="comment">SemAct<sub>2</sub>, …</span>]</span>)</span>
          </div>
        </li>
        <li>
          <p id="matches-cardinality"><span class="math">expr</span> has a <dfn data-dfn-type="dfn" id="dfn-cardinality">cardinality</dfn> of <span class="param">min</span> and/or <span class="param">max</span> not equal to 1, where a <span class="param">max</span> of -1 is treated as unbounded, and <span class="math">T</span> can be partitioned into <span class="math">k</span> subsets <span class="math function">T<sub>1</sub></span>, <span class="math">T<sub>2</sub></span>,…<span class="math">T<sub>k</sub></span> such that <span class="math">min ≤ k ≤ max</span> and for each <span class="math">T<sub>n</sub></span>, <code class="function">matches(<span class="math">T<sub>n</sub></span>, <span class="math">expr</span>, <span class="math">m</span>)</code> by the remaining rules in this list.</p>
          <div class="example">
            <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T,<br />
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "OneOf", "shapeExprs": [<span class="comment">te<sub>1</sub></span>, <span class="comment">te<sub>2</sub>, …</span>], "min": 2, "max": 3 }     </pre>
              <pre class="shexc nohighlight rephidden">(<span class="comment">te<sub>1</sub></span> | <span class="comment">te<sub>2</sub> …</span>) {2,3}                                                      </pre>
              <button>json</button></div>,<br />
              m)</div>
            </div>
            <div style="clear:both;">evaluates as:</div>
            <div class="math"><div style="float:left;">Let e = </div><div style="float:left;">
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "OneOf", "shapeExprs": [<span class="comment">te<sub>1</sub></span>, <span class="comment">te<sub>2</sub>, …</span>] }     </pre>
              <pre class="shexc nohighlight rephidden">(<span class="comment">te<sub>1</sub></span> | <span class="comment">te<sub>2</sub> …</span>)                                        </pre>
            <button>json</button></div></div>
            <div style="clear:both;"></div>
            (<span class="math function">matches(T<sub>1</sub>, e, m)</span> and
             <span class="math function">matches(T<sub>2</sub>, e, m)</span><br />
              and T = T<sub>1</sub> ∪ T<sub>2</sub>)<br />
            or<br />
            (<span class="math function">matches(T<sub>1</sub>, e, m)</span> and
              <span class="math function">matches(T<sub>2</sub>, e, m)</span> and
              <span class="math function">matches(T<sub>3</sub>, e, m)</span><br />
               and T = T<sub>1</sub> ∪ T<sub>2</sub> ∪ T<sub>3</sub>)</div>
          </div>
          
        </li>
        <li>
          <p id="matches-OneOf"><span class="math">expr</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-oneof" data-link-type="dfn">OneOf</a></span> and there is some <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> <span class="math">se2</span> in <span class="param">shapeExprs</span> such that <code class="function">matches(<span class="math">T</span>, <span class="math">se2</span>, <span class="math">m</span>)</code>.</p>
          <div class="example">
            <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T,<br />
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "OneOf", "shapeExprs": [
  { "type": "EachOf", "shapeExprs": [<span class="comment">te<sub>3</sub></span>, <span class="comment">te<sub>4</sub>, …</span>] },
  { "type": "TripleExpression", "min": 1, "max": -1,
    "predicate": "http://xmlns.com/foaf/0.1/name" }
] }</pre>
              <pre class="shexc nohighlight rephidden">                                                    
  (<span class="comment">te<sub>3</sub></span> ; <span class="comment">te<sub>4</sub> ; …</span>)
  | &lt;http://xmlns.com/foaf/0.1/name&gt; . +

 </pre>
              <button>json</button></div>,<br />
              m)</div>
            </div>
            <div style="clear:both;">evaluates as:</div>
            <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T,<br />
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "EachOf", "shapeExprs": [<span class="comment">te<sub>3</sub></span>, <span class="comment">te<sub>4</sub>, …</span>] }     </pre>
              <pre class="shexc nohighlight rephidden"><span class="comment">te<sub>3</sub></span> ; <span class="comment">te<sub>4</sub> ; …</span>                                         </pre>
              <button>json</button></div>,<br />
              m)</div>
            </div>
            <div style="clear:both;"></div>
            <div class="math"><div style="float:left;">or matches(</div><div style="float:left;">T,<br />
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "TripleExpression", "min": 1, "max": -1,     
    "predicate": "http://xmlns.com/foaf/0.1/name" }</pre>
              <pre class="shexc nohighlight rephidden">&lt;http://xmlns.com/foaf/0.1/name&gt; . +                   
 </pre>
              <button>json</button></div>,<br />
              m)</div>
            </div>
          </div>
        </li>
        <li>
          <p id="matches-EachOf"><span class="math">expr</span> is an <span class="jobjref"><a class="obj internalDFN" href="#dfn-eachof" data-link-type="dfn">EachOf</a></span> and there is some partition of <span class="math">T</span> into <span class="math">T<sub>1</sub></span>, <span class="math">T<sub>2</sub></span>,… such that for every expression <span class="function"><span class="math">expr<sub>1</sub></span>, <span class="math">expr<sub>2</sub></span>,…</span> in <span class="param">shapeExprs</span>, <code class="function">matches(<span class="math">T<sub>n</sub></span>, <span class="math">expr<sub>n</sub></span>, <span class="math">m</span>)</code>.</p>
          <div class="example">
            <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T,<br />
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "EachOf", "shapeExprs": [
  { "type": "TripleExpression",
    "predicate": "http://xmlns.com/foaf/0.1/givenName" },
  { "type": "TripleExpression",
    "predicate": "http://xmlns.com/foaf/0.1/familyName" }
] }</pre>
              <pre class="shexc nohighlight rephidden">                                                         
&lt;http://xmlns.com/foaf/0.1/givenName&gt; . ;

&lt;http://xmlns.com/foaf/0.1/familyName&gt; .

 </pre>
             <button>json</button></div>,<br />
              m)</div>
            </div>
            <div style="clear:both;">evaluates as:</div>
            <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T<sub>1</sub>,<br />
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "TripleExpression",
    "predicate": "http://xmlns.com/foaf/0.1/givenName" }</pre>
              <pre class="shexc nohighlight rephidden">&lt;http://xmlns.com/foaf/0.1/givenName&gt; .                 
 </pre>
              <button>json</button></div>,<br />
              m)</div>
            </div>
            <div style="clear:both;"></div>
            <div class="math"><div style="float:left;">and matches(</div><div style="float:left;">T<sub>2</sub>,<br />
            <div class="inline repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "TripleExpression",
    "predicate": "http://xmlns.com/foaf/0.1/familyName" }</pre>
              <pre class="shexc nohighlight rephidden">&lt;http://xmlns.com/foaf/0.1/familyName&gt; .                 
 </pre>
              <button>json</button></div>,<br />
              m)</div>
            </div>
            <div style="clear:both;"></div>
            <span class="math">and T = T<sub>1</sub> ∪ T<sub>2</sub></span>
          </div>
        </li>
        <li>
          <p id="matches-TripleConstraint"><span class="math">expr</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-tripleconstraint" data-link-type="dfn">TripleConstraint</a></span> and:</p>
          <ul>
            <li>
              <span class="math">T</span> is a set of one triple.<br />
              Let <span class="label">t</span> be the sole triple in <span class="math">T</span>.
            </li>
            <li>
              <span class="math">t</span>'s <a class="param" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> equals <span class="math">expr</span>'s <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a>.<br />
              Let <span class="label">value</span> be <span class="math">t</span>'s subject if <span class="param">inverse</span> is true, else <span class="math">t</span>'s object.
            </li>
            <li>
              if <span class="param">inverse</span> is true, <span class="math">t</span> is in <span class="math"><a href="#dfn-arcsin" class="internalDFN" data-link-type="dfn">arcsIn</a></span>, else <span class="math">t</span> is in <span class="math"><a href="#dfn-arcsout" class="internalDFN" data-link-type="dfn">arcsOut</a></span>.
            </li>
            <li>either
            <ul>
              <li>
                <p><span class="math">expr</span> has no <span class="param">valueExpr</span></p>
                <div class="example">
                  <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T,<br />
                  <div class="inline repchoice incomplete" tabindex="0">
                    <pre class="json nohighlight repchosen">{ "type": "TripleExpression",
  "predicate": "http://xmlns.com/foaf/0.1/givenName" }</pre>
                    <pre class="shexc nohighlight rephidden">&lt;http://xmlns.com/foaf/0.1/givenName&gt; . ;             
 </pre>
                  <button>json</button></div>,<br />
              m)</div>
                  </div>
                  <div style="clear:both;">holds if
                  <ul class="tight">
                    <li><span class="math">T</span> has exactly one triple <span class="math">t</span>.</li>
                    <li><span class="math">t</span> has the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> "<code>http://xmlns.com/foaf/0.1/givenName</code>"</li>
                  </ul></div>
                </div>
              </li>
              <li>
                <p>or <code class="function">satisfies(<span class="math">value</span>, <span class="param">valueExpr</span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</code>.</p>
                <div class="example">
                  <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T,<br />
                  <div class="inline repchoice incomplete" tabindex="0">
                    <pre class="json nohighlight repchosen">{ "type": "TripleConstraint", "inverse": true,
  "predicate": "http://purl.org/dc/elements/1.1/author",
  "valueExpr": "http://schema.example/#IssueShape" }</pre>
                    <pre class="shexc nohighlight rephidden">                                                        
^&lt;http://purl.org/dc/elements/1.1/author&gt;
        @&lt;http://schema.example/#IssueShape&gt;</pre>
                  <button>json</button></div>,<br />
              m)</div>
                  </div>
                  <div style="clear:both;">holds if
                  <ul class="tight">
                    <li><span class="math">T</span> has exactly one triple <span class="math">t</span>.</li>
                    <li><span class="math">t</span> has the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> "<code>http://purl.org/dc/elements/1.1/author</code>"</li>
                    <li><span class="math">t</span> has a subject <span class="math">n2</span></li>
                    <li>The schema's <a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a> maps "<code>http://schema.example/#IssueShape</code>" to <span class="math">se2</span></li>
                    <li><span class="math function">satisfies(n2, se2, G, Sch, m)</span></li>
                  </ul></div>
                </div>
                
              </li>
            </ul></li>
          </ul>
        </li>
        <li>
          <p id="matches-tripleExprRef">
            <span class="math">expr</span> is a <span class="jobjref"><a class="obj internalDFN" href="#dfn-tripleexprref" data-link-type="dfn">tripleExprRef</a></span> and <code class="function">satisfies(<span class="math">value</span>, tripleExprWithId(<span class="param">tripleExprRef</span>), <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">Sch</span>, <span class="math">m</span>)</code>.<br />
            The <code class="function">tripleExprWithId</code> function is defined in <a href="#tripleExprRef-requirement">Triple Expression Reference Requirement</a> below.
          </p>
          <div class="example">
            For the schema<br />
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#EmployeeShape",
    "type": "Shape", "expression": {
      "type": "EachOf", "expressions": [
        "http://schema.example/#nameExpr",
        { "type": "TripleConstraint",
          "predicate": "http://schema.example/#empID",
          "valueExpr": { "type": "NodeConstraint",
            "datatype": "http://www.w3.org/2001/XMLSchema#integer" } } ] } },
  { "id": "http://schema.example/#PersonShape",
    "type": "Shape", "expression": {
      "id": "http://schema.example/#nameExpr",
      "type": "TripleConstraint",
      "predicate": "http://xmlns.com/foaf/0.1/name" } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                             
&lt;http://schema.example/#EmployeeShape&gt; {
    &amp;<span class="lookit">&lt;http://schema.example/#nameExpr&gt;</span> ;
    &lt;http://schema.example/#empID&gt;
          &lt;http://www.w3.org/2001/XMLSchema#integer&gt;



}
&lt;http://schema.example/#PersonShape&gt; {

  <span class="lookit">$&lt;http://schema.example/#nameExpr&gt;</span>
    &lt;http://xmlns.com/foaf/0.1/name&gt; . ;
}</pre>
            <button>json</button></div><div style="clear:both;"></div>
            <div class="math"><div style="float:left;">matches(</div><div style="float:left;">T,<br />
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-string">"http://schema.example/#PersonShape"</span></code></pre></div>,<br />
              m)</div>
            </div>
            <div style="clear:both;">holds if
            <ul class="tight">
              <li>The schema has a shape <span class="math">se2</span> with the <span class="param">id</span> "<code>http://schema.example/#PersonShape</code>"</li>
              <li><span class="math function">satisfies(n, se2, G, Sch, m)</span></li>
            </ul></div>
          </div>
        </li>
      </ul>
    </section>
      </section>

    <section id="import">
      <h3 id="x5-6-shex-import"><bdi class="secno">5.6 </bdi>ShEx Import<a class="self-link" aria-label="§" href="#import"></a></h3>
      <p>
        The presence of <span class="param">imports</span> requires that:
      </p>
      <ul>
        <li>each IRI in <span class="param">imports</span> be resolved and</li>
        <li>the returned representation of that IRI be interpreted as a ShEx <span class="math">S</span> and</li>
        <li>each <a class="jobjref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a> in <span class="math">S</span>.<span class="param">shapes</span> be in scope for resolving shape expression references and</li>
        <li>each <a class="jobjref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a> with a <a class="jobjref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a> be in scope for resolving triple expression references.</li>
      </ul>
      <p>
        If any imported schema imports other schemas, shape and triple expression labels from those schemas are also in scope.
      </p>
          <div class="example">
            <div class="example-title marker"><span>Import example 1 - Shape and Triple Expressions</span></div>
            <div class="repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen"><span class="label">schema1:</span>
{ "type": "Schema", "imports": ["http://schema.example/schema2"], "shapes": [
  { "id": "http://schema.example/#EmployeeShape",
    "type": "Shape", "expression": {
      "type": "EachOf", "expressions": [
        "http://schema.example/#nameExpr",
        { "type": "TripleConstraint",
          "predicate": "http://schema.example/#empID",
          "valueExpr": { "type": "NodeConstraint",
            "datatype": "http://www.w3.org/2001/XMLSchema#integer" } } ] } } ] }
<span class="label">schema2:</span>
{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#PersonShape",
    "type": "Shape", "expression": {
      "id": "http://schema.example/#nameExpr",
      "type": "TripleConstraint",
      "predicate": "http://xmlns.com/foaf/0.1/name" } } ] }</pre>
              <pre class="shexc nohighlight rephidden"><span class="label">schema1:</span>                                                                        
&lt;http://schema.example/#EmployeeShape&gt; {
    &amp;&lt;http://schema.example/#nameExpr&gt; ;
    &lt;http://schema.example/#empID&gt;
          &lt;http://www.w3.org/2001/XMLSchema#integer&gt;




}
<span class="label">schema2:</span>
<span class="lookit">&lt;http://schema.example/#PersonShape&gt;</span> {

  <span class="lookit">$&lt;http://schema.example/#nameExpr&gt;</span>
    &lt;http://xmlns.com/foaf/0.1/name&gt; ;
}
 </pre>
            <button>json</button></div>
            <p>
              Both the shape expression <code>&lt;PersonShape&gt;</code> and the triple expression <code>&lt;nameExpr&gt;</code> are in scope.<br />
              <span class="label">schema2</span>'s <code>&lt;nameExpr&gt;</code> is referenced in <span class="label">schema1</span>'s <code>&lt;EmployeeShape&gt;</code>
            </p>
          </div>
      <p>
        Redundant imports are treated as a single import.
        This includes circular imports:
      </p>
          <div class="example">
            <div class="example-title marker"><span>Import example 2 - Circular Import</span></div>
            <div class="repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen"><span class="label">schema1:</span>
{ "type": "Schema",
  "imports": ["http://schema.example/schema2", "http://schema.example/schema3"],
  "shapes": [
  { "id": "http://schema.example/schema1#S1",
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#p1",
      "valueExpr": "http://schema.example/schema1#S2"
    } } ] }
<span class="label">schema2:</span>
{ "type": "Schema",
  "imports": ["http://schema.example/schema3"],
  "shapes": [
  { "id": "http://schema.example/schema1#S2",
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#p2",
      "valueExpr": "http://schema.example/schema1#S3"
    } } ] }
<span class="label">schema3:</span>
{ "type": "Schema",
  "imports": ["http://schema.example/schema1"],
  "shapes": [
  { "id": "http://schema.example/schema1#S3",
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#p3",
      "valueExpr": "http://schema.example/schema1#S1", "min": 0,
    } } ] }</pre>
              <pre class="shexc nohighlight rephidden"><span class="label">schema1:</span>                                                                        

IMPORT &lt;http://schema.example/schema2&gt; &lt;http://schema.example/schema3&gt;

&lt;http://schema.example/schema1#S1&gt; {

  &lt;http://schema.example/#p1&gt; @&lt;http://schema.example/schema1#S2&gt;


<span class="label">schema2:</span>

IMPORT &lt;http://schema.example/schema3&gt;

&lt;http://schema.example/schema1#S2&gt; {

  &lt;http://schema.example/#p2&gt; @&lt;http://schema.example/schema1#S3&gt;


<span class="label">schema3:</span>

IMPORT &lt;http://schema.example/schema1&gt;

&lt;http://schema.example/schema1#S3&gt; {

  &lt;http://schema.example/#p3&gt; @&lt;http://schema.example/schema1#S1&gt;?

 </pre>
            <button>json</button></div>
          </div>
      <p>
        When some schema <span class="math">A</span> imports schema <span class="math">B</span>, <span class="math">B</span>'s <a class="jobjref internalDFN" href="#dfn-start" data-link-type="dfn">start</a> member is ignored.
      </p>
          <div class="example">
            <div class="example-title marker"><span>Import example 3 - Ignored Start In Import</span></div>
            <div class="repchoice incomplete" tabindex="0">
              <pre class="json nohighlight repchosen"><span class="label">schema1:</span>
{ "type": "Schema",
  "imports": ["http://schema.example/schema2"],
  "shapes": [
  { "id": "http://schema.example/schema1#S1",
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#p1",
      "valueExpr": "http://schema.example/schema1#S2"
    } } ] }
<span class="label">schema2:</span>
{ "type": "Schema",
  <span class="lookit">"start": "http://schema.example/schema1#S2"</span>,
  "shapes": [
  { "id": "http://schema.example/schema1#S2",
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#p2"
    } } ] }</pre>
              <pre class="shexc nohighlight rephidden"><span class="label">schema1:</span>                                                                   

IMPORT &lt;http://schema.example/schema2&gt;

&lt;http://schema.example/schema1#S1&gt; {

  &lt;http://schema.example/#p1&gt; @&lt;http://schema.example/schema1#S2&gt;

}
<span class="label">schema2:</span>

<span class="lookit">start=@&lt;http://schema.example/schema1#S2&gt;</span>

&lt;http://schema.example/schema1#S2&gt; {

  &lt;http://schema.example/#p2&gt; .
}</pre>
            <button>json</button></div>
          <p>
            <code>schema1</code> has no <code>start</code> even though it imports a schema with a <code>start</code>.
          </p>
          </div>
        <p>
        It is an error if <code>A</code> and <code>B</code> share any labels for shape expressions or triple expressions or if schema <code>B</code> has a <a class="jobjref internalDFN" href="#dfn-startacts" data-link-type="dfn">startActs</a> member.
      </p>
          <div class="example">
            <div class="example-title marker"><span>Import example 4 - Erroneous Import</span></div>
            <div class="repchoice error incomplete" tabindex="0">
              <pre class="json nohighlight repchosen"><span class="label">schema1:</span>
{ "type": "Schema",
  "imports": ["http://schema.example/schema2"],
  "shapes": [
  { "id": "http://schema.example/schema1#S1",
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#p1",
      "valueExpr": "http://schema.example/schema1#S2"
    } } ] }
<span class="label">schema2:</span>
{ "type": "Schema",
<span class="lookit">"startActs": [ { "type": "semAct",
                 "name": "http://schema.example/schema1#A1" } ]</span>,
  "shapes": [
  { <span class="lookit">"id": "http://schema.example/schema1#S1"</span>,
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#p1",
      "valueExpr": "http://schema.example/schema1#S2"
    } },
  { "id": "http://schema.example/schema1#S2",
    "type": "Shape", "expression": {
      "type": "TripleConstraint", "predicate": "http://schema.example/#p2",
      "valueExpr": <span class="lookit">"http://schema.example/schema1#S3"</span>
    } } ] }</pre>
              <pre class="shexc nohighlight rephidden"><span class="label">schema1:</span>                                                                   

IMPORT &lt;http://schema.example/schema2&gt;

&lt;http://schema.example/schema1#S1&gt; {

  &lt;http://schema.example/#p1&gt; @&lt;http://schema.example/schema1#S2&gt;

}
<span class="label">schema2:</span>

<span class="lookit">%@&lt;http://schema.example/schema1#A1&gt;%</span>


<span class="lookit">&lt;http://schema.example/schema1#S1&gt;</span> {

  &lt;http://schema.example/#p1&gt; @&lt;http://schema.example/schema1#S2&gt;

}
&lt;http://schema.example/schema1#S2&gt; {

  &lt;http://schema.example/#p2&gt; <span class="lookit">@&lt;http://schema.example/schema1#S3&gt;</span>

}</pre>
            <button>json</button></div>
          <p>
            This import fails because:
          </p>
          <ul>
            <li><code>&lt;http://schema.example/schema1#S1&gt;</code> has conflicting definitions and</li>
            <li>an included schema has a <code>start</code> directive and</li>
            <li>the reference to <code>&lt;http://schema.example/schema1#S3&gt;</code> is not resolvable after imports.</li>
          </ul>
          </div>
    </section>

    <section id="schema-requirements">
      <h3 id="x5-7-schema-requirements"><bdi class="secno">5.7 </bdi>Schema Requirements<a class="self-link" aria-label="§" href="#schema-requirements"></a></h3>
      <p>
        The semantics defined above assume three structural requirements beyond those imposed by the grammar of the abstract syntax.
        These ensure referential integrity and eliminate logical paradoxes such as those that arrise through the use of negation.
        These are not constraints expressed by the schema but instead those imposed on the schema.
      </p>

      <section id="validation-requirement">
        <h4 id="x5-7-1-schema-validation-requirement"><bdi class="secno">5.7.1 </bdi>Schema Validation Requirement<a class="self-link" aria-label="§" href="#validation-requirement"></a></h4>

        <p>A <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> <span class="math">G</span> is said to <dfn data-lt="conforms|conformance|conform" data-dfn-type="dfn" id="dfn-conforms">conform</dfn> with
          a <a href="#dfn-shapes-schema" class="internalDFN" data-link-type="dfn">schema</a> <span class="math">S</span> with a <a data-link-type="dfn" href="http://shex.io/shape-map/#dfn-fixed-shapemap">ShapeMap</a> <span class="math">m</span> when:</p>
        <ol class="algorithm">
          <li>Every, <a href="#dfn-semact" class="internalDFN" data-link-type="dfn">SemAct</a> in the <a href="#dfn-startacts" class="internalDFN" data-link-type="dfn">startActs</a> of <span class="math">S</span>
            has a successful evaluation of <a href="#semActsSatisfied">semActsSatisfied</a>.</li>
          <li>Every <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-node">node</a> <span class="math">n</span> in <span class="math">m</span> <a href="#dfn-conforms" class="internalDFN" data-link-type="dfn">conforms</a> to its associated
            <a href="#dfn-shapeexprrefs" class="internalDFN" data-link-type="dfn">shapeExprRefs</a> <span class="math">se<sub>n</sub></span> where
            for each <a href="#dfn-shapeexprrefs" class="internalDFN" data-link-type="dfn">shapeExprRef</a> <span class="math">se<sub>i</sub></span> in <span class="math">se<sub>n</sub></span>:
            <ol class="algorithm">
              <li><span class="math">se<sub>i</sub></span> references a <a href="#dfn-shapeexpr" class="internalDFN" data-link-type="dfn">ShapeExpr</a> in <a href="#dfn-shapes" class="internalDFN" data-link-type="dfn">shapes</a>, and</li>
              <li><code class="function">satisfies(<span class="math">n</span>, <span class="math">se<sub>i</sub></span>, <span class="math">G</span>, <span class="math">Sch</span>, <span class="math">m</span>)</code>
                for each <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> <span class="math">se<sub>i</sub></span> in <span class="math">se<sub>n</sub></span>.</li>
            </ol>
          </li>
        </ol>
      </section>

      <section id="shapeExprRef-requirement">
        <h4 id="x5-7-2-shape-expression-reference-requirement"><bdi class="secno">5.7.2 </bdi>Shape Expression Reference Requirement<a class="self-link" aria-label="§" href="#shapeExprRef-requirement"></a></h4>
        <p>A <span class="jobjref"><a href="#dfn-shapeexprrefs" class="internalDFN" data-link-type="dfn">shapeExprRef</a></span> <em class="rfc2119" title="MUST">MUST</em> appear in the schema's <a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a> map (or an <a href="#import">imported schema's</a> map) and the corresponding <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> <em class="rfc2119" title="MUST">MUST</em> be a <span class="jobjref"><a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a></span> with a <span class="param">shapeExpr</span>.
          The function <code>shapeExprWithId(<span class="math">shapeExprRef</span>)</code> returns the shape expression with an <span class="param">id</span> of <span class="math">shapeExprRef</span>.
	</p>
	
	<p>
	  Additionally, a <span class="jobjref"><a href="#dfn-shapeexprlabel" class="internalDFN" data-link-type="dfn">shapeExprLabel</a></span> cannot refer to itself through a shape reference either directly or recursively.
	  The <dfn data-dfn-type="dfn" id="dfn-shapeexprref-closure">shapeExprRef closure</dfn> of a <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> <span class="math">se</span> is the set of shape expression labels used as references in <span class="math">se</span>.
	  The <a href="#dfn-shapeexprlabel" class="internalDFN" data-link-type="dfn">shapeExprLabel</a> <span class="math">sl</span> belongs to <code class="function">shapeExprRefClosure(<span class="math">se</span>)</code> if and only if:
	</p>
	<ul>
	  <li>
	    <span class="math">sl</span> appears as an atomic <span class="jobjref"><a href="#dfn-shapeexprrefs" class="internalDFN" data-link-type="dfn">shapeExprRef</a></span> in <span class="math">se</span>, or
	  </li>
	  <li>

	    <span class="math">sl</span> belongs to <code class="function">shapeExprRefClosure(shapeExprWithId(<span class="math">sl2</span>))</code> for some <a href="#dfn-shapeexprlabel" class="internalDFN" data-link-type="dfn">shapeExprLabel</a> <span class="math">sl2</span> that belongs to <code class="function">shapeExprRefClosure(<span class="math">se</span>)</code>.
	  </li>
	</ul>
	<p>
	  A shapes schema <em class="rfc2119" title="MUST NOT">MUST NOT</em> define a shape label <span class="math">sl</span> that belongs to the shapeExprRef closure of its definition  <code class="function">shapeExprWithId(<span class="math">sl</span>)</code>.
	</p>
	
      <div class="example">
        <p>
          Following are two valid shapeExprRefs:
        </p>
        <div class="repchoice" tabindex="0">
          <pre class="json nohighlight repchosen">{"type" : "Schema",
  "shapes" : [ {
    "id" : "http://schema.example/#PersonShape",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://xmlns.com/foaf/0.1/name"
    }
  }, {
    "id" : "http://schema.example/#EmployeeShape",
    "type" : "ShapeAnd",
    "shapeExprs" : [ "http://schema.example/#PersonShape", {
      "type" : "Shape",
      "expression" : {
        "type" : "TripleConstraint",
        "predicate" : "http://schema.example/#employeeNumber"
      }
    } ]
  } ]
}</pre>
          <pre class="shexc nohighlight rephidden">                                                             

    ex:PersonShape {



      foaf:name .
    }

    ex:EmployeeShape

      @ex:PersonShape AND {



        ex:employeeNumber .
      }


 </pre>
        <button>json</button></div>
        <div class="repchoice" tabindex="0">
          <pre class="json nohighlight repchosen">{"type" : "Schema",
  "shapes" : [ {
    "id" : "http://schema.example/#PersonShape",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://xmlns.com/foaf/0.1/name"
    }
  }, {
    "id" : "http://schema.example/#EmployeeShape",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#dependent",
      "valueExpr" : "http://schema.example/#PersonShape",
      "min" : 0,
      "max" : -1
    }
  } ]
}</pre>
          <pre class="shexc nohighlight rephidden">                                                         

    ex:PersonShape {



      foaf:name .
    }

    ex:EmployeeShape {



      ex:dependent
        @ex:PersonShape
          *

    }

 </pre>
        <button>json</button></div>
        <p>
          This shapeExprRef is invalid because there is no corresponding <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a>:
        </p>
        <div class="repchoice error" tabindex="0">
          <pre class="json nohighlight repchosen">{ "type":"Schema", "shapes": [
    { "id": "http://schema.example/#S1",
      "type":"Shape", "expression":
        "http://schema.example/#MissingShapeExpr"
} ] }</pre>
          <pre class="shexc nohighlight rephidden">                                                 
ex:S1 {

  &amp;ex:MissingShapeExpr
}</pre>
        <button>json</button></div>
        <p>This shapeExprRef is invalid because the referenced object is a <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> instead of a <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a>:</p>
        <div class="repchoice error" tabindex="0">
          <pre class="json nohighlight repchosen">{"type" : "Schema",
  "shapes" : [ {
    "id" : "http://schema.example/#CustomerShape",
    "type" : "Shape",
    "expression" : {
      "id" : "http://schema.example/#discountExpr",
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#discount"
    }
  }, {
    "id" : "http://schema.example/#EmployeeShape",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#contactFor",
      "valueExpr" : "http://schema.example/#discountExpr"
    }
  } ]
}</pre>
          <pre class="shexc nohighlight rephidden">                                                         

    ex:CustomerShape {


      $ex:discountExpr

        ex:discount .
    }

    ex:EmployeeShape {



      ex:contactFor
        @ex:discountExpr
    }

 </pre>
        <button>json</button></div>
	<p>These shapeExprRefs are invalid because they recursively refer to each other.</p>
	<div class="repchoice error" tabindex="0">
          <pre class="json nohighlight repchosen">{"type" : "Schema",
  "shapes" : [ {
    "id" : "http://schema.example/#PersonShape",
    "type" : "ShapeAnd",
    "shapeExprs" : [ "http://schema.example/#EmployeeShape", {
      "type" : "Shape",
      "expression" : {
        "type" : "TripleConstraint",
        "predicate" : "http://xmlns.com/foaf/0.1/name"
      }
    } ]
  }, {
    "id" : "http://schema.example/#EmployeeShape",
    "type" : "ShapeAnd",
    "shapeExprs" : [ "http://schema.example/#PersonShape", {
      "type" : "Shape",
      "expression" : {
        "type" : "TripleConstraint",
        "predicate" : "http://schema.example/#employeeNumber"
      }
    } ]
  } ] }</pre>
          <pre class="shexc nohighlight rephidden">                                                              

    ex:PersonShape

      @ex:EmployeeShape AND {



        foaf:name .
      }


    ex:EmployeeShape

      @ex:PersonShape AND {



        ex:employeeNumber .
    }

 </pre>
        <button>json</button></div>
      </div>
      </section>

      <section id="tripleExprRef-requirement">
        <h4 id="x5-7-3-triple-expression-reference-requirement"><bdi class="secno">5.7.3 </bdi>Triple Expression Reference Requirement<a class="self-link" aria-label="§" href="#tripleExprRef-requirement"></a></h4>
        <p>An <span class="jobjref"><a href="#dfn-tripleexprref" class="internalDFN" data-link-type="dfn">tripleExprRef</a></span> <em class="rfc2119" title="MUST">MUST</em> identify a <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> in the schema.
        The function <code>tripleExprWithId(<span class="math">tripleExprRef</span>)</code> returns the <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> with the id <span class="math">tripleExprRef</span>.
	</p>

	<p>
	  Additionally, a <span class="jobjref"><a href="#dfn-tripleexprlabel" class="internalDFN" data-link-type="dfn">tripleExprLabel</a></span> cannot refer to itself through a triple expression reference either directly or recursively.
	  The <dfn data-dfn-type="dfn" id="dfn-tripleexprref-closure">tripleExprRef closure</dfn> of a <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> <span class="math">te</span> is the set of triple expression labels used as references in <span class="math">te</span>.
	  The <a href="#dfn-tripleexprlabel" class="internalDFN" data-link-type="dfn">tripleExprLabel</a> <span class="math">tl</span> belongs to <code class="function">tripleExprRefClosure(<span class="math">te</span>)</code> if and only if:
	</p>
	<ul>
	  <li>
	    <span class="math">tl</span> appears as an atomic <span class="jobjref"><a href="#dfn-tripleexprref" class="internalDFN" data-link-type="dfn">tripleExprRef</a></span> in <span class="math">te</span>, or
	  </li>
	  <li>

	    <span class="math">tl</span> belongs to <code class="function">tripleExprRefClosure(tripleExprWithId(<span class="math">tl2</span>))</code> for some <a href="#dfn-tripleexprlabel" class="internalDFN" data-link-type="dfn">tripleExprLabel</a> <span class="math">tl2</span> that belongs to <code class="function">tripleExprRefClosure(<span class="math">te</span>)</code>.
	  </li>
	</ul>
	<p>
	  A shapes schema <em class="rfc2119" title="MUST NOT">MUST NOT</em> define a triple expression label <span class="math">tl</span> that belongs to the tripleExprRef closure of its definition <code class="function">tripleExprWithId(<span class="math">tl</span>)</code>.
	</p>
	
      <div class="example">
        <p>
          Following is a valid <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> reference:
        </p>
        <div class="repchoice" tabindex="0">
          <pre class="json nohighlight repchosen">{ "type":"Schema", "shapes": [
    { "id": "http://schema.example/#PersonShape",
      "type":"Shape", "expression": {
        "id": "http://schema.example/#nameExpr",
        "type": "TripleConstraint",
        "predicate": "http://xmlns.com/foaf/0.1/name"
      } },
    { "id": "http://schema.example/#EmployeeShape",
      "type":"Shape", "expression": { "type":"EachOf", "expressions": [
        "http://schema.example/#nameExpr",
        { "type": "TripleConstraint",
          "predicate": "http://schema.example/#employeeNumber" }
] } } ] }</pre>
          <pre class="shexc nohighlight rephidden">                                                                       
    ex:PersonShape {
      $ex:nameExpr foaf:name .
    }



    ex:EmployeeShape {
      &amp;ex:nameExpr ;
      ex:employeeNumber .
    }

 </pre>
        <button>json</button></div>
        <p>
          This <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> reference is invalid because there is no corresponding triple expression:
        </p>
        <div class="repchoice error" tabindex="0">
          <pre class="json nohighlight repchosen">{ "type":"Schema", "shapes": [
    { "id": "http://schema.example/#S1",
      "type":"Shape", "expression":
        "http://schema.example/#missingTripleExpr"
} ] }</pre>
          <pre class="shexc nohighlight rephidden">                                                  
    ex:S1 {
      &amp;ex:missingTripleExpr
    }
 </pre>
        <button>json</button></div>
        <p>This triple expression reference is invalid because the referenced object is a <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> instead of a triple expression:</p>
        <div class="repchoice error incomplete" tabindex="0">
          <pre class="json nohighlight repchosen">{ "type":"Schema", "shapes": [
    { "id": "http://schema.example/#CustomerShape",
      "type":"ShapeAnd", "shapeExprs": [ <span class="comment">…</span> ]
    },
    { "id": "http://schema.example/#PreferredCustomerShape",
      "type":"Shape", "expression": { "type":"EachOf", "expressions": [
        "http://schema.example/#CustomerShape",
        { "type": "TripleConstraint",
          "predicate": "http://schema.example/#discount" }
] } } ] }</pre>
          <pre class="shexc nohighlight rephidden">                                                                       
    ex:CustomerShape {
      <span class="comment">…</span>; <span class="comment">…</span>
    }
    ex:PreferredCustomerShape {
      &amp;ex:CustomerShape ;
      ex:discount .
    }

 </pre>
        <button>json</button></div>
      </div>
      </section>

      <section id="negation-requirement">
        <h4 id="x5-7-4-negation-requirement"><bdi class="secno">5.7.4 </bdi>Negation Requirement<a class="self-link" aria-label="§" href="#negation-requirement"></a></h4>
        <p>
          A schema <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain any <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a> that has a <a href="#dfn-negated-reference" class="internalDFN" data-link-type="dfn">negated reference</a> to itself, either directly or transitively.
	  This is formalized by the requirement that the <a href="#dfn-dependency-graph" class="internalDFN" data-link-type="dfn">dependency graph</a> of a schema <em class="rfc2119" title="MUST NOT">MUST NOT</em> have a cycle that traverses some <a href="#dfn-negated-reference" class="internalDFN" data-link-type="dfn">negated reference</a>.
        </p>
        <p class="leadup">
	  The set of <dfn data-dfn-type="dfn" id="dfn-atomic-shapes">atomic shapes</dfn> of a <a href="#dfn-shapeexpr" class="internalDFN" data-link-type="dfn">shapeExpr</a> <span class="math">se</span> contains a <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a> <span class="math">s</span> if <span class="math">s</span> or its <span class="path">id</span> appears either directly or by <a href="#dfn-shapeexprrefs" class="internalDFN" data-link-type="dfn">shapeExprRef</a> in <span class="math">se</span>.
	  That is, <span class="math">s</span> belongs to <code class="function">atomicShapes(<span class="math">se</span>)</code> if and only if 
	</p>
        <ul class="followup leadup">
	  <li>
	    <span class="math">s</span> appears as an atomic shape in <span class="math">se</span>, or
	  </li>
	  <li>
	    <span class="math">sid</span> is the <span class="param">id</span> of <span class="math">s</span> and <span class="math">sid</span> appears as an atomic shapeExprRef in <span class="math">se</span>, or
	  </li>
          <li>
	    <span class="math">s</span> belongs to <code>atomicShapes(se2)</code> for some shape expression <span class="math">se2</span> such that the <span class="param">id</span> of <span class="math">se2</span> belongs to the shapeExprRefClosure of <span class="math">se</span>.
	  </li>

        </ul>
        

        <p class="leadup">The set of <dfn data-dfn-type="dfn" id="dfn-atomic-triple-constraints">atomic triple constraints</dfn> of a <a href="#dfn-tripleexpr" class="internalDFN" data-link-type="dfn">tripleExpr</a> <span class="math">te</span> includes every <a href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">TripleConstraint</a> <span class="math">tc</span> that appears directly or by <a href="#dfn-tripleexprref" class="internalDFN" data-link-type="dfn">tripleExprRef</a> in <span class="math">te</span>.
	  That is, <span class="math">tc</span> belongs to <code class="function">atomicTripleConstraints(<span class="math">te</span>)</code> if and only if:
	</p>
        <ul>
          <li>
	    <span class="math">tc</span> is an atomic <a href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">TripleConstraint</a> in <span class="math">te</span>, or
	  </li>
          <li>
	    <span class="math">te</span> is an atomic <a href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">TripleConstraint</a> in <code class="function">tripleExprWithId(<span class="math">tl</span>)</code> for some <a href="#dfn-tripleexprlabel" class="internalDFN" data-link-type="dfn">tripleExprLabel</a> <span class="math">tl</span> that belongs to <code class="function">tripleExprRefClosure(<span class="math">te</span>)</code>.
	  </li>

        </ul>
        

        <p class="leadup">
	  The <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a> <span class="math">s1</span> has a <dfn data-dfn-type="dfn" id="dfn-reference">reference</dfn> to the <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a> <span class="math">s2</span> if
        </p>
        <ul class="followup">
	  <li>
	    <span class="math">s1</span>.<span class="param">expression</span> is present, and
	  </li>
	  <li>
	    there is a triple constraint <span class="math">tc</span> that belongs to <code class="function">atomicTripleConstraints(<span class="math">s1</span>.<span class="param">expression</span>)</code>, and
	  </li>
          <li>
	    <span class="math">tc</span>.<span class="param">valueExpr</span> is present, and
	  </li>
	  <li>
	    <span class="math">s2</span> belongs to <code>atomicShapes(<span class="math">tc</span>.<span class="param">valueExpr</span>)</code>.
	  </li>
	</ul>

        <p class="leadup">
	  The reference from <span class="math">s1</span> to <span class="math">s2</span> is a <dfn data-dfn-type="dfn" id="dfn-negated-reference">negated reference</dfn> if
	</p>
	<ul>
	  <li>
	    <span class="math">s2</span> appears under an odd number of <a href="#dfn-shapenot" class="internalDFN" data-link-type="dfn">ShapeNot</a> in the shapeExprRef closure of <span class="math">tc</span>.<span class="param">valueExpr</span>, or
          </li>
	  <li>
	    <span class="math">tc</span> has <span class="param">predicate</span> <span class="math">p</span> and <span class="math">s1</span> has <span class="param">extra</span> <span class="math">p</span>.
	  </li>
	</ul>
	    
	<p>
	  The <dfn data-dfn-type="dfn" id="dfn-dependency-graph">dependency graph</dfn> of the schema <span class="math">Sch</span> is the graph which vertices are all the <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a>s that appear in some shape expression in the <span class="param">shapes</span> of <span class="math">Sch</span>, and that has two kinds of edges: negative and positive.
	  There is a negative edge from <span class="math">s1</span> to <span class="math">s2</span> if <span class="math">s1</span> has a <a href="#dfn-negated-reference" class="internalDFN" data-link-type="dfn">negated reference</a> to <span class="math">s2</span>.
	  There is a positive edge from <span class="math">s1</span> to <span class="math">s2</span> if <span class="math">s1</span> has a reference but not a negated reference to <span class="math">s2</span>.
	</p>
        <div class="example">
            <h4 class="followup" id="examples-with-shapenot">Examples with <span class="jobjref"><a href="#dfn-shapenot" class="internalDFN" data-link-type="dfn">ShapeNot</a></span><a class="self-link" aria-label="§" href="#examples-with-shapenot"></a></h4>
            <p>
              This negated self-reference violates the negation requirement.
            </p>
            <div class="repchoice error" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
    { "id": "http://schema.example/#S",
      "type": "Shape",
      "expression": { "type": "TripleConstraint",
        "predicate": "http://schema.example/#p",
        "valueExpr": { "type": <span class="lookit">"ShapeNot"</span>,
          "shapeExpr": "http://schema.example/#S" } } }
  ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                       
ex:S {ex:p <span class="lookit">NOT</span> @ex:S}





 </pre>
              <button>json</button></div>
              <p>
                This indirect self-reference does not violate the negation requirement.
              </p>
              <div class="repchoice" tabindex="0">
                <pre class="json nohighlight repchosen">{ "type": "Schema",
  "shapes": [
    { "id": "http://schema.example/#US",
      "type": "Shape",
      "expression": { "type": "TripleConstraint",
        "predicate": "http://schema.example/#Up",
        "valueExpr": { "type": "ShapeNot",
          "shapeExpr": "http://schema.example/#UT" } } },
    { "id": "http://schema.example/#UT",
      "type": "Shape",
      "expression": { "type": "TripleConstraint",
        "predicate": "http://schema.example/#Uq",
        "valueExpr": "http://schema.example/#US" } }
  ] }</pre>
                <pre class="shexc nohighlight rephidden">                                                         
ex:US {ex:Up NOT @ex:UT} 






ex:UT { ex:Uq @ex:US} 




 </pre>
              <button>json</button></div>
              <p>
                This negated, indirect self-reference violates the negation requirement.
              </p>
              <div class="repchoice error" tabindex="0">
                <pre class="json nohighlight repchosen">{"type" : "Schema",
  "shapes" : [ {
    "id" : "http://schema.example/#S",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#p",
      "valueExpr" : {
        "type" : "ShapeNot",
        "shapeExpr" : "http://schema.example/#T"
      }
    }
  } , {
    "id" : "http://schema.example/#T",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#q",
      "valueExpr" : "http://schema.example/#S"
    }
  } ] }</pre>
                <pre class="shexc nohighlight rephidden">                                                

    ex:S {



      ex:p 

        NOT
          @ex:T
    } 


    ex:T {



      ex:q
        @ex:S
    } 
 </pre>
              <button>json</button></div>
              <p>
                This is a direct, negated self-reference of the shape with id ex:T and violates the negation requirement.

              </p>
              <div class="repchoice error" tabindex="0">
                <pre class="json nohighlight repchosen">{"type" : "Schema",
  "shapes" : [ {
    "id" : "http://schema.example/#T",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#p",
      "valueExpr" : "http://schema.example/#S"
    }
  } , {
    "id" : "http://schema.example/#S",
    "type" : "ShapeAnd",
    "shapeExprs" : [ {
      "type" : "ShapeNot",
      "shapeExpr" : "http://schema.example/#T"
    }, "http://schema.example/#U" ]
  }, {
    "id" : "http://schema.example/#U",
    "type" : "Shape"
  } ] }</pre>
                <pre class="shexc nohighlight rephidden">                                               

    ex:T {



      ex:p
        @ex:S
    }

    ex:S


     (NOT
        @ex:T)
     AND @ex:U

     ex:U .

 </pre>
              <button>json</button></div>
              <p>
                This doubly-negated self-reference of ex:T does not violate the negation requirement.
              </p>
              <div class="repchoice" tabindex="0">
                <pre class="json nohighlight repchosen">{"type" : "Schema",
  "shapes" : [{
    "id" : "http://schema.example/#T",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#p",
      "valueExpr" : "http://schema.example/#S"
    }
  } , {
    "id" : "http://schema.example/#S",
    "type" : "ShapeNot",
    "shapeExpr" : {
      "type" : "ShapeAnd",
      "shapeExprs" : [ {
        "type" : "ShapeNot",
        "shapeExpr" : "http://schema.example/#T"
      }, "http://schema.example/#U" ]
    }
  }, {
    "id" : "http://schema.example/#U",
    "type" : "Shape"
  } ] }</pre>
                <pre class="shexc nohighlight rephidden">                                                

    ex:T {



      ex:p
        @ex:S
    }

    ex:S
      NOT


                     (
                       (NOT
                          @ex:T)
                       AND @ex:U )


    ex:U .

 </pre>
              <button>json</button></div>
              <p>
		There is a cycle of negated references between the shape that defines ex:T and the shape that defines ex:U, so the negation requirement is violated.
              </p>
              <div class="repchoice error" tabindex="0">
                <pre class="json nohighlight repchosen">{"type" : "Schema",
  "shapes" : [{
    "id" : "http://schema.example/#T",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#p",
      "valueExpr" : {
        "type" : "ShapeNot",
        "shapeExpr" : "http://schema.example/#S"
      }
    }
  } , {
    "id" : "http://schema.example/#U",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#q",
      "valueExpr" : "http://schema.example/#S"
    }
  }, {
    "id" : "http://schema.example/#S",
    "type" : "ShapeAnd",
    "shapeExprs" : [ {
      "type" : "ShapeNot",
      "shapeExpr" : "http://schema.example/#T"
    }, "http://schema.example/#U" ]
  } ] }</pre>
                <pre class="shexc nohighlight rephidden">                                                

    ex:T {



      ex:p

        NOT
          @ex:S
    }


    ex:U {



      ex:q
        @ex:S
    }

    ex:S


      (NOT
         @ex:T)
      AND @ex:U
 </pre>

	      <button>json</button></div>
	  <p>
		  This satisfies the negation requirement, as ex:U does not refer to ex:T (compared to the previous example).
          </p>
          <div class="repchoice" tabindex="0">
            <pre class="json nohighlight repchosen">{"type" : "Schema",
  "shapes" : [{
    "id" : "http://schema.example/#T",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#p",
      "valueExpr" : {
        "type" : "ShapeNot",
        "shapeExpr" : "http://schema.example/#S"
      }
    }
  } , {
    "id" : "http://schema.example/#U",
    "type" : "Shape",
    "expression" : {
      "type" : "TripleConstraint",
      "predicate" : "http://schema.example/#q"
    }
  }, {
    "id" : "http://schema.example/#S",
    "type" : "ShapeAnd",
    "shapeExprs" : [ {
      "type" : "ShapeNot",
      "shapeExpr" : "http://schema.example/#T"
    }, "http://schema.example/#U" ]
  } ] }</pre>
            <pre class="shexc nohighlight rephidden">                                                

    ex:T {



      ex:p
        NOT

          @ex:S
    }


    ex:U {



      ex:q .
    }

    ex:S


      (NOT
         @ex:T)
    AND @ex:U
 </pre>
              <button>json</button></div>
          </div>
          <div class="example">
            <h4 class="followup" id="examples-with-shape-extra-predicate">Examples with <span class="jobjref"><a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a></span><span class="param">.extra</span> predicate<a class="self-link" aria-label="§" href="#examples-with-shape-extra-predicate"></a></h4>
            <p>
              This self-reference on a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> designated as <span class="param">extra</span> violates the negation requirement:
            </p>
            <div class="repchoice error" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
    { "id": "http://schema.example/#S",
      "type": "Shape",
      "extra": [ <span class="lookit">"http://schema.example/#p"</span> ], "expression":
      { "type": "TripleConstraint",
        "predicate": <span class="lookit">"http://schema.example/#p"</span>,
        "valueExpr": "http://schema.example/#S"
} } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                            
  ex:S EXTRA ex:p {
    ex:p @ex:S
  }



 </pre>
            <button>json</button></div>
            <p>
              The same shape with a negated self-reference still violates the negation requirement because the reference occurs with a <span class="jobjref"><a href="#dfn-shapenot" class="internalDFN" data-link-type="dfn">ShapeNot</a></span>:
            </p>
            <div class="repchoice error" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
    { "id": "http://schema.example/#S",
      "type": "Shape",
      "extra": [ "http://schema.example/#p" ],
      "expression": {
        "type": "TripleConstraint",
        "predicate": "http://schema.example/#p",
        "valueExpr": {
          "type": <span class="lookit">"ShapeNot"</span>, "shapeExpr": "http://schema.example/#S"
} } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                     
    ex:S EXTRA ex:p {
      ex:p NOT @ex:S
    }





 </pre>
            <button>json</button></div>
          </div>
    </section>

    </section>

      <section id="semantic-actions">
        <h3 id="x5-8-semantic-actions"><bdi class="secno">5.8 </bdi>Semantic Actions<a class="self-link" aria-label="§" href="#semantic-actions"></a></h3>
        <p>
          Semantic actions serve as an extension point for Shape Expressions.
          They appear in lists in <span class="jobjref"><a href="#dfn-shapes-schema" class="internalDFN" data-link-type="dfn">Schema</a></span>'s <span class="param">startActs</span> and <span class="jobjref"><a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a></span>, <span class="jobjref"><a href="#dfn-oneof" class="internalDFN" data-link-type="dfn">OneOf</a></span>, <span class="jobjref"><a href="#dfn-eachof" class="internalDFN" data-link-type="dfn">EachOf</a></span> and <span class="jobjref"><a href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">TripleConstraint</a></span>'s <span class="param">semActs</span>.
        </p>
        <p>
          A semantic action is a tuple of an identifier and some optional code:
        </p>
        <div class="shexjTable">
          <table class="shexj">
  <tbody><tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-semact">SemAct</dfn></th><td>{</td><td><span class="param">name</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> <span class="param">code</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? }</td></tr>
          </tbody></table>
        </div>
        <section id="semantic-actions-semantics">
          <h4 id="x5-8-1-semantics"><bdi class="secno">5.8.1 </bdi>Semantics<a class="self-link" aria-label="§" href="#semantic-actions-semantics"></a></h4>
          <p>
            The evaluation <span id="semActsSatisfied" class="label">semActsSatisfied</span> on a list of <span class="jobjref"><a href="#dfn-semact" class="internalDFN" data-link-type="dfn">SemAct</a></span>s returns success or failure.
            The evaluation of an individual <span class="jobjref"><a href="#dfn-semact" class="internalDFN" data-link-type="dfn">SemAct</a></span> is implementation-dependent.
          </p>
        </section>
        <section id="semantic-actions-uses">
          <h4 id="x5-8-2-use-informative"><bdi class="secno">5.8.2 </bdi>Use - informative<a class="self-link" aria-label="§" href="#semantic-actions-uses"></a></h4>
          <p>
            A practical evaluation of a <span class="jobjref"><a href="#dfn-semact" class="internalDFN" data-link-type="dfn">SemAct</a></span> will provide access to some context.
            For instance, the <a href="http://shex.io/extensions/Test/#def">http://shex.io/extensions/Test/</a> extension requires access to the subject, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> and object of a triple matching a <span class="jobjref"><a href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">TripleConstraint</a></span>.
            These are used in a <code>print</code> function.
          </p>
          <div class="example">
            <div class="example-title marker"><span>Semantic Actions example 1</span></div>
            <div class="repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
    { "id": "http://schema.example/#S1",
      "type": "Shape", "expression": {
        "type": "TripleConstraint", "predicate": "http://schema.example/#p1",
        "min": 1, "max": -1,
        "semActs": [
          { "type": "SemAct", "code": " print(s) ",
            "name": "http://shex.io/extensions/Test/" },
          { "type": "SemAct", "code": " print(o) ",
            "name": "http://shex.io/extensions/Test/" } ] } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                             
    ex:S1 {
      ex:p1 .+ %Test:{ print(s) %} %Test:{ print(o) %}
    }





 </pre>
            <button>json</button></div>
            <pre class="data" aria-busy="false"><code class="hljs">&lt;http://a.example/n1&gt; &lt;http://a.example/p1&gt; &lt;http://a.example/o1&gt; .
&lt;http://a.example/n2&gt; &lt;http://a.example/p1&gt; "a", "b" .
&lt;http://a.example/n3&gt; &lt;http://a.example/p2&gt; &lt;http://a.example/o2&gt; .</code></pre>
            <table>
              <tbody><tr><th class="data">node</th><th class="schema">shape</th><th>result</th><th>print arguments</th></tr>
              <tr class="pass"><td>&lt;n1&gt;</td><td>&lt;S1&gt;</td><td>pass</td><td>http://a.example/s1<br />http://a.example/o1</td></tr>
              <tr class="pass"><td>&lt;n2&gt;</td><td>&lt;S1&gt;</td><td>pass</td><td>http://a.example/s1<br />"a"<br />http://a.example/s1<br />"b"</td></tr>
              <tr class="fail"><td>&lt;n3&gt;</td><td>&lt;S1&gt;</td><td>fail</td><td class="noreason"></td></tr>
            </tbody></table>
          </div>
        </section>
      </section>

      <section id="annotations">
        <h3 id="x5-9-annotations"><bdi class="secno">5.9 </bdi>Annotations<a class="self-link" aria-label="§" href="#annotations"></a></h3>
        <p>
          Annotations provide a format-independent way to provide additional information about elements in a schema.
          They appear in lists in <span class="jobjref"><a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a></span>, <span class="jobjref"><a href="#dfn-oneof" class="internalDFN" data-link-type="dfn">OneOf</a></span>, <span class="jobjref"><a href="#dfn-eachof" class="internalDFN" data-link-type="dfn">EachOf</a></span> and <span class="jobjref"><a href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">TripleConstraint</a></span>'s <span class="param">annotations</span>.
        </p>
        <div class="shexjTable">
          <table class="shexj">
  <tbody><tr class="obj"><th class="obj"><dfn data-dfn-type="dfn" id="dfn-annotation">Annotation</dfn></th><td>{</td><td><span class="param"><a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a></span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> <span class="param">object</span>:<a class="nobref internalDFN" href="#dfn-objectvalue" data-link-type="dfn">objectValue</a> }</td></tr>
          </tbody></table>
        </div>
        <section id="annotations-semantics">
          <h4 id="x5-9-1-semantics-informative"><bdi class="secno">5.9.1 </bdi>Semantics - informative<a class="self-link" aria-label="§" href="#annotations-semantics"></a></h4>
          <p>
            Annotations do not affect whether a node conforms to some shape.
            Because they are part of the structure of the schema, they can be parsed in one ShEx format and emitted in that format or another.
          </p>
          <div class="example">
            <div class="example-title marker"><span>Annotations example 1</span></div>
            <div class="repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
    { "id": "http://schema.example/#IssueShape",
      "type": "Shape", "expression": {
        "type": "TripleConstraint",
        "predicate": "http://schema.example/#status",
        "annotations": [
           { "type": "Annotation",
             "predicate": "http://www.w3.org/2000/01/rdf-schema#comment",
             "object": {"value": "Represents reported software issues."} },
           { "type": "Annotation",
             "predicate": "http://www.w3.org/2000/01/rdf-schema#label",
             "object": {"value": "software issue"} } ] } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                           
    ex:IssueShape {
      ex:status .
          // rdfs:comment "Represents reported software issues."
          // rdfs:label "software issue"
    }





 </pre>
            <button>json</button></div>
          </div>
        </section>
    </section>

      <section id="validation-examples">
        <h3 id="x5-10-validation-examples"><bdi class="secno">5.10 </bdi>Validation Examples<a class="self-link" aria-label="§" href="#validation-examples"></a></h3>
        <p>
          The following examples demonstrate proofs for validations in the form of a nested list of invocations of the evaluation functions defined above.
        </p>
        <section id="example-simple">
          <h4 id="x5-10-1-simple-examples"><bdi class="secno">5.10.1 </bdi>Simple Examples<a class="self-link" aria-label="§" href="#example-simple"></a></h4>
          
          <div class="example">
              <span class="exsec">Schema:</span><br />
              <pre class="line-labels" aria-busy="false"><code class="hljs">S1

nc1</code></pre>
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
    { "id": "http://schema.example/#IntConstraint",
      "type": "NodeConstraint",
      "datatype": "http://www.w3.org/2001/XMLSchema#integer"
    } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                            
ex:IntConstraint

      xsd:integer
 </pre>
            <button>json</button></div>
            <div style="clear:both;"></div>

            <p>
              Here the shape identified by <code>http://schema.example/#IntConstraint</code> is a <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expression</a> consisting of a single <span class="jobjref"><a class="obj internalDFN" href="#dfn-nodeconstraint" data-link-type="dfn">NodeConstraint</a></span>.
              Per <a href="#shape-expression-semantics">Shape Expression Semantics</a>, "30"^^&lt;http://www.w3.org/2001/XMLSchema#integer&gt; satisfies <span class="lineno schema">IntConstraint</span>.
            </p>
            <p>
              This document uses this nested tree convention to indicate that the dependency of an evaluation on those nested inside it.
              Nesting is expressed as indentation.
              Here, the evaluation of <span class="math function">satisfies NodeConstraint ("30"^^xsd:integer, S1, G, m)</span> depends on <span class="math function">satisfies2 NodeConstraint ("30"^^xsd:integer, S1)</span>.
            </p>
            <div class="validation"><span>Validate</span> <span>"30"^^&lt;http://www.w3.org/2001/XMLSchema#integer&gt;</span> as <span class="hljs-string">IntConstraint</span>:</div>
            <ul class="trace followup">
              <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("30"^^xsd:integer, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("30"^^xsd:integer, <span class="lineno schema">S1</span>)</li>
              </ul></li>
            </ul>
          </div>

          <p class="leadup">
            Validating a shape requires evaluating it's <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> as well as the variables and functions <span class="math"><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, n)</span>, <span class="math">matched</span>, <span class="math">remainder</span>, <span class="math">outs</span>, <span class="math">matchables</span> and <span class="math">unmatchables</span>:<br />
          </p>
          <div class="example">
            
            <span class="exsec">Schema:</span><br />
            <pre class="line-labels" aria-busy="false"><code class="hljs">S1
tc1</code></pre>
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#UserShape",
    "type": "Shape", "expression":
    { "type": "TripleConstraint",
      "predicate": "http://schema.example/#shoeSize"
      } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                    

  ex:UserShape {
    ex:shoeSize .
  }
 </pre>
            <button>json</button></div>
            <div style="clear:both;" class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t1</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs xml">BASE <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">a.example</span>/&gt;</span>
PREFIX xsd: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">www.w3.org</span>/<span class="hljs-attr">2001</span>/<span class="hljs-attr">XMLSchema</span>#&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> ex:shoeSize "30"^^xsd:integer .</code></pre>
            </div>
            <div style="clear:both;" class="validation"><span>Validate</span> <span class="hljs-name">&lt;Alice&gt;</span> as <span class="hljs-string">http://schema.example/#UserShape</span>:</div>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1</span>] <span class="comment">The <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> G consists of one <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-triple">triple</a>.</span></li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (&lt;Alice&gt;, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;Alice&gt;) = [<span class="lineno data">t1</span>] <span class="comment">/* The neighborhood around &lt;Alice&gt; consists of one triple. */</span></li>
                <li>matched = [<span class="lineno data">t1</span>] <span class="comment">/* That triple is matched in the nested evaluation. */</span></li>
                <li>remainder = Ø <span class="comment">/* The remainder is the empty set. */</span></li>
                <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)</li>
                <li>outs = [<span class="lineno data">t1</span>] <span class="comment">/* There is one arc out. */</span></li>
                <li>matchables = Ø <span class="comment">/* There are no remaining arcs out of &lt;Alice&gt; with <a data-lt="predicate" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicates</a> appearing in tc1. */</span></li>
                <li>unmatchables = Ø <span class="comment">/* There are no other arcs out of &lt;Alice&gt;. */</span></li>
                <li><span class="parameter">closed</span> is false <span class="comment">/* The <span class="jobjref"><a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a></span>'s closed paramater has a value of false. */</span></li>
              </ul>
              </li>
            </ul>
          </div>
            <p class="leadup">
              It is quite common that Shapes will constrain their nested TripleConstraints with NodeConstraints.
              Here is an example including that, extra triples and a closed shape:
            </p>
          <div class="example">
            
            <span class="exsec">Schema:</span><br />
            <pre class="line-labels" aria-busy="false"><code class="hljs">S1
tc1



nc1</code></pre>
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#UserShape",
    "type": "Shape",
    "extra": ["http://www.w3.org/1999/02/22-rdf-syntax-ns#type"],
    "expression": {
      "type": "TripleConstraint",
      "predicate": "http://www.w3.org/1999/02/22-rdf-syntax-ns#type",
      "valueExpr":
      { "type": "NodeConstraint",
        "values": ["http://schema.example/#Teacher"]
      } } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                     

  ex:UserShape EXTRA a {
    a




      [ex:Teacher]
  }
 </pre>
            <button>json</button></div>
            <div style="clear:both;" class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t1
t2
t3
t4
t5</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs xml">BASE <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">a.example</span>/&gt;</span>
PREFIX xsd: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">www.w3.org</span>/<span class="hljs-attr">2001</span>/<span class="hljs-attr">XMLSchema</span>#&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> ex:shoeSize "30"^^xsd:integer .
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> a ex:Teacher .
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> a ex:Person .
<span class="hljs-tag">&lt;<span class="hljs-name">SomeHat</span>&gt;</span> ex:owner <span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> .
<span class="hljs-tag">&lt;<span class="hljs-name">TheMoon</span>&gt;</span> ex:madeOf <span class="hljs-tag">&lt;<span class="hljs-name">GreenCheese</span>&gt;</span> .</code></pre>
            </div>
            <div style="clear:both;" class="validation"><span>Validate</span> <span class="hljs-name">&lt;Alice&gt;</span> as <span class="hljs-string">http://schema.example/#UserShape</span>:</div>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1,t2,t3,t4,t5</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (&lt;Alice&gt;, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;Alice&gt;) = [<span class="lineno data">t1,t2,t3,t4</span>], matched = [<span class="lineno data">t2</span>], remainder = [<span class="lineno data">t1,t3</span>]</li>
                <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t2</span>], <span class="lineno schema">tc1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (ex:Teacher, <span class="lineno schema">nc1</span>, G, m)
                  <ul>
                    <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (ex:Teacher, <span class="lineno schema">nc1</span>)</li>
                </ul></li></ul></li>
                <li>outs = [<span class="lineno data">t1,t2,t3</span>]</li>
                <li>matchables = [<span class="lineno data">t3</span>], unmatchables = [<span class="lineno data">t1</span>], <span class="parameter">closed</span> is false</li>
              </ul>
              </li>
            </ul>
            <p>
              The non-empty matchables is permitted because the triple <code>t3</code> has a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> which appears in the "extra" list: <span class="json">["http://schema.example/#Teacher"]</span>.
            </p>
          </div>
        </section>

        <section id="example-disjunction">
          <h4 id="x5-10-2-disjunction-example"><bdi class="secno">5.10.2 </bdi>Disjunction Example<a class="self-link" aria-label="§" href="#example-disjunction"></a></h4>
          
          <div class="example">
              <div class="exsec">Schema:</div><br />
              <pre class="line-labels" aria-busy="false"><code class="hljs">S1
te1
tc1


nc1
te2
tc2


nc2
tc3


nc3</code></pre>
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#UserShape",
    "type": "Shape", "expression":
     {"type": "OneOf", "expressions": [
        { "type": "TripleConstraint",
          "predicate": "http://xmlns.com/foaf/0.1/name",
          "valueExpr":
            { "type": "NodeConstraint", "nodeKind": "literal" } },
        { "type": "EachOf", "expressions": [
            { "type": "TripleConstraint", "min": 1, "max": -1 ,
              "predicate": "http://xmlns.com/foaf/0.1/givenName",
              "valueExpr":
                { "type": "NodeConstraint", "nodeKind": "literal" } },
            { "type": "TripleConstraint",
              "predicate": "http://xmlns.com/foaf/0.1/familyName",
              "valueExpr":
                { "type": "NodeConstraint", "nodeKind": "literal" } }
        ] }
     ] }
 } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                      
ex:UserShape
  {
   (              <span class="comment"># extra ()s to clarify alignment with <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a></span>
    foaf:name


            LITERAL |
    (             <span class="comment"># extra ()s to clarify alignment with <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a></span>
     foaf:givenName


             LITERAL+ ;
     foaf:familyName


             LITERAL
    )
   )
  }</pre>
            <button>json</button></div>
            <div style="clear:both;" class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t1
t2
t3
t4
t5
t6</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs xml">BASE <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">a.example</span>/&gt;</span>
PREFIX foaf: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">xmlns.com</span>/<span class="hljs-attr">foaf</span>/<span class="hljs-attr">0.1</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> foaf:givenName "Alice" .
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> foaf:givenName "Malsenior" .
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> foaf:familyName "Walker" .
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> foaf:mbox <span class="hljs-tag">&lt;<span class="hljs-name">mailto:alice@example.com</span>&gt;</span> .
<span class="hljs-tag">&lt;<span class="hljs-name">Bob</span>&gt;</span> foaf:knows <span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> .
<span class="hljs-tag">&lt;<span class="hljs-name">Bob</span>&gt;</span> foaf:mbox <span class="hljs-tag">&lt;<span class="hljs-name">mailto:bob@example.com</span>&gt;</span> .</code></pre>
            </div>
            <div style="clear:both;"></div>
            <p class="leadup">Per <a href="#shape-expression-semantics">Shape Expression Semantics</a>, &lt;Alice&gt; satisfies <span class="lineno">S1</span> with the simple <a data-link-type="dfn" href="http://shex.io/shape-map/#dfn-fixed-shapemap">ShapeMap</a></p>
            <pre class="line-labels" aria-busy="false"><code class="hljs">m:</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs javascript">{ <span class="hljs-string">"http://a.example/Alice"</span>: <span class="hljs-string">"http://a.example/UserShape }</span></code></pre>
            </div>
            <div style="clear:both;"></div>
            <p class="leadup followup">as seen in this validation.</p>
            <div class="validation"><span>Validate</span> <span class="hljs-name">&lt;Alice&gt;</span> as <span class="hljs-string">http://schema.example/#UserShape</span>:</div>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1,t2,t3,t4,t5,t6</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (&lt;Alice&gt;, <span class="lineno">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;Alice&gt;) = [<span class="lineno data">t1,t2,t3,t4,t5</span>], matched = [<span class="lineno data">t1,t2,t3</span>], remainder = [<span class="lineno data">t4,t5</span>]</li>
                <li><a href="#matches-OneOf">matches OneOf</a> ([<span class="lineno data">t1,t2,t3</span>], <span class="lineno schema">te1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#matches-EachOf">matches EachOf</a> ([<span class="lineno data">t1,t2,t3</span>], <span class="lineno schema">te2</span>, m)
                  <ul style="border-left:solid thin brown">
                    <li><a href="#matches-cardinality">matches cardinality</a> ([<span class="lineno data">t1,t2</span>], <span class="lineno schema">tc2</span>, m)
                    <ul style="border-left:solid thin brown">
                      <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc2</span>, m)
                      <ul>
                        <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("Alice", <span class="lineno schema">nc2</span>, G, m)
                        <ul>
                          <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("Alice", <span class="lineno schema">nc2</span>)</li>
                      </ul></li></ul></li>
                      <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t2</span>], <span class="lineno schema">tc2</span>, m)
                      <ul>
                        <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("Malsenior", <span class="lineno schema">nc2</span>, G, m)
                        <ul>
                          <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("Malsenior", <span class="lineno schema">nc2</span>)</li>
                      </ul></li></ul></li>
                    </ul></li>
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t3</span>], <span class="lineno schema">tc3</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("Walker", <span class="lineno schema">nc3</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("Walker", <span class="lineno schema">nc3</span>)</li>
                </ul></li></ul></li></ul></li></ul></li>
                <li>outs = [<span class="lineno data">t4</span>] <span class="comment">/* <span class="lineno data">t5</span> is in <span class="math"><a href="#dfn-arcsin" class="internalDFN" data-link-type="dfn">ArcsIn</a>(G, &lt;Alice&gt;)&gt;</span>, <span class="lineno data">t6</span> is not in <span class="math"><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;Alice&gt;)&gt;</span>. */</span></li>
                <li>matchables = Ø, unmatchables = [<span class="lineno data">t5</span>], <span class="parameter">closed</span> is false</li>
              </ul>
              </li>
            </ul>

            <p class="leadup">
              Replacing triples 1-3 with a single foaf:name property will also satisfy the schema.
            </p>
            <div class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t4
t5
t6
t7</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs xml">BASE <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">a.example</span>/&gt;</span>
PREFIX foaf: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">xmlns.com</span>/<span class="hljs-attr">foaf</span>/<span class="hljs-attr">0.1</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> foaf:mbox <span class="hljs-tag">&lt;<span class="hljs-name">mailto:alice@example.com</span>&gt;</span> .
<span class="hljs-tag">&lt;<span class="hljs-name">Bob</span>&gt;</span> foaf:knows <span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> .
<span class="hljs-tag">&lt;<span class="hljs-name">Bob</span>&gt;</span> foaf:mbox <span class="hljs-tag">&lt;<span class="hljs-name">mailto:bob@example.com</span>&gt;</span> .
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> foaf:name "Alice Malsenior Walker" .</code></pre>
            </div>
            <div style="clear:both;" class="validation"><span>Validate</span> <span class="hljs-name">&lt;Alice&gt;</span> as <span class="hljs-string">http://schema.example/#UserShape</span>:</div>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t4,t5,t6,t7</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (&lt;Alice&gt;, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;Alice&gt;) = [<span class="lineno data">t4,t5,t7</span>], matched = [<span class="lineno data">t7</span>], remainder = [<span class="lineno data">t4,t5</span>]</li>
                <li><a href="#matches-OneOf">matches OneOf</a> ([<span class="lineno data">t7</span>], <span class="lineno schema">te1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t7</span>], <span class="lineno schema">tc1</span>, m)
                  <ul>
                    <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("Walker", <span class="lineno schema">nc3</span>, G, m)
                    <ul>
                      <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("Walker", <span class="lineno schema">nc3</span>)</li>
                </ul></li></ul></li></ul></li>
                <li>outs = [<span class="lineno data">t4</span>]</li>
                <li>matchables = Ø, unmatchables = [<span class="lineno data">t5</span>], <span class="parameter">closed</span> is false</li>
              </ul>
              </li>
            </ul>

            <p class="leadup">
              Any mixure of <code>foaf:name</code> with <code>foaf:givenName</code> or <code>foaf:familyName</code> will fail to satisfy the schema as there will be a matchable triple <span class="lineno data">t3</span> that's not used in the <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> <span class="lineno schema">te1</span>.
            </p>
            <div class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t3
t4
t5
t6
t7</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs xml">BASE <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">a.example</span>/&gt;</span>
PREFIX foaf: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">xmlns.com</span>/<span class="hljs-attr">foaf</span>/<span class="hljs-attr">0.1</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> foaf:familyName "Walker" .
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> foaf:mbox <span class="hljs-tag">&lt;<span class="hljs-name">mailto:alice@example.com</span>&gt;</span> .
<span class="hljs-tag">&lt;<span class="hljs-name">Bob</span>&gt;</span> foaf:knows <span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> .
<span class="hljs-tag">&lt;<span class="hljs-name">Bob</span>&gt;</span> foaf:mbox <span class="hljs-tag">&lt;<span class="hljs-name">mailto:bob@example.com</span>&gt;</span> .
<span class="hljs-tag">&lt;<span class="hljs-name">Alice</span>&gt;</span> foaf:name "Alice Malsenior Walker" .</code></pre>
            </div>
            <div style="clear:both;" class="validation"><span>Validate</span> <span class="hljs-name">&lt;Alice&gt;</span> as <span class="hljs-string">http://schema.example/#UserShape</span>:</div>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t4,t5,t6,t7</span>]</li>
              <li><span class="fail"><a href="#satisfies-Shape">satisfies Shape</a> (&lt;Alice&gt;, <span class="lineno schema">S1</span>, G, m)</span>
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;Alice&gt;) = [<span class="lineno data">t4,t5,t7</span>], matched = [<span class="lineno data">t7</span>], remainder = [<span class="lineno data">t4,t5</span>]</li>
                <li><a href="#matches-OneOf">matches OneOf</a> ([<span class="lineno data">t7</span>], <span class="lineno schema">te1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t7</span>], <span class="lineno schema">tc1</span>, m)
                  <ul>
                    <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("Walker", <span class="lineno schema">nc3</span>, G, m)
                    <ul>
                      <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("Walker", <span class="lineno schema">nc3</span>)</li>
                </ul></li></ul></li></ul></li>
                <li>outs = [<span class="lineno data">t4</span>]</li>
                <li><span class="fail">matchables = [<span class="lineno data">t3</span>]</span>, unmatchables = [<span class="lineno data">t5</span>], <span class="parameter">closed</span> is false</li>
              </ul>
              </li>
            </ul>

            <p class="leadup">
              Adding a <code>foaf:familyName</code> to <span class="math"><span class="lineno schema">S1</span></span>'s <span class="param">extra</span> would allow this <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">graph</a> to satisfy the schema.
            </p>
              <pre class="line-labels" aria-busy="false"><code class="hljs">S1</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs json">{ <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Schema"</span>, <span class="hljs-attr">"shapes"</span>: [
  { <span class="hljs-attr">"id"</span>: <span class="hljs-string">"http://schema.example/#UserShape"</span>,
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Shape"</span>, <span class="hljs-attr">"extra"</span>: [<span class="hljs-string">"http://xmlns.com/foaf/0.1/familyName"</span>] …
   } ] }</code></pre>
            </div>
            <div style="clear:both;"></div>

            <p class="leadup">
              Closing <span class="math"><span class="lineno schema">S1</span></span> would also cause a validation failure if <span class="math">unmatchables</span> were not empty:
            </p>
              <pre class="line-labels" aria-busy="false"><code class="hljs">S1</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs json">{ <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Schema"</span>, <span class="hljs-attr">"shapes"</span>: [
  { <span class="hljs-attr">"id"</span>: <span class="hljs-string">"http://schema.example/#UserShape"</span>,
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Shape"</span>, <span class="hljs-attr">"closed"</span>: <span class="hljs-literal">true</span> …
   } ] }</code></pre>
            </div>
            <div style="clear:both;"></div>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t4,t5,t6,t7</span>]</li>
              <li><span class="fail"><a href="#satisfies-Shape">satisfies Shape</a> (&lt;Alice&gt;, <span class="lineno schema">S1</span>, G, m)</span>
              <ul>
                <li>…</li>
                <li><span class="fail">unmatchables = [<span class="lineno data">t5</span>], <span class="parameter">closed</span> is true</span></li>
              </ul>
              </li>
            </ul>

          </div>
        </section>

        <section id="example-dependent-shape">
          <h4 id="x5-10-3-dependent-shape-example"><bdi class="secno">5.10.3 </bdi>Dependent Shape Example<a class="self-link" aria-label="§" href="#example-dependent-shape"></a></h4>
          
          <div class="example">
              <div class="exsec">Schema:</div>
              <pre class="line-labels" aria-busy="false"><code class="hljs">S1
tc1


nc1

S2
tc2



nc2</code></pre>
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape",
    "type": "Shape", "expression":
    { "type": "TripleConstraint",
      "predicate": "http://schema.example/#reproducedBy",
      "valueExpr":
      "http://schema.example/#TesterShape" } },
  { "id": "http://schema.example/#TesterShape",
    "type": "Shape", "expression":
    { "type": "TripleConstraint",
      "predicate": "http://schema.example/#role",
      "valueExpr":
      { "type": "NodeConstraint",
        "values": [ "http://schema.example/#testingRole" ] } } }
  ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                
ex:IssueShape
  {

    ex:reproducedBy

     @ex:TesterShape }
ex:TesterShape
 {

    ex:role

     [ex:testingRole] }

 </pre>
            <button>json</button></div>
            <div style="clear:both;" class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t1
t2</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs javascript">PREFIX ex: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">schema.example</span>/#&gt;</span>
PREFIX inst: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">inst.example</span>/&gt;</span>
inst:Issue1 ex:reproducedBy inst:Tester2 .
inst:Tester2 ex:role ex:testingRole .</span></code></pre>
            </div>
            <div style="clear:both;"></div>
            <p class="leadup">inst:Issue1 satisfies <span class="lineno schema">S1</span> with the <a data-link-type="dfn" href="http://shex.io/shape-map/#dfn-fixed-shapemap">ShapeMap</a></p>
            <pre class="line-labels" aria-busy="false"><code class="hljs">m:</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs json">{ <span class="hljs-attr">"http://inst.example/Issue1"</span>: <span class="hljs-string">"http://schema.example/#IssueShape"</span>,
  <span class="hljs-attr">"http://inst.example/Tester2"</span>: <span class="hljs-string">"http://schema.example/#TesterShape"</span>,
  <span class="hljs-attr">"http://inst.example/Testgrammer23"</span>: <span class="hljs-string">"http://schema.example/#ProgrammerShape"</span> }</code></pre>
            </div>
            <div style="clear:both;" class="validation"><span>Validate</span> <span>inst:Issue1</span> as <span class="hljs-string">http://schema.example/#IssueShape</span>:</div>
            <p class="leadup followup">as seen in this evaluation:</p>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (inst:Issue1, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, inst:Issue1) = [<span class="lineno data">t1,t2</span>], matched = [<span class="lineno data">t1,t2</span>], remainder = Ø</li>
                  <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)
                  <ul style="border-left:solid thin brown">
                    <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (inst:Tester2, <span class="lineno schema">nc1</span>, G, m)
                    <ul>
                      <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (inst:Tester2, <span class="lineno schema">nc1</span>)
                      <ul>
                        <li><a href="#satisfies-Shape">satisfies Shape</a> (inst:Tester2. <span class="lineno schema">S2</span>, G, m)
                        <ul>
                          <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, inst:Tester2) = [<span class="lineno data">t2</span>], matched = [<span class="lineno data">t2</span>], remainder = Ø</li>
                          <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t2</span>], <span class="lineno schema">tc2</span>, m)
                          <ul style="border-left:solid thin brown">
                            <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (ex:testingRole, <span class="lineno schema">nc2</span>, G, m)
                            <ul>
                              <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (ex:testingRole, <span class="lineno schema">nc2</span>)</li>
                        </ul></li></ul></li>
                          <li>outs = Ø</li>
                          <li>matchables = Ø, unmatchables = Ø, closed is false</li>
                  </ul></li></ul></li></ul></li></ul></li>
                <li>outs = Ø</li>
                <li>matchables = Ø, unmatchables = Ø, closed is false</li>
              </ul>
              </li>
            </ul>
            <div style="clear:both;"></div>
          </div>
        </section>

        <section id="example-recursion">
          <h4 id="x5-10-4-recursion-example"><bdi class="secno">5.10.4 </bdi>Recursion Example<a class="self-link" aria-label="§" href="#example-recursion"></a></h4>
          
          <div class="example">
              <div class="exsec">Schema:</div>
              <pre class="line-labels" aria-busy="false"><code class="hljs">S1
tc1


nc1</code></pre>
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape",
    "type": "Shape", "expression":
    { "type": "TripleConstraint", "min": 0, "max": -1,
      "predicate": "http://schema.example/#related",
      "valueExpr":
      "http://schema.example/#IssueShape"
    } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                      
  ex:IssueShape {


    ex:related

      @ex:IssueShape*
}</pre>
            <button>json</button></div>
            <div style="clear:both;" class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t1
t2
t3</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs javascript">PREFIX ex: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">schema.example</span>/#&gt;</span>
PREFIX inst: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">inst.example</span>/&gt;</span>
inst:Issue1 ex:related inst:Issue2 .
inst:Issue2 ex:related inst:Issue3 .
inst:Issue3 ex:related inst:Issue1 .</span></code></pre>
            </div>
            <div style="clear:both;"></div>
            <p class="leadup">inst:Issue1 satisfies <span class="lineno schema">S1</span> with the <a data-link-type="dfn" href="http://shex.io/shape-map/#dfn-fixed-shapemap">ShapeMap</a></p>
            <pre class="line-labels" aria-busy="false"><code class="hljs">m:</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs json">{ <span class="hljs-attr">"http://inst.example/Issue1"</span>: <span class="hljs-string">"http://schema.example/#IssueShape"</span>,
  <span class="hljs-attr">"http://inst.example/Issue2"</span>: <span class="hljs-string">"http://schema.example/#IssueShape"</span>,
  <span class="hljs-attr">"http://inst.example/Issue3"</span>: <span class="hljs-string">"http://schema.example/#IssueShape"</span> }</code></pre>
            </div>
            <div style="clear:both;" class="validation"><span>Validate</span> <span>inst:Issue1</span> as <span class="hljs-string">http://schema.example/#IssueShape</span>:</div>
            <p class="leadup followup">as seen in this evaluation:</p>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1,t2,t3</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (inst:Issue1, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, inst:Issue1) = [<span class="lineno data">t1</span>], matched = [<span class="lineno data">t1</span>], remainder = Ø</li>
                <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (inst:Issue2, <span class="lineno schema">nc1</span>, G, m)
                  <ul>
                    <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (inst:Issue2, <span class="lineno schema">nc1</span>)
                    <ul>
                      <li><a href="#satisfies-Shape">satisfies Shape</a> (inst:Issue2. <span class="lineno schema">S2</span>, G, m)
                      <ul>
                        <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, inst:Issue2) = [<span class="lineno data">t3</span>], matched = [<span class="lineno data">t3</span>], remainder = Ø</li>
                        <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t3</span>], <span class="lineno schema">tc3</span>, m)
                        <ul style="border-left:solid thin brown">
                          <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (inst:Issue3, <span class="lineno schema">nc3</span>, G, m)
                          <ul>
                            <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (inst:Issue3, <span class="lineno schema">nc3</span>)
                            <ul>
                              <li><a href="#satisfies-Shape">satisfies Shape</a> (inst:Issue3. <span class="lineno schema">S2</span>, G, m)
                              <ul>
                                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, inst:Issue3) = [<span class="lineno data">t3</span>], matched = [<span class="lineno data">t3</span>], remainder = Ø</li>
                                <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t3</span>], <span class="lineno schema">tc3</span>, m)
                                <ul style="border-left:solid thin brown">
                                  <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (inst:Issue1, <span class="lineno schema">nc3</span>, G, m)
                                  <ul>
                                    <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (inst:Issue1, <span class="lineno schema">nc3</span>)<br />
                                    This is known to be true or the initial typing would not be satisfied.</li>
                                </ul></li></ul></li>
                                <li>outs = Ø</li>
                                <li>matchables = Ø, unmatchables = Ø, closed is false</li>
                            </ul></li></ul></li>
                        </ul></li></ul></li>
                        <li>outs = Ø</li>
                        <li>matchables = Ø, unmatchables = Ø, closed is false</li>
                </ul></li></ul></li></ul></li></ul></li>
                <li>outs = Ø</li>
                <li>matchables = Ø, unmatchables = Ø, closed is false</li>
              </ul>
              </li>
            </ul>
            <div style="clear:both;"></div>
          </div>
        </section>

        <section id="example-simple-repeated-property">
          <h4 id="x5-10-5-simple-repeated-property-examples"><bdi class="secno">5.10.5 </bdi>Simple Repeated Property Examples<a class="self-link" aria-label="§" href="#example-simple-repeated-property"></a></h4>
          
          <div class="example">
              <div class="exsec">Schema:</div>
              <pre class="line-labels" aria-busy="false"><code class="hljs">S1
te1
tc1


nc1

tc2


nc2</code></pre>
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
    { "id": "http://schema.example/#TestResultsShape",
      "type": "Shape", "expression": {
        "type": "EachOf", "expressions": [
          { "type": "TripleConstraint", "min": 1, "max": -1,
            "predicate": "http://schema.example/#val",
            "valueExpr":
            { "type": "NodeConstraint",
              "values": [ {"value": "a"}, {"value": "b"}, {"value": "c"} ] } },
          { "type": "TripleConstraint", "min": 1, "max": -1,
            "predicate": "http://schema.example/#val",
            "valueExpr":
            { "type": "NodeConstraint",
              "values": [ {"value": "b"}, {"value": "c"}, {"value": "d"} ] } }
        ] } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                               
            &lt;http://schema.example/#TestResultsShape&gt;
{


                         &lt;http://schema.example/#val&gt;


                         ["a" "b" "c"]+ ;

                         &lt;http://schema.example/#val&gt;


                         ["b" "c" "d"]+
}</pre>
            <button>json</button></div>
            <div style="clear:both;" class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t1
t2
t3
t4</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs xml">BASE <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">a.example</span>/&gt;</span>
PREFIX ex: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">schema.example</span>/#&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">s</span>&gt;</span> ex:val "a" .
<span class="hljs-tag">&lt;<span class="hljs-name">s</span>&gt;</span> ex:val "b" .
<span class="hljs-tag">&lt;<span class="hljs-name">s</span>&gt;</span> ex:val "c" .
<span class="hljs-tag">&lt;<span class="hljs-name">s</span>&gt;</span> ex:val "d" .</code></pre>
            </div>
            <div style="clear:both;"></div>
            <p class="leadup">&lt;s&gt; satisfies <span class="lineno schema">S1</span> with:</p>
            <pre class="line-labels" aria-busy="false"><code class="hljs">m:</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs javascript">{ <span class="hljs-string">"http://a.example/s"</span>: <span class="hljs-string">"http://a.example/S1 }</span></code></pre>
            </div>
            <div style="clear:both;" class="validation"><span>Validate</span> <span class="hljs-name">&lt;s&gt;</span> as <span class="hljs-string">http://schema.example/#TestResultShape</span>:</div>
            <p class="leadup followup">If <span class="math"><span class="lineno schema">tc1</span></span> consumes as many triples as it can, it consumes three and <span class="math"><span class="lineno schema">tc2</span></span> consumes one:</p>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1,t2,t3,t4</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (&lt;s&gt;, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;s&gt;) = [<span class="lineno data">t1,t2,t3,t4</span>], matched = [<span class="lineno data">t1,t2,t3,t4</span>], remainder = Ø</li>
                <li><a href="#matches-EachOf">matches EachOf</a> ([<span class="lineno data">t1,t2,t3,t4</span>], <span class="lineno schema">te1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#matches-cardinality">matches cardinality</a> ([<span class="lineno data">t1,t2,t3</span>], <span class="lineno schema">tc1</span>, m)
                  <ul style="border-left:solid thin brown">
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("a", <span class="lineno schema">nc1</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("a", <span class="lineno schema">nc1</span>)</li>
                    </ul></li></ul></li>
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t2</span>], <span class="lineno schema">tc1</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("b", <span class="lineno schema">nc1</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("b", <span class="lineno schema">nc1</span>)</li>
                    </ul></li></ul></li>
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t3</span>], <span class="lineno schema">tc1</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("c", <span class="lineno schema">nc1</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("c", <span class="lineno schema">nc1</span>)</li>
                    </ul></li></ul></li>
                  </ul></li>
                  <li><a href="#matches-cardinality">matches cardinality</a> ([<span class="lineno data">t4</span>], <span class="lineno schema">tc2</span>, m)
                  <ul style="border-left:solid thin brown">
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t4</span>], <span class="lineno schema">tc2</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("d", <span class="lineno schema">nc2</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("d", <span class="lineno schema">nc2</span>)</li>
                    </ul></li></ul></li>
                  </ul></li>
                </ul></li>
                <li>outs = Ø</li>
                <li>matchables = Ø, unmatchables = Ø, <span class="parameter">closed</span> is false</li>
              </ul>
              </li>
            </ul>
            <div style="clear:both;"></div>

            <p class="leadup">If we eliminate <span class="math"><span class="lineno data">t4</span></span>, either <span class="math"><span class="lineno data">t2</span></span> or <span class="math"><span class="lineno data">t3</span></span> must be allocated to <span class="math"><span class="lineno schema">tc2</span></span>:</p>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1,t2,t3</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (&lt;Alice&gt;, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;Alice&gt;) = [<span class="lineno data">t1,t2,t3</span>], matched = [<span class="lineno data">t1,t2,t3</span>], remainder = Ø</li>
                <li><a href="#matches-EachOf">matches EachOf</a> ([<span class="lineno data">t1,t2,t3</span>], <span class="lineno schema">te1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#matches-cardinality">matches cardinality</a> ([<span class="lineno data">t1,t2</span>], <span class="lineno schema">tc1</span>, m)
                  <ul style="border-left:solid thin brown">
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("a", <span class="lineno schema">nc1</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("a", <span class="lineno schema">nc1</span>)</li>
                    </ul></li></ul></li>
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t2</span>], <span class="lineno schema">tc1</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("b", <span class="lineno schema">nc1</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("b", <span class="lineno schema">nc1</span>)</li>
                    </ul></li></ul></li>
                  </ul></li>
                  <li><a href="#matches-cardinality">matches cardinality</a> ([<span class="lineno data">t3</span>], <span class="lineno schema">tc2</span>, m)
                  <ul style="border-left:solid thin brown">
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t3</span>], <span class="lineno schema">tc2</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("d", <span class="lineno schema">nc2</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("d", <span class="lineno schema">nc2</span>)</li>
                    </ul></li></ul></li>
                  </ul></li>
                </ul></li>
                <li>outs = Ø</li>
                <li>matchables = Ø, unmatchables = Ø, <span class="parameter">closed</span> is false</li>
              </ul>
              </li>
            </ul>
            <div style="clear:both;"></div>
          </div>
        </section>

        <section id="example-repeated-property-with-dependent-shapes">
          <h4 id="x5-10-6-repeated-property-with-dependent-shapes-example"><bdi class="secno">5.10.6 </bdi>Repeated Property With Dependent Shapes Example<a class="self-link" aria-label="§" href="#example-repeated-property-with-dependent-shapes"></a></h4>
          
          <div class="example">
              <div class="exsec">Schema:</div>
              <pre class="line-labels" aria-busy="false"><code class="hljs">S1
te1

tc1

nc1

tc2

nc2

S2

tc3


nc3

S3

tc4


nc4</code></pre>
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
  { "id": "http://schema.example/#IssueShape",
    "type": "Shape", "expression":
    { "type": "EachOf", "expressions": [
        { "type": "TripleConstraint",
          "predicate": "http://schema.example/#reproducedBy",
          "valueExpr":
          "http://schema.example/#TesterShape" },
        { "type": "TripleConstraint",
          "predicate": "http://schema.example/#reproducedBy",
          "valueExpr":
          "http://schema.example/#ProgrammerShape" }
      ] } },
  { "id": "http://schema.example/#TesterShape",
    "type": "Shape", "expression":
    { "type": "TripleConstraint",
      "predicate": "http://schema.example/#role",
      "valueExpr":
      { "type": "NodeConstraint",
        "values": [ "http://schema.example/#testingRole" ] } } },
  { "id": "http://schema.example/#ProgrammerShape",
    "type": "Shape", "expression":
    { "type": "TripleConstraint",
      "predicate": "http://schema.example/#department",
      "valueExpr":
      { "type": "NodeConstraint",
        "values": [ "http://schema.example/#ProgrammingDepartment" ] } } }
  ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                          
ex:IssueShape {



  ex:reproducedBy

    @ex:TesterShape;

  ex:reproducedBy

    @ex:ProgrammerShape
}
ex:TesterShape {


  ex:role

    [ex:testingRole]
}
ex:ProgrammerShape {


  ex:department

    [ex:ProgrammingDepartment]
}
 </pre>
            <button>json</button></div>
            <div style="clear:both;" class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t1
t2


t3


t4
t5</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs javascript">PREFIX ex: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">schema.example</span>/#&gt;</span>
PREFIX inst: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">inst.example</span>/&gt;</span>
inst:Issue1
  ex:reproducedBy inst:Tester2 ;
  ex:reproducedBy inst:Testgrammer23 .

inst:Tester2              
  ex:role ex:testingRole .

inst:Testgrammer23                        
  ex:role ex:testingRole ;                
  ex:department ex:ProgrammingDepartment .</span></code></pre>
            </div>
            <div style="clear:both;"></div>
            <p class="leadup">inst:Issue1 satisfies <span class="lineno schema">S1</span> with the <a data-link-type="dfn" href="http://shex.io/shape-map/#dfn-fixed-shapemap">ShapeMap</a></p>
            <pre class="line-labels" aria-busy="false"><code class="hljs">m:</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs json">{ <span class="hljs-attr">"http://inst.example/Issue1"</span>: <span class="hljs-string">"http://schema.example/#IssueShape"</span>,
  <span class="hljs-attr">"http://inst.example/Tester2"</span>: <span class="hljs-string">"http://schema.example/#TesterShape"</span>,
  <span class="hljs-attr">"http://inst.example/Testgrammer23"</span>: <span class="hljs-string">"http://schema.example/#ProgrammerShape"</span> }</code></pre>
            </div>
            <div style="clear:both;" class="validation"><span>Validate</span> <span>inst:Issue1</span> as <span class="hljs-string">http://schema.example/#IssueShape</span>:</div>
            <p class="leadup followup">as seen in this evaluation:</p>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1,t2,t3,t4,t5</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (inst:Issue1, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, inst:Issue1) = [<span class="lineno data">t1,t2</span>], matched = [<span class="lineno data">t1,t2</span>], remainder = Ø</li>
                <li><a href="#matches-EachOf">matches EachOf</a> ([<span class="lineno data">t1,t2</span>], <span class="lineno schema">te1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)
                  <ul>
                    <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (inst:Tester2, <span class="lineno schema">nc1</span>, G, m)
                    <ul>
                      <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (inst:Tester2, <span class="lineno schema">nc1</span>)
                      <ul>
                        <li><a href="#satisfies-Shape">satisfies Shape</a> (inst:Tester2. <span class="lineno schema">S2</span>, G, m)
                        <ul>
                          <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, inst:Tester2) = [<span class="lineno data">t3</span>], matched = [<span class="lineno data">t3</span>], remainder = Ø</li>
                          <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t3</span>], <span class="lineno schema">tc3</span>, m)
                          <ul style="border-left:solid thin brown">
                            <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (ex:testingRole, <span class="lineno schema">nc3</span>, G, m)
                            <ul>
                              <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (ex:testingRole, <span class="lineno schema">nc3</span>)</li>
                        </ul></li></ul></li>
                          <li>outs = Ø</li>
                          <li>matchables = Ø, unmatchables = Ø, closed is false</li>
                  </ul></li></ul></li></ul></li></ul></li>
                  <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t2</span>], <span class="lineno schema">tc1</span>, m)
                  <ul>
                    <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (inst:Testgrammer23, <span class="lineno schema">nc2</span>, G, m)
                    <ul>
                      <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (inst:Testgrammer23, <span class="lineno schema">nc2</span>)
                      <ul>
                        <li><a href="#satisfies-Shape">satisfies Shape</a> (inst:Testgrammer23. <span class="lineno schema">S3</span>, G, m)
                        <ul>
                          <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, inst:Testgrammer23) = [<span class="lineno data">t5</span>], matched = [<span class="lineno data">t5</span>], remainder = Ø</li>
                          <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t5</span>], <span class="lineno schema">tc3</span>, m)
                          <ul style="border-left:solid thin brown">
                            <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> (ex:testingRole, <span class="lineno schema">nc4</span>, G, m)
                            <ul>
                              <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> (ex:testingRole, <span class="lineno schema">nc4</span>)</li>
                          </ul></li></ul></li>
                          <li>outs = Ø</li>
                          <li>matchables = Ø, unmatchables = Ø, closed is false</li>
                  </ul></li></ul></li></ul></li></ul></li>
                </ul></li>
                <li>outs = Ø</li>
                <li>matchables = Ø, unmatchables = Ø, closed is false</li>
              </ul>
              </li>
            </ul>
            <div style="clear:both;"></div>
          </div>
        </section>

        <section id="example-negation">
          <h4 id="x5-10-7-negation-example"><bdi class="secno">5.10.7 </bdi>Negation Example<a class="self-link" aria-label="§" href="#example-negation"></a></h4>
          <p>
            Setting the maximum <a href="#dfn-cardinality" class="internalDFN" data-link-type="dfn">cardinality</a> of a TripleConstraint with <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> <span class="math">p</span> to zero (i.e. <span>"max": 0</span> in <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> or <code>{0}</code> or <code>{0, 0}</code> in <a href="#dfn-shexc" class="internalDFN" data-link-type="dfn">ShExC</a>) asserts that matching nodes must have no triples with <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> <span class="math">p</span>.
          </p>
          
          <div class="example">
              <div class="exsec">Schema:</div>
              <pre class="line-labels" aria-busy="false"><code class="hljs">S1
te1
tc1


nc1

tc2</code></pre>
            <div class="inline repchoice" tabindex="0">
              <pre class="json nohighlight repchosen">{ "type": "Schema", "shapes": [
    { "id": "http://schema.example/#TestResultsShape",
      "type": "Shape", "expression": {
        "type": "EachOf", "expressions": [
          { "type": "TripleConstraint", "min": 1, "max": -1,
            "predicate": "http://schema.example/#p1",
            "valueExpr":
            { "type": "NodeConstraint",
              "values": [ {"value": "a"}, {"value": "b"} ] } },
          { "type": "TripleConstraint", "min": 1, "max": -1,
            "predicate": "http://schema.example/#p2", "min": 0, "max": 0 }
        ] } } ] }</pre>
              <pre class="shexc nohighlight rephidden">                                                                          
            &lt;http://schema.example/#TestResultsShape&gt;
{


                         &lt;http://schema.example/#p1&gt;


                         ["a" "b"] + ;

                         &lt;http://schema.example/#p2&gt; . {0}
}</pre>
            <button>json</button></div>
            <div style="clear:both;" class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t1</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs xml">BASE <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">a.example</span>/&gt;</span>
PREFIX ex: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">schema.example</span>/#&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">s</span>&gt;</span> ex:p1 "a" .</code></pre>
            </div>
            <div style="clear:both;"></div>
            <p class="leadup">&lt;s&gt; satisfies <span class="lineno schema">S1</span> with:</p>
            <pre class="line-labels" aria-busy="false"><code class="hljs">m:</code></pre>
            <div class="inline json">
              <pre aria-busy="false"><code class="hljs json">{ <span class="hljs-attr">"http://a.example/s"</span>: <span class="hljs-string">"http://a.example/S1"</span> }</code></pre>
            </div>
            <div style="clear:both;" class="validation"><span>Validate</span> <span class="hljs-name">&lt;s&gt;</span> as <span class="hljs-string">http://schema.example/#TestResultShape</span>:</div>
            <p class="leadup followup">This is trivially satisfied by <span class="math"><span class="lineno schema">tc1</span></span> consuming one triple and <span class="math"><span class="lineno schema">tc2</span></span> consuming none:</p>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (&lt;s&gt;, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;s&gt;) = [<span class="lineno data">t1</span>], matched = [<span class="lineno data">t1</span>], remainder = Ø</li>
                <li><a href="#matches-EachOf">matches EachOf</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">te1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#matches-cardinality">matches cardinality</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)
                  <ul style="border-left:solid thin brown">
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("a", <span class="lineno schema">nc1</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("a", <span class="lineno schema">nc1</span>)</li>
                    </ul></li></ul></li>
                  </ul></li>
                  <li><a href="#matches-cardinality">matches cardinality</a> ([<span class="lineno data"></span>], <span class="lineno schema">tc2</span>, m)
                  <ul style="border-left:solid thin brown">
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data"></span>], <span class="lineno schema">tc2</span>, m)</li>
                  </ul></li>
                </ul></li>
                <li>outs = Ø</li>
                <li>matchables = Ø, unmatchables = Ø, <span class="parameter">closed</span> is false</li>
              </ul>
              </li>
            </ul>
            <div style="clear:both;"></div>

            <p class="leadup">If we add a <span class="math"><span class="lineno data">t2</span></span> which matches <span class="math"><span class="lineno schema">tc2</span></span>:</p>
            <div style="clear:both;" class="exsec">Data:</div>
            <pre class="line-labels" aria-busy="false"><code class="hljs">t1
t2</code></pre>
            <div class="inline json error">
              <pre aria-busy="false"><code class="hljs xml">BASE <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">a.example</span>/&gt;</span>
PREFIX ex: <span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">schema.example</span>/#&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">s</span>&gt;</span> ex:p1 "a" .
<span class="hljs-tag">&lt;<span class="hljs-name">s</span>&gt;</span> ex:p2 5 .</code></pre>
            </div>
            <div style="clear:both;"></div>
            <p>
              every partition fails, either because matchables is non-empty or because the maximum cardinality on <span class="lineno schema">tc2</span> is exceeded:
            </p>
            <ul class="trace followup">
              <li>G = [<span class="lineno data">t1</span>]</li>
              <li><a href="#satisfies-Shape">satisfies Shape</a> (&lt;s&gt;, <span class="lineno schema">S1</span>, G, m)
              <ul>
                <li><a href="#dfn-neigh" class="internalDFN" data-link-type="dfn">neigh</a>(G, &lt;s&gt;) = [<span class="lineno data">t1</span>], matched = [<span class="lineno data">t1</span>], remainder = Ø</li>
                <li><a href="#matches-EachOf">matches EachOf</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">te1</span>, m)
                <ul style="border-left:solid thin brown">
                  <li><a href="#matches-cardinality">matches cardinality</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)
                  <ul style="border-left:solid thin brown">
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t1</span>], <span class="lineno schema">tc1</span>, m)
                    <ul>
                      <li><a href="#satisfies-NodeConstraint">satisfies NodeConstraint</a> ("a", <span class="lineno schema">nc1</span>, G, m)
                      <ul>
                        <li><a href="#satisfies2-NodeConstraint">satisfies2 NodeConstraint</a> ("a", <span class="lineno schema">nc1</span>)</li>
                    </ul></li></ul></li>
                  </ul></li>
                  <li><span class="fail"><a href="#matches-cardinality">matches cardinality</a> ([<span class="lineno data">t2</span>], <span class="lineno schema">tc2</span>, m)</span>
                  <ul style="border-left:solid thin brown">
                    <li><a href="#matches-TripleConstraint">matches TripleConstraint</a> ([<span class="lineno data">t2</span>], <span class="lineno schema">tc2</span>, m)</li>
                  </ul></li>
                </ul></li>
                <li>outs = Ø</li>
                <li>matchables = Ø, unmatchables = Ø, <span class="parameter">closed</span> is false</li>
              </ul>
              </li>
            </ul>
            <div style="clear:both;"></div>
          </div>
        </section>

      </section>
    </section>
      
    <section id="shexc">
      <h2 id="x6-shex-compact-syntax-shexc"><bdi class="secno">6. </bdi>ShEx Compact syntax (ShExC)<a class="self-link" aria-label="§" href="#shexc"></a></h2>
      <div>
    <p>
      The ShEx Compact Syntax expresses ShEx schemas in a compact, human-friendly form.
      Parsing <dfn data-dfn-type="dfn" id="dfn-shexc">ShExC</dfn> transforms a <a href="#dfn-shexc" class="internalDFN" data-link-type="dfn">ShExC</a> document into an equivalent <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> structure.
      This is defined as a BNF which accepts <a href="#dfn-shexc" class="internalDFN" data-link-type="dfn">ShExC</a> followed by instructions for tranlating the rules in the BNF production into their corresponding <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> objects.
      For example, "<span style="font-family: monospace; ">shapeExprDecl returns <span class="prod"><a class="grammarRef" href="#prod-shapeExpression">shapeExpression</a></span></span>" indicates that the result of matching the <code>shapeExprDecl</code> production is the object produced by parsing the <code>shapeExpression</code> production.
    </p>
    <p>
      Semantic actions before the first <span class="prod"><a class="grammarRef" href="#prod-shapeExprDecl">shape expression declaration</a></span> are <span class="param"><a href="#dfn-startacts" class="internalDFN" data-link-type="dfn">startActs</a></span>.
      After the first <span class="prod"><a class="grammarRef" href="#prod-shapeExprDecl">shape expression declaration</a></span>, semantic actions are associated with the previous declaration.
    </p>
    <p>
      <button id="toggleGrammar">Display grammar only</button>
    </p>
      <div class="grammarTable">
<table style="border: 0; border-top: thick solid white; ">


<tbody class="grammarParagraph">
  <tr style="border-top: thick solid white; border-left: thin solid white; border-right: thin solid white; "><td colspan="4">Below is the <a href="#dfn-shexc" class="internalDFN" data-link-type="dfn">ShExC</a> grammar following the <a href="https://www.w3.org/TR/xml/#sec-notation">notation in the XML specification</a>[<cite><a class="bibref" href="#bib-xml" title="Extensible Markup Language (XML) 1.0 (Fifth Edition)" data-link-type="biblio">XML</a></cite>]:</td></tr>
</tbody>
<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-shexDoc">[<span class="prodNo">1</span>]   </td>
<td><code class="production prod">shexDoc</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-directive">directive</a></span>* ((<span class="prod"><a class="grammarRef" href="#prod-notStartAction">notStartAction</a></span> | <span class="prod"><a class="grammarRef" href="#prod-startActions">startActions</a></span>) <span class="prod"><a class="grammarRef" href="#prod-statement">statement</a></span>*)?</code></td>
</tr>
</tbody>
<tbody class="grammarParagraph">
  <tr><td colspan="4" style="padding-top: 2ex; ">followed by the associated <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> object(s):</td></tr>
</tbody>

<tbody class="prod">
<tr class="obj"><td style="border-top: thick solid white; border-bottom: thick solid white; "></td><td><a class="obj internalDFN" href="#dfn-shapes-schema" data-link-type="dfn">Schema</a></td><td>{</td><td>
<a class="param internalDFN" href="#dfn-startacts" data-link-type="dfn">startActs</a>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]?
<a class="param internalDFN" href="#dfn-start" data-link-type="dfn">start</a>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>?
<a class="param internalDFN" href="#dfn-imports" data-link-type="dfn">imports</a>:[<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a>+]?
<a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>+]? }
</td></tr>
</tbody>

<tbody class="grammarParagraph">
  <tr class="borderHack"><td></td><td colspan="3"></td></tr>
  <tr><td colspan="4" style="padding-top: 2ex; ">and a description of the mapping of rules in the production to elements of the <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> object:</td></tr>
</tbody>

<tbody class="prod">
  <tr class="params"><td style="border-top: thick solid white; border-bottom: thick solid white; "></td><td colspan="3"><ul>
<li><a class="param internalDFN" href="#dfn-startacts" data-link-type="dfn">startActs</a> comes from <span class="prod"><a class="grammarRef" href="#prod-startActions">startActions</a></span> production.</li>
<li><a class="param internalDFN" href="#dfn-start" data-link-type="dfn">start</a> comes from the <span class="prod"><a class="grammarRef" href="#prod-start">start</a></span> production.</li>
<li><a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a> come from the <span class="prod"><a class="grammarRef" href="#prod-shapeExprDecl">shapeExprDecl</a></span> production.</li>
  </ul></td></tr>
</tbody>

  <tbody>
<tr style="vertical-align: baseline">
<td id="prod-directive">[<span class="prodNo">2</span>]   </td>
<td><code class="production prod">directive</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-baseDecl">baseDecl</a></span> | <span class="prod"><a class="grammarRef" href="#prod-prefixDecl">prefixDecl</a></span> | <span class="prod"><a class="grammarRef" href="#prod-importDecl">importDecl</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-baseDecl">[<span class="prodNo">3</span>]   </td>
<td><code class="production prod">baseDecl</code></td>
<td>   ::=   </td>
<td><code class="content">"BASE" <span class="prod"><a class="grammarRef" href="#term-IRIREF">IRIREF</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-prefixDecl">[<span class="prodNo">4</span>]   </td>
<td><code class="production prod">prefixDecl</code></td>
<td>   ::=   </td>
<td><code class="content">"PREFIX" <span class="prod"><a class="grammarRef" href="#term-PNAME_NS">PNAME_NS</a></span> <span class="prod"><a class="grammarRef" href="#term-IRIREF">IRIREF</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-importDecl">[<span class="prodNo">4½</span>]   </td>
<td><code class="production prod">importDecl</code></td>
<td>   ::=   </td>
<td><code class="content">"IMPORT" <span class="prod"><a class="grammarRef" href="#term-IRIREF">IRIREF</a></span></code></td>
</tr>
  <tr class="params"><td></td><td colspan="3">"<code>IMPORT</code>" is described in <a href="#import">ShEx Import</a>.</td></tr>
<tr style="vertical-align: baseline">
<td id="prod-notStartAction">[<span class="prodNo">5</span>]   </td>
<td><code class="production prod">notStartAction</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-start">start</a></span> | <span class="prod"><a class="grammarRef" href="#prod-shapeExprDecl">shapeExprDecl</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-start">[<span class="prodNo">6</span>]   </td>
<td><code class="production prod">start</code></td>
<td>   ::=   </td>
<td><code class="content">"start" '=' <span class="prod"><a class="grammarRef" href="#prod-inlineShapeExpression">inlineShapeExpression</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-startActions">[<span class="prodNo">7</span>]   </td>
<td><code class="production prod">startActions</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-codeDecl">codeDecl</a></span>+</code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-statement">[<span class="prodNo">8</span>]   </td>
<td><code class="production prod">statement</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-directive">directive</a></span> | <span class="prod"><a class="grammarRef" href="#prod-notStartAction">notStartAction</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-shapeExprDecl">[<span class="prodNo">9</span>]   </td>
<td><code class="production prod">shapeExprDecl</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-shapeExprLabel">shapeExprLabel</a></span> (<span class="prod"><a class="grammarRef" href="#prod-shapeExpression">shapeExpression</a></span> | "EXTERNAL")</code></td>
</tr>
  <tr class="params"><td></td><td colspan="3">If the "<code>EXTERNAL</code>" keyword is present, <span class="prod"><a class="grammarRef" href="#prod-shapeExprDecl">shapeExprDecl</a></span> returns a <a class="obj internalDFN" href="#dfn-shapeexternal" data-link-type="dfn">ShapeExternal</a> object:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-shapeexternal" data-link-type="dfn">ShapeExternal</a></td><td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? }</td></tr>
  <tr class="params"><td></td><td colspan="3">otherwise <span class="prod"><a class="grammarRef" href="#prod-shapeExprDecl">shapeExprDecl</a></span> returns <span class="prod"><a class="grammarRef" href="#prod-shapeExpression">shapeExpression</a></span>.</td></tr>
</tbody>

<tbody class="grammarParagraph">
  <tr class="borderHack"><td></td><td colspan="3"></td></tr>
  <tr><td colspan="4">
    <p>
      Shape expressions are logical combinations of shape atoms.
      Inline variants of <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expressions</a> are used in <span class="prod"><a class="grammarRef" href="#prod-tripleConstraint">tripleConstraint</a></span>s and are not permitted to have annotations or semantic actions.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-shapeExpression">[<span class="prodNo">10</span>]   </td>
<td><code class="production prod">shapeExpression</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-shapeOr">shapeOr</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-inlineShapeExpression">[<span class="prodNo">11</span>]   </td>
<td><code class="production prod">inlineShapeExpression</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-inlineShapeOr">inlineShapeOr</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-shapeOr">[<span class="prodNo">12</span>]   </td>
<td><code class="production prod">shapeOr</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-shapeAnd">shapeAnd</a></span> ("OR" <span class="prod"><a class="grammarRef" href="#prod-shapeAnd">shapeAnd</a></span>)*</code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-inlineShapeOr">[<span class="prodNo">13</span>]   </td>
<td><code class="production prod">inlineShapeOr</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-inlineShapeAnd">inlineShapeAnd</a></span> ("OR" <span class="prod"><a class="grammarRef" href="#prod-inlineShapeAnd">inlineShapeAnd</a></span>)*</code></td>
</tr>
<tr class="params"><td></td><td colspan="3">
If the right <a class="grammarRef" href="#prod-shapeAnd">shapeAnd</a> matches one or more times, the result is a <a class="obj internalDFN" href="#dfn-shapeor" data-link-type="dfn">ShapeOr</a> object with <span class="param">shapeExprs</span> containing the first <a class="grammarRef" href="#prod-shapeAnd">shapeAnd</a> followed by the ordered list from the second <a class="grammarRef" href="#prod-shapeAnd">shapeAnd</a>:
</td></tr>
<tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-shapeor" data-link-type="dfn">ShapeOr</a></td><td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">shapeExprs</span>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>{2,}] }</td></tr>
<tr class="params"><td></td><td colspan="3">
otherwise the result is the left <a class="grammarRef" href="#prod-shapeAnd">shapeAnd</a>.
</td></tr>
<tr style="vertical-align: baseline">
<td id="prod-shapeAnd">[<span class="prodNo">14</span>]   </td>
<td><code class="production prod">shapeAnd</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-shapeNot">shapeNot</a></span> ("AND" <span class="prod"><a class="grammarRef" href="#prod-shapeNot">shapeNot</a></span>)*</code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-inlineShapeAnd">[<span class="prodNo">15</span>]   </td>
<td><code class="production prod">inlineShapeAnd</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-inlineShapeNot">inlineShapeNot</a></span> ("AND" <span class="prod"><a class="grammarRef" href="#prod-inlineShapeNot">inlineShapeNot</a></span>)*</code></td>
</tr>
<tr class="params"><td></td><td colspan="3">
If the right <a class="grammarRef" href="#prod-shapeNot">shapeNot</a> matches one or more times, the result is a <a class="obj internalDFN" href="#dfn-shapeand" data-link-type="dfn">ShapeAnd</a> object with <span class="param">shapeExprs</span> containing the first <a class="grammarRef" href="#prod-shapeNot">shapeNot</a> followed by the ordered list from the second <a class="grammarRef" href="#prod-shapeNot">shapeNot</a>:
</td></tr>
<tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-shapeand" data-link-type="dfn">ShapeAnd</a></td><td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">shapeExprs</span>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>{2,}] }</td></tr>
<tr class="params"><td></td><td colspan="3">
otherwise the result is the left <a class="grammarRef" href="#prod-shapeNot">shapeNot</a>.
</td></tr>
<tr style="vertical-align: baseline">
<td id="prod-shapeNot">[<span class="prodNo">16</span>]   </td>
<td><code class="production prod">shapeNot</code></td>
<td>   ::=   </td>
<td><code class="content">"NOT"? <span class="prod"><a class="grammarRef" href="#prod-shapeAtom">shapeAtom</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-inlineShapeNot">[<span class="prodNo">17</span>]   </td>
<td><code class="production prod">inlineShapeNot</code></td>
<td>   ::=   </td>
<td><code class="content">"NOT"? <span class="prod"><a class="grammarRef" href="#prod-inlineShapeAtom">inlineShapeAtom</a></span></code></td>
</tr>
<tr class="params"><td></td><td colspan="3">
If the left "<code>NOT</code>" matches, the result is a <a class="obj internalDFN" href="#dfn-shapenot" data-link-type="dfn">ShapeNot</a> object with <span class="param">shapeExpr</span> containing the <a class="grammarRef" href="#prod-shapeAtom">shapeAtom</a>:</td></tr>
<tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-shapenot" data-link-type="dfn">ShapeNot</a></td><td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">shapeExpr</span>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a> }</td></tr>
<tr class="params"><td></td><td colspan="3">
otherwise the result is the <a class="grammarRef" href="#prod-shapeAtom">shapeAtom</a>.
</td></tr>
</tbody>

<tbody class="grammarParagraph">
  <tr class="borderHack"><td></td><td colspan="3"></td></tr>
  <tr><td colspan="4">
    <p>
      Shape atoms are shape references (indicated by "<code>@</code>"), definitions, or nested expressions.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-shapeAtom">[<span class="prodNo">18</span>]   </td>
<td><code class="production prod">shapeAtom</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-nonLitNodeConstraint">nonLitNodeConstraint</a></span> <span class="prod"><a class="grammarRef" href="#prod-shapeOrRef">shapeOrRef</a></span>?<br />
                                | <span class="prod"><a class="grammarRef" href="#prod-litNodeConstraint">litNodeConstraint</a></span><br />
                                | <span class="prod"><a class="grammarRef" href="#prod-shapeOrRef">shapeOrRef</a></span> <span class="prod"><a class="grammarRef" href="#prod-nonLitNodeConstraint">nonLitNodeConstraint</a></span>?<br />
                                | '(' <span class="prod"><a class="grammarRef" href="#prod-shapeExpression">shapeExpression</a></span> ')'<br />
                                | '.'</code></td>
</tr>

<tr style="vertical-align: baseline">
<td id="prod-shapeAtomNoRef">[<span class="prodNo">19</span>]   </td>
<td><code class="production prod">shapeAtomNoRef</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-nonLitNodeConstraint">nonLitNodeConstraint</a></span> <span class="prod"><a class="grammarRef" href="#prod-shapeOrRef">shapeOrRef</a></span>?<br />
                                | <span class="prod"><a class="grammarRef" href="#prod-litNodeConstraint">litNodeConstraint</a></span><br />
                                | <span class="prod"><a class="grammarRef" href="#prod-shapeDefinition">shapeDefinition</a></span> <span class="prod"><a class="grammarRef" href="#prod-nonLitNodeConstraint">nonLitNodeConstraint</a></span>?<br />
                                | '(' <span class="prod"><a class="grammarRef" href="#prod-shapeExpression">shapeExpression</a></span> ')'<br />
                                | '.'</code></td>
</tr>

<tr style="vertical-align: baseline">
<td id="prod-inlineShapeAtom">[<span class="prodNo">20</span>]   </td>
<td><code class="production prod">inlineShapeAtom</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-nonLitNodeConstraint">nonLitNodeConstraint</a></span> <span class="prod"><a class="grammarRef" href="#prod-inlineShapeOrRef">inlineShapeOrRef</a></span>?<br />
                                | <span class="prod"><a class="grammarRef" href="#prod-litNodeConstraint">litNodeConstraint</a></span><br />
                                | <span class="prod"><a class="grammarRef" href="#prod-inlineShapeOrRef">inlineShapeOrRef</a></span> <span class="prod"><a class="grammarRef" href="#prod-nonLitNodeConstraint">nonLitNodeConstraint</a></span>?<br />
                                | '(' <span class="prod"><a class="grammarRef" href="#prod-shapeExpression">shapeExpression</a></span> ')'<br />
                                | '.'</code></td>
</tr>
<tr class="params"><td></td><td colspan="3">
<ul>
  <li>If the matching production inludes both a node constraint (<span class="prod"><a class="grammarRef" href="#prod-litNodeConstraint">litNodeConstraint</a></span> OR <span class="prod"><a class="grammarRef" href="#prod-nonLitNodeConstraint">nonLitNodeConstraint</a></span>) <span class="param">nc</span> and a <span class="prod"><a class="grammarRef" href="#prod-shapeOrRef">shapeOrRef</a></span>, the result is a <a class="obj internalDFN" href="#dfn-shapeand" data-link-type="dfn">ShapeAnd</a> object with <span class="param">shapeExprs</span> containing the list of <span class="param">nc</span> and a <span class="prod"><a class="grammarRef" href="#prod-shapeOrRef">shapeOrRef</a></span>.</li>
  <li>If the "(" <span class="prod"><a class="grammarRef" href="#prod-shapeExpression">shapeExpression</a></span> ")" production matches, the result is the result of <span class="prod"><a class="grammarRef" href="#prod-shapeExpression">shapeExpression</a></span>.</li>
  <li>If the <code>"."</code> production matches, the result is an empty shape: <code>{"type": "Shape"}</code>.</li>
</ul>
</td></tr>
<tr style="vertical-align: baseline">
<td id="prod-shapeOrRef">[<span class="prodNo">21</span>]   </td>
<td><code class="production prod">shapeOrRef</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-shapeDefinition">shapeDefinition</a></span> | <span class="prod"><a class="grammarRef" href="#prod-shapeRef">shapeRef</a></span>
</code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-inlineShapeOrRef">[<span class="prodNo">22</span>]   </td>
<td><code class="production prod">inlineShapeOrRef</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-inlineShapeDefinition">inlineShapeDefinition</a></span> | <span class="prod"><a class="grammarRef" href="#prod-shapeRef">shapeRef</a></span>
</code></td>
</tr>

<tr style="vertical-align: baseline">
<td id="prod-shapeRef">[<span class="prodNo">23</span>]   </td>
<td><code class="production prod">shapeRef</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#term-ATPNAME_LN">ATPNAME_LN</a></span> | <span class="prod"><a class="grammarRef" href="#term-ATPNAME_NS">ATPNAME_NS</a></span> | '@' <span class="prod"><a class="grammarRef" href="#prod-shapeExprLabel">shapeExprLabel</a></span></code></td>
</tr>

<tr class="params"><td></td><td colspan="3">
<ul>
  <li>If the <span class="prod"><a class="grammarRef" href="#prod-shapeDefinition">shapeDefinition</a></span> production matches, the result is <span class="prod"><a class="grammarRef" href="#prod-shapeDefinition">shapeDefinition</a></span>.</li>
  <li>Otherwise, the result is a <a class="obj internalDFN" href="#dfn-shapeexprrefs" data-link-type="dfn">shapeExprRef</a> to <a class="obj internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>.</li>
</ul>
</td></tr>
  <tr class="obj"><td></td><td><a class="nob internalDFN" href="#dfn-shapeexprrefs" data-link-type="dfn">shapeExprRef</a></td>           <td>=</td> <td><a class="objref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a> ;</td></tr>
</tbody>

<tbody class="grammarParagraph">
  <tr class="borderHack"><td></td><td colspan="3"></td></tr>
  <tr><td colspan="4">
    <p>
      Node constraints identify a (possibly infinite) set of matching RDF nodes.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-litNodeConstraint">[<span class="prodNo">24</span>]   </td>
<td><code class="production prod">litNodeConstraint</code></td>
<td>   ::=   </td>
<td>   <code class="content">"LITERAL" <span class="prod"><a class="grammarRef" href="#prod-xsFacet">xsFacet</a></span>*<br />
                                | <span class="prod"><a class="grammarRef" href="#prod-datatype">datatype</a></span> <span class="prod"><a class="grammarRef" href="#prod-xsFacet">xsFacet</a></span>*<br />
                                | <span class="prod"><a class="grammarRef" href="#prod-valueSet">valueSet</a></span> <span class="prod"><a class="grammarRef" href="#prod-xsFacet">xsFacet</a></span>*<br />
                                | <span class="prod"><a class="grammarRef" href="#prod-numericFacet">numericFacet</a></span>+</code></td>
</tr>

<tr style="vertical-align: baseline">
<td id="prod-nonLitNodeConstraint">[<span class="prodNo">25</span>]   </td>
<td><code class="production prod">nonLitNodeConstraint</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-nonLiteralKind">nonLiteralKind</a></span> <span class="prod"><a class="grammarRef" href="#prod-stringFacet">stringFacet</a></span>*<br />
                                | <span class="prod"><a class="grammarRef" href="#prod-stringFacet">stringFacet</a></span>+</code></td>
</tr>

<tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-nodeconstraint" data-link-type="dfn">NodeConstraint</a></td><td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">nodeKind</span>:(<span class="literal">"iri"</span> | <span class="literal">"bnode"</span> | <span class="literal">"nonliteral"</span> | <span class="literal">"literal"</span>)? <span class="param">datatype</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a>? <a class="nobref internalDFN" href="#dfn-xsfacet" data-link-type="dfn">xsFacet</a>* <span class="param">values</span>:[<a class="nobref internalDFN" href="#dfn-valuesetvalue" data-link-type="dfn">valueSetValue</a>+]? }</td></tr>
<tr style="vertical-align: baseline">
<td id="prod-nonLiteralKind">[<span class="prodNo">26</span>]   </td>
<td><code class="production prod">nonLiteralKind</code></td>
<td>   ::=   </td>
<td><code class="content">"IRI" | "BNODE" | "NONLITERAL"</code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-xsFacet">[<span class="prodNo">27</span>]   </td>
<td><code class="production prod">xsFacet</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-stringFacet">stringFacet</a></span> | <span class="prod"><a class="grammarRef" href="#prod-numericFacet">numericFacet</a></span></code></td>
</tr>
<tr class="obj"><td></td><td><a class="nob internalDFN" href="#dfn-xsfacet" data-link-type="dfn">xsFacet</a></td><td>=</td><td><a class="nobref internalDFN" href="#dfn-stringfacet" data-link-type="dfn">stringFacet</a> | <a class="nobref internalDFN" href="#dfn-numericfacet" data-link-type="dfn">numericFacet</a> ;</td></tr>
<tr style="vertical-align: baseline">
<td id="prod-stringFacet">[<span class="prodNo">28</span>]   </td>
<td><code class="production prod">stringFacet</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-stringLength">stringLength</a></span> <span class="prod"><a class="grammarRef" href="#term-INTEGER">INTEGER</a></span><br />
| <span class="prod"><a class="grammarRef" href="#term-REGEXP">REGEXP</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-stringLength">[<span class="prodNo">29</span>]   </td>
<td><code class="production prod">stringLength</code></td>
<td>   ::=   </td>
<td><code class="content">"LENGTH" | "MINLENGTH" | "MAXLENGTH"</code></td>
</tr>
<tr class="obj"><td></td><td><a class="nob internalDFN" href="#dfn-stringfacet" data-link-type="dfn">stringFacet</a></td><td>=</td><td>(<span class="param">length</span>|<span class="param">minlength</span>|<span class="param">maxlength</span>):<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a> | <span class="param">pattern</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a> <span class="param">flags</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? ;</td></tr>
<tr style="vertical-align: baseline">
<td id="prod-numericFacet">[<span class="prodNo">30</span>]   </td>
<td><code class="production prod">numericFacet</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-numericRange">numericRange</a></span> <span class="prod"><a class="grammarRef" href="#prod-numericLiteral">numericLiteral</a></span><br />
| <span class="prod"><a class="grammarRef" href="#prod-numericLength">numericLength</a></span> <span class="prod"><a class="grammarRef" href="#term-INTEGER">INTEGER</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-numericRange">[<span class="prodNo">31</span>]   </td>
<td><code class="production prod">numericRange</code></td>
<td>   ::=   </td>
<td><code class="content">"MININCLUSIVE" | "MINEXCLUSIVE" | "MAXINCLUSIVE" | "MAXEXCLUSIVE"</code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-numericLength">[<span class="prodNo">32</span>]   </td>
<td><code class="production prod">numericLength</code></td>
<td>   ::=   </td>
<td><code class="content">"TOTALDIGITS" | "FRACTIONDIGITS"</code></td>
</tr>
<tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-numericfacet" data-link-type="dfn">numericFacet</a></td><td>=</td><td>(<span class="param">mininclusive</span>|<span class="param">minexclusive</span>|<span class="param">maxinclusive</span>|<span class="param">maxexclusive</span>):<a class="nobref internalDFN" href="#dfn-numericliteral" data-link-type="dfn">numericLiteral</a> | (<span class="param">totaldigits</span>|<span class="param">fractiondigits</span>):<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a> ;</td></tr>
</tbody>

<tbody class="grammarParagraph" style="border-left:thin solid white; border-right:thin solid white;">
  <tr class="borderHack"><td></td><td colspan="3"></td></tr>
  <tr><td colspan="4">
    <p>
      Shape defintions associate a <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> with a closed flag and a list of partially constrained (extra) <a data-lt="predicate" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicates</a>.
      Any <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> appearing in a <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> is fully constrained unless it appears in the list of extras.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-shapeDefinition">[<span class="prodNo">33</span>]   </td>
<td><code class="production prod">shapeDefinition</code></td>
<td>   ::=   </td>
<td><code class="content">(<span class="prod"><a class="grammarRef" href="#prod-extraPropertySet">extraPropertySet</a></span> | "CLOSED")* '{' <span class="prod"><a class="grammarRef" href="#prod-tripleExpression">tripleExpression</a></span>? '}' <span class="prod"><a class="grammarRef" href="#prod-annotation">annotation</a></span>* <span class="prod"><a class="grammarRef" href="#prod-semanticActions">semanticActions</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-inlineShapeDefinition">[<span class="prodNo">34</span>]   </td>
<td><code class="production prod">inlineShapeDefinition</code></td>
<td>   ::=   </td>
<td><code class="content">(<span class="prod"><a class="grammarRef" href="#prod-extraPropertySet">extraPropertySet</a></span> | "CLOSED")* '{' <span class="prod"><a class="grammarRef" href="#prod-tripleExpression">tripleExpression</a></span>? '}'</code></td>
</tr>
<tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-shape" data-link-type="dfn">Shape</a></td><td>{</td><td>
<span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? 

<span class="param">closed</span>:<a href="#dfn-bool" class="internalDFN" data-link-type="dfn">BOOL</a>?
<span class="param">extra</span>:[<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a>+]?
<span class="param">expression</span>:<a class="nobref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>?

<span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]?
<span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
  <tr class="params"><td></td><td colspan="3"><ul>
  <li><span class="param">closed</span> is true if the "<code>CLOSED</code>" choice was matched one or more times.</li>
  <li><span class="param">extra</span> is the set of IRIs matching the <a class="grammarRef" href="#prod-extraPropertySet">extraPropertySet</a> production.</li>
  <li><span class="param">expression</span> comes from the <a class="grammarRef" href="#prod-tripleExpression">tripleExpression</a> production.</li>
  <li><span class="param">annotations</span> is the set of <a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>s matching the <span class="prod"><a class="grammarRef" href="#prod-annotation">annotation</a></span> production.</li>
  <li><span class="param">semActs</span> is the set of semantic actions matching the <span class="prod"><a class="grammarRef" href="#prod-semanticActions">semanticActions</a></span> production.</li>
</ul>
  </td></tr>
<tr style="vertical-align: baseline">
<td id="prod-extraPropertySet">[<span class="prodNo">35</span>]   </td>
<td><code class="production prod">extraPropertySet</code></td>
<td>   ::=   </td>
<td><code class="content">"EXTRA" <span class="prod"><a class="grammarRef" href="#prod-predicate">predicate</a></span>+</code></td>
</tr>
</tbody>

<tbody class="grammarParagraph">
  <tr><td colspan="4">
    <p>
      Triple expressions are arrangements of triple constraints.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-tripleExpression">[<span class="prodNo">36</span>]   </td>
<td><code class="production prod">tripleExpression</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-oneOfTripleExpr">oneOfTripleExpr</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-oneOfTripleExpr">[<span class="prodNo">37</span>]   </td>
<td><code class="production prod">oneOfTripleExpr</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-groupTripleExpr">groupTripleExpr</a></span> | <span class="prod"><a class="grammarRef" href="#prod-multiElementOneOf">multiElementOneOf</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-multiElementOneOf">[<span class="prodNo">38</span>]   </td>
<td><code class="production prod">multiElementOneOf</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-groupTripleExpr">groupTripleExpr</a></span> ('|' <span class="prod"><a class="grammarRef" href="#prod-groupTripleExpr">groupTripleExpr</a></span>)+</code></td>
</tr>
<tr class="params"><td></td><td colspan="3">
If the right <a class="grammarRef" href="#prod-groupTripleExpr">groupTripleExpr</a> matches one or more times, the result is a <a class="obj internalDFN" href="#dfn-oneof" data-link-type="dfn">OneOf</a> object with <span class="param">expressions</span> containing the first <a class="grammarRef" href="#prod-groupTripleExpr">groupTripleExpr</a> followed by the ordered list from the second <a class="grammarRef" href="#prod-groupTripleExpr">groupTripleExpr</a>:
</td></tr>
<tr class="obj"><td></td><td class="obj"><a href="#dfn-oneof" class="internalDFN" data-link-type="dfn">OneOf</a></td>                       <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a>? <span class="param">expressions</span>:[<a class="nobref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>{2,}] <span class="param">min</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">max</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
<tr class="params"><td></td><td colspan="3">
otherwise the result is the left <a class="grammarRef" href="#prod-groupTripleExpr">groupTripleExpr</a>.
</td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-groupTripleExpr">[<span class="prodNo">40</span>]   </td>
<td><code class="production prod">groupTripleExpr</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-singleElementGroup">singleElementGroup</a></span> | <span class="prod"><a class="grammarRef" href="#prod-multiElementGroup">multiElementGroup</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-singleElementGroup">[<span class="prodNo">41</span>]   </td>
<td><code class="production prod">singleElementGroup</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-unaryTripleExpr">unaryTripleExpr</a></span> ';'?</code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-multiElementGroup">[<span class="prodNo">42</span>]   </td>
<td><code class="production prod">multiElementGroup</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-unaryTripleExpr">unaryTripleExpr</a></span> (';' <span class="prod"><a class="grammarRef" href="#prod-unaryTripleExpr">unaryTripleExpr</a></span>)+ ';'?</code></td>
</tr>
<tr class="params"><td></td><td colspan="3">
If the right <a class="grammarRef" href="#prod-unaryTripleExpr">unaryTripleExpr</a> matches one or more times, the result is a <a class="obj internalDFN" href="#dfn-eachof" data-link-type="dfn">EachOf</a> object with <span class="param">expressions</span> containing the first <a class="grammarRef" href="#prod-unaryTripleExpr">unaryTripleExpr</a> followed by the ordered list from the second <a class="grammarRef" href="#prod-unaryTripleExpr">unaryTripleExpr</a>:
</td></tr>
<tr class="obj"><td></td><td class="obj"><a href="#dfn-eachof" class="internalDFN" data-link-type="dfn">EachOf</a></td>                       <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a>? <span class="param">expressions</span>:[<a class="nobref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>{2,}] <span class="param">min</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">max</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
<tr class="params"><td></td><td colspan="3">
otherwise the result is the left <a class="grammarRef" href="#prod-unaryTripleExpr">unaryTripleExpr</a>.
</td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-unaryTripleExpr">[<span class="prodNo">43</span>]   </td>
<td><code class="production prod">unaryTripleExpr</code></td>
<td>   ::=   </td>
<td>   <code class="content">('$' <span class="prod"><a class="grammarRef" href="#prod-tripleExprLabel">tripleExprLabel</a></span>)? (<span class="prod"><a class="grammarRef" href="#prod-tripleConstraint">tripleConstraint</a></span> | <span class="prod"><a class="grammarRef" href="#prod-bracketedTripleExpr">bracketedTripleExpr</a></span>)<br />
| <span class="prod"><a class="grammarRef" href="#prod-include">include</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-bracketedTripleExpr">[<span class="prodNo">44</span>]   </td>
<td><code class="production prod">bracketedTripleExpr</code></td>
<td>   ::=   </td>
<td><code class="content">'(' <span class="prod"><a class="grammarRef" href="#prod-tripleExpression">tripleExpression</a></span> ')' <span class="prod"><a class="grammarRef" href="#prod-cardinality">cardinality</a></span>? <span class="prod"><a class="grammarRef" href="#prod-annotation">annotation</a></span>* <span class="prod"><a class="grammarRef" href="#prod-semanticActions">semanticActions</a></span></code></td>
</tr>
</tbody>

<tbody class="grammarParagraph">
  <tr><td colspan="4">
    <p>
      Triple constraints are matched against RDF triples.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-tripleConstraint">[<span class="prodNo">45</span>]   </td>
<td><code class="production prod">tripleConstraint</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-senseFlags">senseFlags</a></span>? <span class="prod"><a class="grammarRef" href="#prod-predicate">predicate</a></span> <span class="prod"><a class="grammarRef" href="#prod-inlineShapeExpression">inlineShapeExpression</a></span> <span class="prod"><a class="grammarRef" href="#prod-cardinality">cardinality</a></span>? <span class="prod"><a class="grammarRef" href="#prod-annotation">annotation</a></span>* <span class="prod"><a class="grammarRef" href="#prod-semanticActions">semanticActions</a></span></code></td>
</tr>
<tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-tripleconstraint" data-link-type="dfn">TripleConstraint</a></td><td>{</td><td><span class="param">id</span>:<a href="#dfn-tripleexprlabel" class="internalDFN" data-link-type="dfn">tripleExprLabel</a>? <span class="param">inverse</span>:<a href="#dfn-bool" class="internalDFN" data-link-type="dfn">BOOL</a>? <span class="param">predicate</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> <span class="param">valueExpr</span>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>? <span class="param">min</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">max</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>

  <tr class="params"><td></td><td colspan="3"><ul>
  <li><span class="param">inverse</span> is true if the <span class="prod"><a class="grammarRef" href="#prod-senseFlags">senseFlags</a></span> matched "<code>^</code>".</li>
  <li><a class="param" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a> comes from the <a class="grammarRef" href="#prod-predicate">predicate</a> production.</li>
  <li><span class="param">valueExpr</span> comes from the <a class="grammarRef" href="#prod-inlineShapeExpression">inlineShapeExpression</a> production. It it is an empty shape <code>{"type": "Shape"}</code>, <span class="param">valueExpr</span> is not assigned.</li>
  <li><span class="param">min</span> comes from the <a class="grammarRef" href="#prod-cardinality">cardinality</a> production.</li>
  <li><span class="param">max</span> comes from the <a class="grammarRef" href="#prod-cardinality">cardinality</a> production.</li>
  <li><span class="param">annotations</span> is the set of <a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>s matching the <span class="prod"><a class="grammarRef" href="#prod-annotation">annotation</a></span> production.</li>
  <li><span class="param">semActs</span> is the set of semantic actions matching the <span class="prod"><a class="grammarRef" href="#prod-semanticActions">semanticActions</a></span> production.</li>

</ul>
  </td></tr>
<tr style="vertical-align: baseline">
<td id="prod-cardinality">[<span class="prodNo">46</span>]   </td>
<td><code class="production prod">cardinality</code></td>
<td>   ::=   </td>
<td><code class="content">'*' | '+' | '?' | <span class="prod"><a class="grammarRef" href="#term-REPEAT_RANGE">REPEAT_RANGE</a></span></code></td>
</tr>
<tr class="params"><td></td><td colspan="3">
  In <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a>, <code>"*"</code> is represented as <code>-1</code>, standing for the unbounded cardinality..
</td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-senseFlags">[<span class="prodNo">47</span>]   </td>
<td><code class="production prod">senseFlags</code></td>
<td>   ::=   </td>
<td><code class="content">'^'</code></td>
</tr>
</tbody>

<tbody class="grammarParagraph">
  <tr><td colspan="4">
    <p>
      Value sets identify ranges of RDF nodes by explicit inclusion or by range (indicated by "<code>~</code>").
      Ranges may include exclusions, which may also be ranges but must not in turn contain exclusions.
      A <a class="param internalDFN" href="#dfn-valuesetvalue" data-link-type="dfn">valueSetValue</a> may be an <a class="param internalDFN" href="#dfn-objectvalue" data-link-type="dfn">objectValue</a> or one of <a class="param internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a>, <a class="param internalDFN" href="#dfn-iristemrange" data-link-type="dfn">IriStemRange</a>, <a class="param internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a>, <a class="param internalDFN" href="#dfn-literalstemrange" data-link-type="dfn">LiteralStemRange</a>, <a class="param internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a>, <a class="param internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a>, .
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-valueSet">[<span class="prodNo">48</span>]   </td>
<td><code class="production prod">valueSet</code></td>
<td>   ::=   </td>
<td><code class="content">'[' <span class="prod"><a class="grammarRef" href="#prod-valueSetValue">valueSetValue</a></span>* ']'</code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-valueSetValue">[<span class="prodNo">49</span>]   </td>
<td><code class="production prod">valueSetValue</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-iriRange">iriRange</a></span> | <span class="prod"><a class="grammarRef" href="#prod-literalRange">literalRange</a></span> | <span class="prod"><a class="grammarRef" href="#prod-languageRange">languageRange</a></span><br />
| <span class="prod"><a class="grammarRef" href="#prod-exclusion">exclusion</a></span>+</code></td>
</tr>
  <tr class="params"><td></td><td colspan="3">If "<code>.</code>" matches and <span class="prod"><a class="grammarRef" href="#prod-exclusion">exclusion</a></span> matches one or more times, all matched items must be consistently iri, literal, or language. <code class="production prod">valueSetValue</code> returns either a <a class="obj internalDFN" href="#dfn-iristemrange" data-link-type="dfn">IriStemRange</a>, <a class="obj internalDFN" href="#dfn-literalstemrange" data-link-type="dfn">LiteralStemRange</a>, or <a class="obj internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a> object with <span class="param">exclusions</span> equal to the set of results of <span class="prod"><a class="grammarRef" href="#prod-exclusion">exclusion</a></span>:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-iristemrange" data-link-type="dfn">IriStemRange</a></td><td>{</td><td><span class="param">stem</span>:(<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-iriref" data-link-type="dfn">IRIREF</a>|<a class="objref internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a> +] }</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-literalstemrange" data-link-type="dfn">LiteralStemRange</a></td><td>{</td><td><span class="param">stem</span>:(<a class="nobref internalDFN" href="#dfn-string" data-link-type="dfn">STRING</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-string" data-link-type="dfn">STRING</a>|<a class="objref internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a> +] }</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a></td><td>{</td><td><span class="param">stem</span>:(<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-langtag" data-link-type="dfn">LANGTAG</a>|<a class="objref internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a> +] }</td></tr>
  <tr class="params"><td></td><td colspan="3">If "<code>~</code>" matches with no <span class="prod"><a class="grammarRef" href="#prod-exclusion">exclusion</a></span>, <code class="production prod">valueSetValue</code> returns a <a class="obj internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a> object:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a></td><td>{</td><td><span class="comment">/* empty */</span> }</td></tr>

<tr style="vertical-align: baseline">
<td id="prod-exclusion">[<span class="prodNo">50</span>]   </td>
<td><code class="production prod">exclusion</code></td>
<td>   ::=   </td>
<td><code class="content">'.' '-' (<span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> | <span class="prod"><a class="grammarRef" href="#prod-literal">literal</a></span> | <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span>) '~'?</code></td>
</tr>

<tr style="vertical-align: baseline">
<td id="prod-iriRange">[<span class="prodNo">51</span>]   </td>
<td><code class="production prod">iriRange</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> ('~' <span class="prod"><a class="grammarRef" href="#prod-exclusion">exclusion</a></span>*)?</code></td>
</tr>
  <tr class="params"><td></td><td colspan="3">If <span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> matches with no "<code>~</code>", iriRange returns <span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span>.</td></tr>
  <tr class="params"><td></td><td colspan="3">If <span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> and "<code>~</code>" match with no <span class="prod"><a class="grammarRef" href="#prod-iriExclusion">iriExclusion</a></span>, iriRange returns a <a class="obj internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a> object:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a></td><td>{</td><td><span class="param">stem</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> }</td></tr>
  <tr class="params"><td></td><td colspan="3">If <span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> and "<code>~</code>" match and <span class="prod"><a class="grammarRef" href="#prod-iriExclusion">iriExclusion</a></span> matches one or more times, iriRange returns a <a class="obj internalDFN" href="#dfn-iristemrange" data-link-type="dfn">IriStemRange</a> object with <span class="param">exclusions</span> equal to the set of results of <span class="prod"><a class="grammarRef" href="#prod-iriExclusion">iriExclusion</a></span>:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-iristemrange" data-link-type="dfn">IriStemRange</a></td><td>{</td><td><span class="param">stem</span>:(<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-iriref" data-link-type="dfn">IRIREF</a>|<a class="objref internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a> +] }</td></tr>

<tr style="vertical-align: baseline">
<td id="prod-iriExclusion">[<span class="prodNo">52</span>]   </td>
<td><code class="production prod">iriExclusion</code></td>
<td>   ::=   </td>
<td><code class="content">'-' <span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> '~'?</code></td>
</tr>

<tr style="vertical-align: baseline">
<td id="prod-literalRange">[<span class="prodNo">53</span>]   </td>
<td><code class="production prod">literalRange</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#prod-literal">literal</a></span> ('~' <span class="prod"><a class="grammarRef" href="#prod-literalExclusion">literalExclusion</a></span>*)?</code></td>
</tr>
  <tr class="params"><td></td><td colspan="3">If <span class="prod"><a class="grammarRef" href="#prod-literal">literal</a></span> matches with no "<code>~</code>", literalRange returns <span class="prod"><a class="grammarRef" href="#prod-literal">literal</a></span>.</td></tr>
  <tr class="params"><td></td><td colspan="3">If <span class="prod"><a class="grammarRef" href="#prod-literal">literal</a></span> and "<code>~</code>" match with no <span class="prod"><a class="grammarRef" href="#prod-literalExclusion">literalExclusion</a></span>, literalRange returns a <a class="obj internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a> object:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a></td><td>{</td><td><span class="param">stem</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a> }</td></tr>
  <tr class="params"><td></td><td colspan="3">If <span class="prod"><a class="grammarRef" href="#prod-literal">literal</a></span> and "<code>~</code>" match and <span class="prod"><a class="grammarRef" href="#prod-literalExclusion">literalExclusion</a></span> matches one or more times, literalRange returns a <a class="obj internalDFN" href="#dfn-literalstemrange" data-link-type="dfn">LiteralStemRange</a> object with <span class="param">exclusions</span> equal to the set of results of <span class="prod"><a class="grammarRef" href="#prod-literalExclusion">literalExclusion</a></span>:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-literalstemrange" data-link-type="dfn">LiteralStemRange</a></td><td>{</td><td><span class="param">stem</span>:(<a class="nobref internalDFN" href="#dfn-string" data-link-type="dfn">STRING</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-string" data-link-type="dfn">STRING</a>|<a class="objref internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a> +] }</td></tr>

<tr style="vertical-align: baseline">
<td id="prod-literalExclusion">[<span class="prodNo">54</span>]   </td>
<td><code class="production prod">literalExclusion</code></td>
<td>   ::=   </td>
<td><code class="content">'-' <span class="prod"><a class="grammarRef" href="#prod-literal">literal</a></span> '~'?</code></td>
</tr>

<tr style="vertical-align: baseline">
<td id="prod-languageRange">[<span class="prodNo">55</span>]   </td>
<td><code class="production prod">languageRange</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span> ('~' <span class="prod"><a class="grammarRef" href="#prod-languageExclusion">languageExclusion</a></span>*)?<br />
| <span class="prod">'@' '~' <span class="prod"><a class="grammarRef" href="#prod-languageExclusion">languageExclusion</a></span>*</span></code></td>
</tr>
  <tr class="params"><td></td><td colspan="3">If <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span> matches with no "<code>~</code>" match , languageRange returns a <a class="obj internalDFN" href="#dfn-language" data-link-type="dfn">Language</a> object with <span class="param">languageTag</span> equal to <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span>:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-language" data-link-type="dfn">Language</a></td><td>{</td><td><span class="param">languageTag</span>:<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> }</td></tr>
  <tr class="params"><td></td><td colspan="3">If <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span> and "<code>~</code>" match with no <span class="prod"><a class="grammarRef" href="#prod-languageExclusion">languageExclusion</a></span>, languageRange returns a <a class="obj internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a> object:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a></td><td>{</td><td><span class="param">stem</span>:<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> }</td></tr>
  <tr class="params"><td></td><td colspan="3">If <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span> and "<code>~</code>" match and <span class="prod"><a class="grammarRef" href="#prod-languageExclusion">languageExclusion</a></span> matches one or more times, languageRange returns a <a class="obj internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a> object with <span class="param">exclusions</span> equal to the set of results of <span class="prod"><a class="grammarRef" href="#prod-languageExclusion">languageExclusion</a></span>:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a></td><td>{</td><td><span class="param">stem</span>:(<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-langtag" data-link-type="dfn">LANGTAG</a>|<a class="objref internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a> +] }</td></tr>

  <tr class="params"><td></td><td colspan="3">If '@' '~' matched with no <span class="prod"><a class="grammarRef" href="#prod-languageExclusion">languageExclusion</a></span>, languageRange returns a <a class="obj internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a> object with an empty <span class="param">stem</span>:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a></td><td>{</td><td><span class="param">stem</span>: "" }</td></tr>
  <tr class="params"><td></td><td colspan="3">If '@' '~' matched and <span class="prod"><a class="grammarRef" href="#prod-languageExclusion">languageExclusion</a></span> matches one or more times, languageRange returns a <a class="obj internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a> object with an empty <span class="param">stem</span> ad <span class="param">exclusions</span> equal to the set of results of <span class="prod"><a class="grammarRef" href="#prod-languageExclusion">languageExclusion</a></span>:</td></tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a></td><td>{</td><td><span class="param">stem</span>: "" <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-langtag" data-link-type="dfn">LANGTAG</a>|<a class="objref internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a> +] }</td></tr>

<tr style="vertical-align: baseline">
<td id="prod-languageExclusion">[<span class="prodNo">56</span>]   </td>
<td><code class="production prod">languageExclusion</code></td>
<td>   ::=   </td>
<td><code class="content">'-' <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span> '~'?</code></td>
</tr>

</tbody>

<tbody class="grammarParagraph">
  <tr><td colspan="4">
    <p>
      Triple expressions can include the <span class="prod"><a class="grammarRef" href="#prod-shapeExpression">shapeExpression</a></span> in a <span class="prod"><a class="grammarRef" href="#prod-shapeExprDecl">shapeExprDecl</a></span>.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-include">[<span class="prodNo">57</span>]   </td>
<td><code class="production prod">include</code></td>
<td>   ::=   </td>
<td><code class="content">'&amp;' <span class="prod"><a class="grammarRef" href="#prod-tripleExprLabel">tripleExprLabel</a></span></code></td>
</tr>
  <tr class="params"><td></td><td colspan="3">Per the <a href="#tripleExprRef-requirement">triple expression refrence requirement</a>, <span class="param">tripleExprLabel</span> property <em class="rfc2119" title="MUST">MUST</em> appear in the schema's <a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a> map and the corresponding <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expression</a> <em class="rfc2119" title="MUST">MUST</em> be a <span class="jobjref"><a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a></span> with a <span class="param">tripleExpr</span>.</td></tr>
<tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-tripleexprref" data-link-type="dfn">tripleExprRef</a></td><td>=</td><td><a class="nobref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a> ;</td></tr>
</tbody>

<tbody class="grammarParagraph">
  <tr class="borderHack"><td></td><td colspan="3"></td></tr>
  <tr><td colspan="4">
    <p>
      Triple expressions can include annotations in the form of a tuple of a <span class="prod"><a class="grammarRef" href="#prod-predicate">predicate</a></span> and an <span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> or <span class="prod"><a class="grammarRef" href="#prod-literal">literal</a></span>.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-annotation">[<span class="prodNo">58</span>]   </td>
<td><code class="production prod">annotation</code></td>
<td>   ::=   </td>
<td><code class="content">"//" <span class="prod"><a class="grammarRef" href="#prod-predicate">predicate</a></span> (<span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> | <span class="prod"><a class="grammarRef" href="#prod-literal">literal</a></span>)</code></td>
</tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a></td><td>{</td><td><a class="param" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> <span class="param">object</span>:<a class="nobref internalDFN" href="#dfn-objectvalue" data-link-type="dfn">objectValue</a> }</td></tr>
</tbody>

<tbody class="grammarParagraph">
  <tr class="borderHack"><td></td><td colspan="3"></td></tr>
  <tr><td colspan="4">
    <p>
      Triple expressions can include semantic actions consisting of an <span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> and an optional code string.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-semanticActions">[<span class="prodNo">59</span>]   </td>
<td><code class="production prod">semanticActions</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-codeDecl">codeDecl</a></span>*</code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-codeDecl">[<span class="prodNo">60</span>]   </td>
<td><code class="production prod">codeDecl</code></td>
<td>   ::=   </td>
<td><code class="content">'%' <span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> (<span class="prod"><a class="grammarRef" href="#term-CODE">CODE</a></span> | '%')</code></td>
</tr>
  <tr class="obj"><td></td><td><a class="obj internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a></td><td>{</td><td><span class="param">name</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> <span class="param">code</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? }</td></tr>
</tbody>



<tbody class="grammarParagraph">
  <tr class="borderHack"><td></td><td colspan="3"></td></tr>
  <tr><td colspan="4">
    <p>
      The remaining productions come from the specifications for SPARQL and Turtle.
    </p>
  </td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-literal">[<span class="prodNo">13t</span>]   </td>
<td><code class="production prod">literal</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-rdfLiteral">rdfLiteral</a></span> | <span class="prod"><a class="grammarRef" href="#prod-numericLiteral">numericLiteral</a></span> | <span class="prod"><a class="grammarRef" href="#prod-booleanLiteral">booleanLiteral</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-predicate">[<span class="prodNo">61</span>]   </td>
<td><code class="production prod">predicate</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> | <span class="prod"><a class="grammarRef" href="#term-RDF_TYPE">RDF_TYPE</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-datatype">[<span class="prodNo">62</span>]   </td>
<td><code class="production prod">datatype</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-shapeExprLabel">[<span class="prodNo">63</span>]   </td>
<td><code class="production prod">shapeExprLabel</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> | <span class="prod"><a class="grammarRef" href="#prod-blankNode">blankNode</a></span></code></td>
</tr>
<tr style="vertical-align: baseline">
<td id="prod-tripleExprLabel">[<span class="prodNo">64</span>]   </td>
<td><code class="production prod">tripleExprLabel</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-iri">iri</a></span> | <span class="prod"><a class="grammarRef" href="#prod-blankNode">blankNode</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-numericLiteral">[<span class="prodNo">16t</span>]   </td>
<td><code class="production prod">numericLiteral</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#term-INTEGER">INTEGER</a></span> | <span class="prod"><a class="grammarRef" href="#term-DECIMAL">DECIMAL</a></span> | <span class="prod"><a class="grammarRef" href="#term-DOUBLE">DOUBLE</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-rdfLiteral">[<span class="prodNo">65</span>]   </td>
<td><code class="production prod">rdfLiteral</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#prod-langString">langString</a></span> | <span class="prod"><a class="grammarRef" href="#prod-string">string</a></span> ("^^" <span class="prod"><a class="grammarRef" href="#prod-datatype">datatype</a></span>)?</code></td>
</tr>
    <tr id="handle-RDFLiteral" class="params"><td></td><td>returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">            literal     </a></td><td></td><td>The literal has a lexical form of the first rule argument, <code>String</code>. If the <code>'^^' iri</code> rule matched, the datatype is <code>iri</code> and the literal has no <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a>. If the <code>langString</code> rule matched, the datatype is <code>rdf:langString</code> and the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a> is extracted from <code>langTag</code>. If neither matched, the datatype is <code>xsd:string</code> and the literal has no <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a>.</td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-booleanLiteral">[<span class="prodNo">134s</span>]   </td>
<td><code class="production prod">booleanLiteral</code></td>
<td>   ::=   </td>
<td><code class="content">"true" | "false"</code></td>
</tr>
    <tr id="handle-BooleanLiteral" class="params"><td></td><td>returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">            literal     </a></td><td></td><td>The literal has a lexical form of the <code>true</code> or <code>false</code>, depending on which matched the input, and a datatype of <code>xsd:boolean</code>.</td></tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-string">[<span class="prodNo">135s</span>]   </td>
<td><code class="production prod">string</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#term-STRING_LITERAL1">STRING_LITERAL1</a></span> | <span class="prod"><a class="grammarRef" href="#term-STRING_LITERAL_LONG1">STRING_LITERAL_LONG1</a></span><br />
| <span class="prod"><a class="grammarRef" href="#term-STRING_LITERAL2">STRING_LITERAL2</a></span> | <span class="prod"><a class="grammarRef" href="#term-STRING_LITERAL_LONG2">STRING_LITERAL_LONG2</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-langString">[<span class="prodNo">66</span>]   </td>
<td><code class="production prod">langString</code></td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#term-LANG_STRING_LITERAL1">LANG_STRING_LITERAL1</a></span> | <span class="prod"><a class="grammarRef" href="#term-LANG_STRING_LITERAL_LONG1">LANG_STRING_LITERAL_LONG1</a></span><br />
| <span class="prod"><a class="grammarRef" href="#term-LANG_STRING_LITERAL2">LANG_STRING_LITERAL2</a></span> | <span class="prod"><a class="grammarRef" href="#term-LANG_STRING_LITERAL_LONG2">LANG_STRING_LITERAL_LONG2</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-iri">[<span class="prodNo">136s</span>]   </td>
<td><code class="production prod">iri</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#term-IRIREF">IRIREF</a></span> | <span class="prod"><a class="grammarRef" href="#prod-prefixedName">prefixedName</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-prefixedName">[<span class="prodNo">137s</span>]   </td>
<td><code class="production prod">prefixedName</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#term-PNAME_LN">PNAME_LN</a></span> | <span class="prod"><a class="grammarRef" href="#term-PNAME_NS">PNAME_NS</a></span></code></td>
</tr>
</tbody>

<tbody class="prod">
<tr style="vertical-align: baseline">
<td id="prod-blankNode">[<span class="prodNo">138s</span>]   </td>
<td><code class="production prod">blankNode</code></td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#term-BLANK_NODE_LABEL">BLANK_NODE_LABEL</a></span></code></td>
</tr>
</tbody>

<tbody class="grammarParagraph">
  <tr><td colspan="4">
    <h2 id="terminals">Terminals<a class="self-link" aria-label="§" href="#terminals"></a></h2>
    <p>
      Terminals return:
    </p>
    <ul>
      <li>the RDF abstract types <a class="math" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a>, <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">lexical form</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a>, <dfn data-dfn-type="dfn" id="dfn-language-tag" data-no-export=""><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a></dfn>.</li>
      <li>a string of unicode codepoints for <a href="#term-CODE">CODE</a>.</li>
      <li>a <code>repeat range</code> for <a href="#term-REPEAT_RANGE">REPEAT_RANGE</a>. A <code>repeat range</code> is a tuple of non-negative integers or a non-negative integer and a token for <code>*</code>.</li>
    </ul>
  </td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-CODE">[<span class="prodNo">67</span>]   </td>
<td>&lt;<code class="production term">CODE</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"{" ([^%\\] | "\\" [%\\] | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>)* "%" "}"</code></td>
</tr>
    <tr id="handle-IRIREF-2" class="params"><td></td><td>returns: a string of unicode codepoints</td><td></td><td>The characters between "{" and "%}" are taken, with the <a href="https://www.w3.org/TR/turtle/#numeric">numeric escape sequences</a> unescaped, to form the unicode string of the IRI.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-REPEAT_RANGE">[<span class="prodNo">68</span>]   </td>
<td>&lt;<code class="production term">REPEAT_RANGE</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"{" <span class="prod"><a class="grammarRef" href="#term-INTEGER">INTEGER</a></span> ( "," (<span class="prod"><a class="grammarRef" href="#term-INTEGER">INTEGER</a></span> | "*")? )? "}"</code></td>
</tr>
    <tr id="handle-REPEAT_RANGE" class="params"><td></td><td>returns: repeat range</td><td></td><td>The base-10 numeric values of <span class="prod"><a class="grammarRef" href="#term-INTEGER">INTEGER</a></span> are taken or a non-negative integer and an <code>*</code> token if "<code>*</code>" was matched.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-RDF_TYPE">[<span class="prodNo">69</span>]   </td>
<td>&lt;<code class="production term">RDF_TYPE</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"a"</code></td>
</tr>
    <tr id="handle-RDF_TYPE" class="params"><td></td><td> returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">      IRI </a></td><td></td><td>The <code>iri</code> <code>http://www.w3.org/1999/02/22-rdf-syntax-ns#</code> is returned.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-IRIREF">[<span class="prodNo">18t</span>]   </td>
<td>&lt;<code class="production term">IRIREF</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"&lt;" ([^#0000- &lt;&gt;\"{}|^`\\] | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>)* "&gt;"</code></td>
</tr>
    <tr id="handle-IRIREF" class="params"><td></td><td>returns: <a class="math" data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a></td><td></td><td>The characters between "&lt;" and "&gt;" are taken, with the <a href="https://www.w3.org/TR/turtle/#numeric">numeric escape sequences</a> unescaped, to form the unicode string of the IRI. Relative IRI resolution is performed per Turtle <a class="sectionRef" href="https://www.w3.org/TR/turtle/#sec-iri-references">Section 6.3</a>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PNAME_NS">[<span class="prodNo">140s</span>]   </td>
<td>&lt;<code class="production term">PNAME_NS</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#term-PN_PREFIX">PN_PREFIX</a></span>? ":"</code></td>
</tr>
    <tr id="handle-PNAME_NS" class="params"><td></td><td>returns: <a href="#dfn-prefixes-map" class="internalDFN" data-link-type="dfn">                                 PREFIX      </a></td><td></td><td>When used in a <a href="#prod-prefixDecl">prefixDecl</a> production, the <a href="#dfn-prefixes-map" class="internalDFN" data-link-type="dfn">prefix</a> is a potentially empty unicode string matching the first argument of the rule and serves as a key into the <a href="#dfn-prefixes-map" class="internalDFN" data-link-type="dfn">prefixes map</a>.</td></tr>
    <tr id="handle-PNAME_NS2" class="params"><td></td><td> returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">      IRI </a></td><td></td><td>When used elsewhere, the <code>iri</code> is the value in the <a href="#dfn-prefixes-map" class="internalDFN" data-link-type="dfn">prefixes map</a> corresponding to the first argument of the rule.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PNAME_LN">[<span class="prodNo">141s</span>]   </td>
<td>&lt;<code class="production term">PNAME_LN</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#term-PNAME_NS">PNAME_NS</a></span> <span class="prod"><a class="grammarRef" href="#term-PN_LOCAL">PN_LOCAL</a></span></code></td>
</tr>
    <tr id="handle-PNAME_LN" class="params"><td></td><td>returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">      IRI         </a></td><td></td><td>A potentially empty <a href="#dfn-prefixes-map" class="internalDFN" data-link-type="dfn">prefix</a> is identified by the first token, <code>PNAME_NS</code>. The <a href="#dfn-prefixes-map" class="internalDFN" data-link-type="dfn">prefixes map</a> <em class="rfc2119"><em class="rfc2119" title="MUST"><em class="rfc2119" title="MUST">MUST</em></em></em> have a corresponding <code>namespace</code>. The unicode string of the IRI is formed by unescaping the <a href="https://tools.ietf.org/html/rfc3987#page-9">reserved characters</a> [<cite><a class="bibref" href="#bib-rfc7159" title="The JavaScript Object Notation (JSON) Data Interchange Format" data-link-type="biblio">rfc7159</a></cite>] in the second argument, <code>PN_LOCAL</code>, and concatenating this onto the <code>namespace</code>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-ATPNAME_NS">[<span class="prodNo">70</span>]   </td>
<td>&lt;<code class="production term">ATPNAME_NS</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"@" <span class="prod"><a class="grammarRef" href="#term-PNAME_NS">PNAME_NS</a></span></code></td>
</tr>
    <tr id="handle-ATPNAME_NS" class="params"><td></td><td> returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">      IRI </a></td><td></td><td>The <code>iri</code> is the value in the <a href="#dfn-prefixes-map" class="internalDFN" data-link-type="dfn">prefixes map</a> corresponding to the second token of the rule.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-ATPNAME_LN">[<span class="prodNo">71</span>]   </td>
<td>&lt;<code class="production term">ATPNAME_LN</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"@" <span class="prod"><a class="grammarRef" href="#term-PNAME_LN">PNAME_LN</a></span></code></td>
</tr>
    <tr id="handle-ATPNAME_LN" class="params"><td></td><td>returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">      IRI         </a></td><td></td><td>A potentially empty <a href="#dfn-prefixes-map" class="internalDFN" data-link-type="dfn">prefix</a> is identified by the second token, <code>PNAME_NS</code>. The <a href="#dfn-prefixes-map" class="internalDFN" data-link-type="dfn">prefixes map</a> <em class="rfc2119"><em class="rfc2119" title="MUST"><em class="rfc2119" title="MUST">MUST</em></em></em> have a corresponding <code>namespace</code>. The unicode string of the IRI is formed by unescaping the <a href="https://tools.ietf.org/html/rfc3987#page-9">reserved characters</a> [<cite><a class="bibref" href="#bib-rfc7159" title="The JavaScript Object Notation (JSON) Data Interchange Format" data-link-type="biblio">rfc7159</a></cite>] in the third token, <code>PN_LOCAL</code>, and concatenating this onto the <code>namespace</code>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-REGEXP">[<span class="prodNo">72</span>]   </td>
<td>&lt;<code class="production term">REGEXP</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">'/' ([^/\\\n\r]<br />
     | '\\' [nrt\\|.?*+(){}$-\[\]^/]<br />
     | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span><br />
    )+ '/' [smix]*</code></td>
</tr>
<tr class="obj"><td></td><td></td><td>{</td><td><span class="param">pattern</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a> <span class="param">flags</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? }</td></tr>
    <tr id="handle-REGEXP" class="params"><td></td><td>returns: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-terms-and-definitions-object">JSON object</a></td><td></td><td><span class="param">pattern</span> is a unicode string formed from the characters between the outermost '/'s by unescaping matches of '\\' '/' in the terminal pattern as well as the <a href="https://www.w3.org/TR/turtle/#numeric">numeric escape sequences</a> matched by <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>.
    The remaining escape sequences are included verbatim in <span class="param">pattern</span>, e.g. <div class="inline shexc"><pre aria-busy="false"><code class="hljs">^\/\t\\\U0001D4B8$</code></pre></div> would become <div class="inline json"><pre aria-busy="false"><code class="hljs">^/\t\\\U0001D4B8$</code></pre></div>.<br />
<span class="param">flags</span> is a sequence of the characters [smix] if any were matched. Otherwise no <span class="param">flags</span> attribute is returned.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-BLANK_NODE_LABEL">[<span class="prodNo">142s</span>]   </td>
<td>&lt;<code class="production term">BLANK_NODE_LABEL</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"_:" (<span class="prod"><a class="grammarRef" href="#term-PN_CHARS_U">PN_CHARS_U</a></span> | [0-9]) ((<span class="prod"><a class="grammarRef" href="#term-PN_CHARS">PN_CHARS</a></span> | ".")* <span class="prod"><a class="grammarRef" href="#term-PN_CHARS">PN_CHARS</a></span>)?</code></td>
</tr>
    <tr id="handle-BLANK_NODE_LABEL" class="params"><td></td><td>returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a></td><td></td><td>The characters following the "<code>_:</code>" form a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>. This corresponds to any <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a> in the input dataset that had the same label.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-LANGTAG">[<span class="prodNo">145s</span>]   </td>
<td>&lt;<code class="production term">LANGTAG</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"@" ([a-zA-Z])+ ("-" ([a-zA-Z0-9])+)*</code></td>
</tr>
    <tr id="handle-LANGTAG" class="params"><td></td><td>returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a></td><td></td><td>The characters following the <code>@</code> form the unicode string of the <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag">language tag</a>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-INTEGER">[<span class="prodNo">19t</span>]   </td>
<td>&lt;<code class="production term">INTEGER</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">[+-]? [0-9]+</code></td>
</tr>
    <tr id="handle-INTEGER" class="params"><td></td><td>returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">            literal     </a></td><td></td><td>The literal has a lexical form of the input string, and a datatype of <code>xsd:integer</code>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-DECIMAL">[<span class="prodNo">20t</span>]   </td>
<td>&lt;<code class="production term">DECIMAL</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">[+-]? [0-9]* "." [0-9]+</code></td>
</tr>
    <tr id="handle-DECIMAL" class="params"><td></td><td>returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">            literal     </a></td><td></td><td>The literal has a lexical form of the input string, and a datatype of <code>xsd:double</code>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-DOUBLE">[<span class="prodNo">21t</span>]   </td>
<td>&lt;<code class="production term">DOUBLE</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">[+-]? ([0-9]+ "." [0-9]* <span class="prod"><a class="grammarRef" href="#term-EXPONENT">EXPONENT</a></span> | "."? [0-9]+ <span class="prod"><a class="grammarRef" href="#term-EXPONENT">EXPONENT</a></span>)</code></td>
</tr>
    <tr id="handle-DOUBLE" class="params"><td></td><td>returns: <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">            literal     </a></td><td></td><td>The literal has a lexical form of the input string, and a datatype of <code>xsd:double</code>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-EXPONENT">[<span class="prodNo">155s</span>]   </td>
<td>&lt;<code class="production term">EXPONENT</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">[eE] [+-]? [0-9]+</code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-STRING_LITERAL1">[<span class="prodNo">156s</span>]   </td>
<td>&lt;<code class="production term">STRING_LITERAL1</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"'" ([^'\\\n\r] | <span class="prod"><a class="grammarRef" href="#term-ECHAR">ECHAR</a></span> | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>)* "'"</code></td>
</tr>
    <tr id="handle-STRING_LITERAL1" class="params"><td></td><td>returns: <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">                         lexical form</a></td><td></td><td>The characters between the outermost "'"s   are taken, with <a href="https://www.w3.org/TR/turtle/#numeric">numeric</a> and <a href="https://www.w3.org/TR/turtle/#string">string</a> escape sequences unescaped, to form the unicode string of a lexical form.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-STRING_LITERAL2">[<span class="prodNo">157s</span>]   </td>
<td>&lt;<code class="production term">STRING_LITERAL2</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">'"' ([^\"\\\n\r] | <span class="prod"><a class="grammarRef" href="#term-ECHAR">ECHAR</a></span> | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>)* '"'</code></td>
</tr>
    <tr id="handle-STRING_LITERAL2" class="params"><td></td><td>returns: <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">                         lexical form</a></td><td></td><td>The characters between the outermost '"'s   are taken, with <a href="https://www.w3.org/TR/turtle/#numeric">numeric</a> and <a href="https://www.w3.org/TR/turtle/#string">string</a> escape sequences unescaped, to form the unicode string of a lexical form.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-STRING_LITERAL_LONG1">[<span class="prodNo">158s</span>]   </td>
<td>&lt;<code class="production term">STRING_LITERAL_LONG1</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"'''" ( ("'" | "''")? ([^\\'\\] | <span class="prod"><a class="grammarRef" href="#term-ECHAR">ECHAR</a></span> | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>) )* "'''"</code></td>
</tr>
    <tr id="handle-STRING_LITERAL_LONG1" class="params"><td></td><td>returns: <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">                         lexical form</a></td><td></td><td>The characters between the outermost "'''"s are taken, with <a href="https://www.w3.org/TR/turtle/#numeric">numeric</a> and <a href="https://www.w3.org/TR/turtle/#string">string</a> escape sequences unescaped, to form the unicode string of a lexical form.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-STRING_LITERAL_LONG2">[<span class="prodNo">159s</span>]   </td>
<td>&lt;<code class="production term">STRING_LITERAL_LONG2</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">'"""' ( ('"' | '""')? ([^\"\\] | <span class="prod"><a class="grammarRef" href="#term-ECHAR">ECHAR</a></span> | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>) )* '"""'</code></td>
</tr>
    <tr id="handle-STRING_LITERAL_LONG2" class="params"><td></td><td>returns: <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">                         lexical form</a></td><td></td><td>The characters between the outermost '"""'s are taken, with <a href="https://www.w3.org/TR/turtle/#numeric">numeric</a> and <a href="https://www.w3.org/TR/turtle/#string">string</a> escape sequences unescaped, to form the unicode string of a lexical form.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-LANG_STRING_LITERAL1">[<span class="prodNo">73</span>]   </td>
<td>&lt;<code class="production term">LANG_STRING_LITERAL1</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"'" ([^'\\\n\r] | <span class="prod"><a class="grammarRef" href="#term-ECHAR">ECHAR</a></span> | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>)* "'" <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span></code></td>
</tr>
    <tr id="handle-LANG_STRING_LITERAL1" class="params"><td></td><td>returns: <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">                         lexical form</a></td><td></td><td>The characters between the outermost "'"s   are taken, with <a href="https://www.w3.org/TR/turtle/#numeric">numeric</a> and <a href="https://www.w3.org/TR/turtle/#string">string</a> escape sequences unescaped, to form the unicode string of a lexical form. The trailing <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span> is used to create a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-LANG_STRING_LITERAL2">[<span class="prodNo">74</span>]   </td>
<td>&lt;<code class="production term">LANG_STRING_LITERAL2</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">'"' ([^\"\\\n\r] | <span class="prod"><a class="grammarRef" href="#term-ECHAR">ECHAR</a></span> | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>)* '"' <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span></code></td>
</tr>
    <tr id="handle-LANG_STRING_LITERAL2" class="params"><td></td><td>returns: <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">                         lexical form</a></td><td></td><td>The characters between the outermost '"'s   are taken, with <a href="https://www.w3.org/TR/turtle/#numeric">numeric</a> and <a href="https://www.w3.org/TR/turtle/#string">string</a> escape sequences unescaped, to form the unicode string of a lexical form. The trailing <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span> is used to create a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-LANG_STRING_LITERAL_LONG1">[<span class="prodNo">75</span>]   </td>
<td>&lt;<code class="production term">LANG_STRING_LITERAL_LONG1</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"'''" ( ("'" | "''")? ([^\\'\\] | <span class="prod"><a class="grammarRef" href="#term-ECHAR">ECHAR</a></span> | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>) )* "'''" <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span></code></td>
</tr>
    <tr id="handle-LANG_STRING_LITERAL_LONG1" class="params"><td></td><td>returns: <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">                         lexical form</a></td><td></td><td>The characters between the outermost "'''"s are taken, with <a href="https://www.w3.org/TR/turtle/#numeric">numeric</a> and <a href="https://www.w3.org/TR/turtle/#string">string</a> escape sequences unescaped, to form the unicode string of a lexical form. The trailing <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span> is used to create a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-LANG_STRING_LITERAL_LONG2">[<span class="prodNo">76</span>]   </td>
<td>&lt;<code class="production term">LANG_STRING_LITERAL_LONG2</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">'"""' ( ('"' | '""')? ([^\"\\] | <span class="prod"><a class="grammarRef" href="#term-ECHAR">ECHAR</a></span> | <span class="prod"><a class="grammarRef" href="#term-UCHAR">UCHAR</a></span>) )* '"""' <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span></code></td>
</tr>
    <tr id="handle-LANG_STRING_LITERAL_LONG2" class="params"><td></td><td>returns: <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">                         lexical form</a></td><td></td><td>The characters between the outermost '"""'s are taken, with <a href="https://www.w3.org/TR/turtle/#numeric">numeric</a> and <a href="https://www.w3.org/TR/turtle/#string">string</a> escape sequences unescaped, to form the unicode string of a lexical form. The trailing <span class="prod"><a class="grammarRef" href="#term-LANGTAG">LANGTAG</a></span> is used to create a <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a>.</td></tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-UCHAR">[<span class="prodNo">26t</span>]   </td>
<td>&lt;<code class="production term">UCHAR</code>&gt;</td>
<td>   ::=   </td>
<td>   <code class="content">"\\u" <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span><br />
| "\\U" <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span></code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-ECHAR">[<span class="prodNo">160s</span>]   </td>
<td>&lt;<code class="production term">ECHAR</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"\\" [tbnrf\\\"\\']</code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PN_CHARS_BASE">[<span class="prodNo">164s</span>]   </td>
<td>&lt;<code class="production term">PN_CHARS_BASE</code>&gt;</td>
<td>   ::=   </td>
<td>   <code class="content">[A-Z] | [a-z]<br />
| [#00C0-#00D6] | [#00D8-#00F6] | [#00F8-#02FF]<br />
| [#0370-#037D] | [#037F-#1FFF]<br />
| [#200C-#200D] | [#2070-#218F] | [#2C00-#2FEF]<br />
| [#3001-#D7FF] | [#F900-#FDCF] | [#FDF0-#FFFD]<br />
| [#10000-#EFFFF]</code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PN_CHARS_U">[<span class="prodNo">165s</span>]   </td>
<td>&lt;<code class="production term">PN_CHARS_U</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#term-PN_CHARS_BASE">PN_CHARS_BASE</a></span> | "_"</code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PN_CHARS">[<span class="prodNo">167s</span>]   </td>
<td>&lt;<code class="production term">PN_CHARS</code>&gt;</td>
<td>   ::=   </td>
<td>   <code class="content"><span class="prod"><a class="grammarRef" href="#term-PN_CHARS_U">PN_CHARS_U</a></span> | "-" | [0-9]<br />
| [#00B7] | [#0300-#036F] | [#203F-#2040]</code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PN_PREFIX">[<span class="prodNo">168s</span>]   </td>
<td>&lt;<code class="production term">PN_PREFIX</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#term-PN_CHARS_BASE">PN_CHARS_BASE</a></span> ( (<span class="prod"><a class="grammarRef" href="#term-PN_CHARS">PN_CHARS</a></span> | ".")* <span class="prod"><a class="grammarRef" href="#term-PN_CHARS">PN_CHARS</a></span> )?</code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PN_LOCAL">[<span class="prodNo">77</span>]   </td>
<td>&lt;<code class="production term">PN_LOCAL</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">(<span class="prod"><a class="grammarRef" href="#term-PN_CHARS_U">PN_CHARS_U</a></span> | ":" | [0-9] | <span class="prod"><a class="grammarRef" href="#term-PLX">PLX</a></span>) (<span class="prod"><a class="grammarRef" href="#term-PN_CHARS">PN_CHARS</a></span> | "." | ":" | <span class="prod"><a class="grammarRef" href="#term-PLX">PLX</a></span>)* </code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PLX">[<span class="prodNo">170s</span>]   </td>
<td>&lt;<code class="production term">PLX</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content"><span class="prod"><a class="grammarRef" href="#term-PERCENT">PERCENT</a></span> | <span class="prod"><a class="grammarRef" href="#term-PN_LOCAL_ESC">PN_LOCAL_ESC</a></span></code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PERCENT">[<span class="prodNo">171s</span>]   </td>
<td>&lt;<code class="production term">PERCENT</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"%" <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span> <span class="prod"><a class="grammarRef" href="#term-HEX">HEX</a></span></code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-HEX">[<span class="prodNo">172s</span>]   </td>
<td>&lt;<code class="production term">HEX</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">[0-9] | [A-F] | [a-f]</code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PN_LOCAL_ESC">[<span class="prodNo">173s</span>]   </td>
<td>&lt;<code class="production term">PN_LOCAL_ESC</code>&gt;</td>
<td>   ::=   </td>
<td><code class="content">"\\" ( "_" | "~" | "." | "-" | "!" | "$" | "&amp;" | "'" | "(" | ")" | "*" | "+" | "," | ";" | "=" | "/" | "?" | "#" | "@" | "%" )</code></td>
</tr>
</tbody>

<tbody class="term">
<tr style="vertical-align: baseline">
<td id="term-PASSED_TOKENS">[<span class="prodNo">98</span>]   </td>
<td><code class="production directive">PASSED TOKENS</code></td>
<td>   ::=   </td>
<td>   <code class="content">[ \t\r\n]+<br />
| "#" [^\r\n]*<br />
| "/*" ([^*] | '*' ([^/] | '\\/'))* "*/"</code></td>
</tr>
</tbody>

</table>
      </div>
    </div>

    

    </section>

    <section id="shexj" class="appendix">
      <h2 id="a-shex-json-syntax-shexj"><bdi class="secno">A. </bdi>ShEx JSON Syntax (ShExJ)<a class="self-link" aria-label="§" href="#shexj"></a></h2>

      <p>
        This section aggregates the <a href="#dfn-json-grammar" class="internalDFN" data-link-type="dfn">JSON grammar</a> rules defined above and includes terminals referenced above.
      </p>

      <p>
        A ShExJ document is a JSON-LD [<cite><a class="bibref" href="#bib-json-ld" title="JSON-LD 1.0" data-link-type="biblio">JSON-LD</a></cite>] document which uses a proscribed structure to define a <a href="#dfn-shapes-schema" class="internalDFN" data-link-type="dfn">schema</a> containing <a href="#dfn-shape-expressions" class="internalDFN" data-link-type="dfn">shape expressions</a> and <a href="#dfn-triple-expressions" class="internalDFN" data-link-type="dfn">triple expressions</a>.
        A ShExJ document <em class="rfc2119" title="MAY">MAY</em> include an <code>@context</code> property referencing <code>http://www.w3.org/ns/shex.jsonld</code>.
        In the absense of a top-level <code>@context</code>, ShEx Processors <em class="rfc2119" title="MUST">MUST</em> act as if a <code>@context</code> property is present with the value <code>http://www.w3.org/ns/shex.jsonld</code>.
      </p>

      <p>
        A ShExJ document can also be thought of as the serialization of an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF Graph</a> using the Shape Expression Vocabulary [<cite><a class="bibref" href="#bib-shex-vocab" title="Shape Expression Vocabulary" data-link-type="biblio">shex-vocab</a></cite>] which conforms to the shape defined in <a href="#shexr" class="secionRef sec-ref">§ <bdi class="secno">B. </bdi>ShEx Shape</a>.
        Processors <em class="rfc2119" title="MAY">MAY</em> interpret a ShExJ document as an RDF Graph.
        Processors may also transform arbitrary RDF Graphs conforming to <a href="#shexr" class="secionRef sec-ref">§ <bdi class="secno">B. </bdi>ShEx Shape</a> into ShExJ using a mechanism not described within this specification.
      </p>

      <p>In ShExJ, the unbounded cardinality constraint is <code>-1</code>, rather than <code>"*"</code>.</p>

      <p>
        This is the complete grammar for <dfn data-dfn-type="dfn" id="dfn-shexj">ShExJ</dfn>.
      </p>
      <div class="shexjTable">
<table class="shexj">

  <tbody><tr class="obj"><th class="obj"><a href="#dfn-shapes-schema" class="internalDFN" data-link-type="dfn">Schema</a></th><td>{</td><td><dfn class="param" data-lt="prefixes map|prefix" data-dfn-type="dfn" id="dfn-prefixes-map"></dfn>"@context": "http://www.w3.org/ns/shex.jsonld"<br /><span class="param">startActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <a class="param internalDFN" href="#dfn-start" data-link-type="dfn">start</a>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>? <a class="param internalDFN" href="#dfn-imports" data-link-type="dfn">imports</a>:[<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a>]? <a class="param internalDFN" href="#dfn-shapes" data-link-type="dfn">shapes</a>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>+]? }</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-shapeexpr" class="internalDFN" data-link-type="dfn">shapeExpr</a></th>         <td>=</td> <td><a class="objref internalDFN" href="#dfn-shapeor" data-link-type="dfn">ShapeOr</a> | <a class="objref internalDFN" href="#dfn-shapeand" data-link-type="dfn">ShapeAnd</a> | <a class="objref internalDFN" href="#dfn-shapenot" data-link-type="dfn">ShapeNot</a> | <a class="objref internalDFN" href="#dfn-nodeconstraint" data-link-type="dfn">NodeConstraint</a> | <a class="objref internalDFN" href="#dfn-shape" data-link-type="dfn">Shape</a> | <a class="objref internalDFN" href="#dfn-shapeexternal" data-link-type="dfn">ShapeExternal</a> | <a class="objref internalDFN" href="#dfn-shapeexprrefs" data-link-type="dfn">shapeExprRef</a> ;</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-shapeor" class="internalDFN" data-link-type="dfn">ShapeOr</a></th>             <td>{</td> <td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">shapeExprs</span>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>{2,}] }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-shapeand" class="internalDFN" data-link-type="dfn">ShapeAnd</a></th>           <td>{</td> <td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">shapeExprs</span>:[<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>{2,}] }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-shapenot" class="internalDFN" data-link-type="dfn">ShapeNot</a></th>           <td>{</td> <td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">shapeExpr</span>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a> }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-shapeexternal" class="internalDFN" data-link-type="dfn">ShapeExternal</a></th> <td>{</td> <td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? }</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-shapeexprrefs" class="internalDFN" data-link-type="dfn">shapeExprRef</a></th>           <td>=</td> <td><a class="objref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a> ;</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-shapeexprlabel" class="internalDFN" data-link-type="dfn">shapeExprLabel</a></th>       <td>=</td> <td><a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a href="#dfn-bnode" class="internalDFN" data-link-type="dfn">BNODE</a> ;</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-nodeconstraint" class="internalDFN" data-link-type="dfn">NodeConstraint</a></th> <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">nodeKind</span>:(<span class="literal">"iri"</span> | <span class="literal">"bnode"</span> | <span class="literal">"nonliteral"</span> | <span class="literal">"literal"</span>)? <span class="param">datatype</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a>? <a class="nobref internalDFN" href="#dfn-xsfacet" data-link-type="dfn">xsFacet</a>* <span class="param">values</span>:[<a class="nobref internalDFN" href="#dfn-valuesetvalue" data-link-type="dfn">valueSetValue</a>]? }</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-xsfacet" class="internalDFN" data-link-type="dfn">xsFacet</a></th>               <td>=</td><td><a class="nobref internalDFN" href="#dfn-stringfacet" data-link-type="dfn">stringFacet</a> | <a class="nobref internalDFN" href="#dfn-numericfacet" data-link-type="dfn">numericFacet</a> ;</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-stringfacet" class="internalDFN" data-link-type="dfn">stringFacet</a></th>       <td>=</td><td>(<span class="param">length</span>|<span class="param">minlength</span>|<span class="param">maxlength</span>):<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a> | <span class="param">pattern</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a> <span class="param">flags</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? ;</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-numericfacet" class="internalDFN" data-link-type="dfn">numericFacet</a></th>     <td>=</td><td>(<span class="param">mininclusive</span>|<span class="param">minexclusive</span>|<span class="param">maxinclusive</span>|<span class="param">maxexclusive</span>):<a class="nobref internalDFN" href="#dfn-numericliteral" data-link-type="dfn">numericLiteral</a> </td></tr>
  <tr><th></th><td>|</td><td>(<span class="param">totaldigits</span>|<span class="param">fractiondigits</span>):<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a> ;</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-numericliteral" class="internalDFN" data-link-type="dfn">numericLiteral</a></th> <td>=</td><td><a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a> | <a href="#dfn-decimal" class="internalDFN" data-link-type="dfn">DECIMAL</a> | <a href="#dfn-double" class="internalDFN" data-link-type="dfn">DOUBLE</a> ;</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-valuesetvalue" class="internalDFN" data-link-type="dfn">valueSetValue</a></th><td>=</td><td><a class="nobref internalDFN" href="#dfn-objectvalue" data-link-type="dfn">objectValue</a> | <a class="objref internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a> | <a class="objref internalDFN" href="#dfn-iristemrange" data-link-type="dfn">IriStemRange</a> | <a class="objref internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a> | <a class="objref internalDFN" href="#dfn-literalstemrange" data-link-type="dfn">LiteralStemRange</a> | <a class="objref internalDFN" href="#dfn-language" data-link-type="dfn">Language</a> | <a class="objref internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a> | <a class="objref internalDFN" href="#dfn-languagestemrange" data-link-type="dfn">LanguageStemRange</a> ;</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-objectvalue" class="internalDFN" data-link-type="dfn">objectValue</a></th><td>=</td><td><a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a href="#dfn-objectliteral" class="internalDFN" data-link-type="dfn">ObjectLiteral</a> ;</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-objectliteral" class="internalDFN" data-link-type="dfn">ObjectLiteral</a></th><td>{</td><td><span class="param">value</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a> <span class="param">language</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? <span class="param">type</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-iristem" class="internalDFN" data-link-type="dfn">IriStem</a></th><td>{</td><td><span class="param">stem</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-iristemrange" class="internalDFN" data-link-type="dfn">IriStemRange</a></th><td>{</td><td><span class="param">stem</span>:(<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-iriref" data-link-type="dfn">IRIREF</a>|<a class="objref internalDFN" href="#dfn-iristem" data-link-type="dfn">IriStem</a> +] }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-literalstem" class="internalDFN" data-link-type="dfn">LiteralStem</a></th><td>{</td><td><span class="param">stem</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a> }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-literalstemrange" class="internalDFN" data-link-type="dfn">LiteralStemRange</a></th><td>{</td><td><span class="param">stem</span>:(<a class="nobref internalDFN" href="#dfn-string" data-link-type="dfn">STRING</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-string" data-link-type="dfn">STRING</a>|<a class="objref internalDFN" href="#dfn-literalstem" data-link-type="dfn">LiteralStem</a> +] }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-language" class="internalDFN" data-link-type="dfn">Language</a></th><td>{</td><td><span class="param">languageTag</span>:<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-languagestem" class="internalDFN" data-link-type="dfn">LanguageStem</a></th><td>{</td><td><span class="param">stem</span>:<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-languagestemrange" class="internalDFN" data-link-type="dfn">LanguageStemRange</a></th><td>{</td><td><span class="param">stem</span>:(<a href="#dfn-langtag" class="internalDFN" data-link-type="dfn">LANGTAG</a> | <a class="objref internalDFN" href="#dfn-wildcard" data-link-type="dfn">Wildcard</a>) <span class="param">exclusions</span>:[<a class="nobref internalDFN" href="#dfn-langtag" data-link-type="dfn">LANGTAG</a>|<a class="objref internalDFN" href="#dfn-languagestem" data-link-type="dfn">LanguageStem</a> +] }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-wildcard" class="internalDFN" data-link-type="dfn">Wildcard</a></th>             <td>{</td><td><span class="comment">/* empty */</span> }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-shape" class="internalDFN" data-link-type="dfn">Shape</a></th>                       <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-shapeexprlabel" data-link-type="dfn">shapeExprLabel</a>? <span class="param">closed</span>:<a href="#dfn-bool" class="internalDFN" data-link-type="dfn">BOOL</a>? <span class="param">extra</span>:[<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a>]? <span class="param">expression</span>:<a class="nobref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-tripleexpr" class="internalDFN" data-link-type="dfn">tripleExpr</a></th>             <td>=</td><td><a class="objref internalDFN" href="#dfn-eachof" data-link-type="dfn">EachOf</a> | <a class="objref internalDFN" href="#dfn-oneof" data-link-type="dfn">OneOf</a> | <a class="objref internalDFN" href="#dfn-tripleconstraint" data-link-type="dfn">TripleConstraint</a> | <a class="objref internalDFN" href="#dfn-tripleexprref" data-link-type="dfn">tripleExprRef</a> ;</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-eachof" class="internalDFN" data-link-type="dfn">EachOf</a></th>                     <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a>? <span class="param">expressions</span>:[<a class="nobref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>{2,}] <span class="param">min</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">max</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-oneof" class="internalDFN" data-link-type="dfn">OneOf</a></th>                       <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a>? <span class="param">expressions</span>:[<a class="nobref internalDFN" href="#dfn-tripleexpr" data-link-type="dfn">tripleExpr</a>{2,}] <span class="param">min</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">max</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-tripleconstraint" class="internalDFN" data-link-type="dfn">TripleConstraint</a></th> <td>{</td><td><span class="param">id</span>:<a class="nobref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a>? <span class="param">inverse</span>:<a href="#dfn-bool" class="internalDFN" data-link-type="dfn">BOOL</a>? <a class="param" href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> <span class="param">valueExpr</span>:<a class="nobref internalDFN" href="#dfn-shapeexpr" data-link-type="dfn">shapeExpr</a>? <span class="param">min</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">max</span>:<a href="#dfn-integer" class="internalDFN" data-link-type="dfn">INTEGER</a>? <span class="param">semActs</span>:[<a class="objref internalDFN" href="#dfn-semact" data-link-type="dfn">SemAct</a>+]? <span class="param">annotations</span>:[<a class="objref internalDFN" href="#dfn-annotation" data-link-type="dfn">Annotation</a>+]? }</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-tripleexprref" class="internalDFN" data-link-type="dfn">tripleExprRef</a></th>       <td>=</td><td><a class="objref internalDFN" href="#dfn-tripleexprlabel" data-link-type="dfn">tripleExprLabel</a> ;</td></tr>
  <tr class="nob"><th class="nob"><a href="#dfn-tripleexprlabel" class="internalDFN" data-link-type="dfn">tripleExprLabel</a></th>   <td>=</td><td><a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> | <a href="#dfn-bnode" class="internalDFN" data-link-type="dfn">BNODE</a> ;</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-semact" class="internalDFN" data-link-type="dfn">SemAct</a></th><td>{</td><td><span class="param">name</span>:<a href="#dfn-iriref" class="internalDFN" data-link-type="dfn">IRIREF</a> <span class="param">code</span>:<a href="#dfn-string" class="internalDFN" data-link-type="dfn">STRING</a>? }</td></tr>
  <tr class="obj"><th class="obj"><a href="#dfn-annotation" class="internalDFN" data-link-type="dfn">Annotation</a></th><td>{</td><td><span class="param"><a href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a></span>:<a href="https://www.w3.org/TR/rdf11-concepts/#dfn-iri">IRI</a> <span class="param">object</span>:<a class="nobref internalDFN" href="#dfn-objectvalue" data-link-type="dfn">objectValue</a> }</td></tr>

  <tr style="background-color:white; border-left: thin solid white; border-right: thin solid white; "><th colspan="1" style="text-align: left;">Terminals</th><td></td><td>These follow the <a href="http://www.w3.org/TR/2008/PER-xml-20080205/#sec-common-syn">rules for terminals in the XML 1.0 5th Edition</a></td></tr>

  <tr class="trm"><td></td><td><span class="comment">#</span></td><td><span class="comment"><a href="http://www.w3.org/TR/turtle/#grammar-production-IRIREF">Turtle IRIREF</a> without enclosing "&lt;&gt;"s</span></td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-iriref">IRIREF</dfn></th>              <td>:</td><td>(<a href="#dfn-pn_chars" class="internalDFN" data-link-type="dfn">PN_CHARS</a> | '.' | ':' | '/' | '\\' | '#' | '@' | '%' | '&amp;' | <a href="#dfn-uchar" class="internalDFN" data-link-type="dfn">UCHAR</a>)* ;</td></tr>
  <tr class="trm"><td></td><td><span class="comment">#</span></td><td><span class="comment"><a href="http://www.w3.org/TR/turtle/#grammar-production-BLANK_NODE_LABEL">Turtle BLANK_NODE_LABEL</a></span></td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-bnode">BNODE</dfn></th>            <td>:</td><td>'_:' (<a href="#dfn-pn_chars_u" class="internalDFN" data-link-type="dfn">PN_CHARS_U</a> | [0-9]) ((<a href="#dfn-pn_chars" class="internalDFN" data-link-type="dfn">PN_CHARS</a> | '.')* <a href="#dfn-pn_chars" class="internalDFN" data-link-type="dfn">PN_CHARS</a>)? ;</td></tr>
  <tr class="trm"><td></td><td><span class="comment">#</span></td><td><span class="comment"><a href="https://tools.ietf.org/html/rfc7159#section-3">JSON boolean values</a></span></td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-bool">BOOL</dfn></th>             <td>:</td><td>"true" | "false" ;</td></tr>
  <tr class="trm"><td></td><td><span class="comment">#</span></td><td><span class="comment"><a href="http://www.w3.org/TR/turtle/#grammar-production-INTEGER">Turtle INTEGER</a></span></td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-integer">INTEGER</dfn></th>          <td>:</td><td>[+-]? [0-9] + ;</td></tr>
  <tr class="trm"><td></td><td><span class="comment">#</span></td><td><span class="comment"><a href="http://www.w3.org/TR/turtle/#grammar-production-DECIMAL">Turtle DECIMAL</a></span></td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-decimal">DECIMAL</dfn></th>          <td>:</td><td>[+-]? [0-9]* '.' [0-9] + ;</td></tr>
  <tr class="trm"><td></td><td><span class="comment">#</span></td><td><span class="comment"><a href="http://www.w3.org/TR/turtle/#grammar-production-DOUBLE">Turtle DOUBLE</a></span></td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-double">DOUBLE</dfn></th>           <td>:</td><td>[+-]? ([0-9] + '.' [0-9]* <a href="#dfn-exponent" class="internalDFN" data-link-type="dfn">EXPONENT</a> | '.' [0-9]+ <a href="#dfn-exponent" class="internalDFN" data-link-type="dfn">EXPONENT</a> | [0-9]+ <a href="#dfn-exponent" class="internalDFN" data-link-type="dfn">EXPONENT</a>) ;</td></tr>
  <tr class="trm"><td></td><td><span class="comment">#</span></td><td><span class="comment"><a href="https://tools.ietf.org/html/bcp47#section-2.1">BCP47 Language-Tag</a></span></td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-langtag">LANGTAG</dfn></th>          <td>:</td><td>([a-zA-Z])+('-'([a-zA-Z0-9])+)* ;</td></tr>
  <tr class="trm"><td></td><td><span class="comment">#</span></td><td><span class="comment">any <a href="https://tools.ietf.org/html/rfc7159#section-7">JSON string</a></span></td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-string">STRING</dfn></th>           <td>:</td><td>.* ;</td></tr>

  <tr style="background-color:white; border-left: thin solid white; border-right: thin solid white; "><th colspan="1" style="text-align: left;">Components</th><td></td><td>These terminals are referenced by other terminals but not by external productions.</td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-pn_prefix">PN_PREFIX</dfn></th>        <td>:</td><td><a href="#dfn-pn_chars_base" class="internalDFN" data-link-type="dfn">PN_CHARS_BASE</a> ((<a href="#dfn-pn_chars" class="internalDFN" data-link-type="dfn">PN_CHARS</a> | '.')* <a href="#dfn-pn_chars" class="internalDFN" data-link-type="dfn">PN_CHARS</a>)? ;</td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-pn_chars_base">PN_CHARS_BASE</dfn></th>    <td>:</td><td>  [A-Z] | [a-z] | [\u00C0-\u00D6] | [\u00D8-\u00F6]<br />
| [\u00F8-\u02FF] | [\u0370-\u037D] | [\u037F-\u1FFF]<br />
| [\u200C-\u200D] | [\u2070-\u218F] | [\u2C00-\u2FEF]<br />
| [\u3001-\uD7FF] | [\uF900-\uFDCF] | [\uFDF0-\uFFFD]<br />
| [\u10000-\uEFFFF] ;</td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-pn_chars">PN_CHARS</dfn></th>         <td>:</td><td><a href="#dfn-pn_chars_u" class="internalDFN" data-link-type="dfn">PN_CHARS_U</a> | '-' | [0-9] | '\u00B7' | [\u0300-\u036F] | [\u203F-\u2040] ;</td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-pn_chars_u">PN_CHARS_U</dfn></th>       <td>:</td><td><a href="#dfn-pn_chars_base" class="internalDFN" data-link-type="dfn">PN_CHARS_BASE</a> | '_' ;</td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-uchar">UCHAR</dfn></th>            <td>:</td><td>  '\\u' <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a><br />
| '\\U' <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> <a href="#dfn-hex" class="internalDFN" data-link-type="dfn">HEX</a> ;</td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-hex">HEX</dfn></th>              <td>:</td><td>[0-9] | [A-F] | [a-f] ;</td></tr>
  <tr class="trm"><th class="trm"><dfn data-dfn-type="dfn" id="dfn-exponent">EXPONENT</dfn></th> <td>:</td><td>[eE] [+-]? [0-9]+ ;</td></tr>
</tbody></table>

</div>

    </section>


<section id="shexr" class="appendix informative">
  <h2 id="b-shex-shape"><bdi class="secno">B. </bdi>ShEx Shape<a class="self-link" aria-label="§" href="#shexr"></a></h2><p><em>This section is non-normative.</em></p>

  <p>The following schema describes the form of an <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF Graph</a> conforming to a
    Shape Expression <a href="#dfn-shapes-schema" class="internalDFN" data-link-type="dfn">schema</a>, consisten with the description of <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a>.</p>

  <div class="example" id="example-1-shexr-shape-expression-schema">
          <div class="marker">
      <a class="self-link" href="#example-1-shexr-shape-expression-schema">Example<bdi> 1</bdi></a><span class="example-title">: ShExR Shape Expression Schema</span>
    </div> <pre class="nohighlight" data-oninclude="highlightShExC"><span class="keyword">PREFIX</span> sx: <span class="relativeIRI">&lt;http://www.w3.org/ns/shex#&gt;</span>
<span class="keyword">PREFIX</span> xsd: <span class="relativeIRI">&lt;http://www.w3.org/2001/XMLSchema#&gt;</span>
<span class="keyword">PREFIX</span> rdf: <span class="relativeIRI">&lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>
<span class="keyword">BASE</span> <span class="relativeIRI">&lt;http://www.w3.org/ns/shex#&gt;</span>
<span class="keyword">start=</span>@<span class="relativeIRI">&lt;Schema&gt;</span>

<span class="relativeIRI">&lt;Schema&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:Schema]</span> ;
  sx:imports @<span class="relativeIRI">&lt;IriList1Plus&gt;</span>? ;
  sx:startActs @<span class="relativeIRI">&lt;SemActList1Plus&gt;</span>? ;
  sx:start @<span class="relativeIRI">&lt;shapeExpr&gt;</span>?;
  sx:shapes @<span class="relativeIRI">&lt;shapeExpr&gt;</span>*
}

<span class="relativeIRI">&lt;shapeExpr&gt;</span> @<span class="relativeIRI">&lt;ShapeOr&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;ShapeAnd&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;ShapeNot&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;NodeConstraint&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;Shape&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;ShapeExternal&gt;</span>

<span class="relativeIRI">&lt;ShapeOr&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:ShapeOr]</span> ;
  sx:shapeExprs @<span class="relativeIRI">&lt;shapeExprList2Plus&gt;</span>
}

<span class="relativeIRI">&lt;ShapeAnd&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:ShapeAnd]</span> ;
  sx:shapeExprs @<span class="relativeIRI">&lt;shapeExprList2Plus&gt;</span>
}

<span class="relativeIRI">&lt;ShapeNot&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:ShapeNot]</span> ;
  sx:shapeExpr @<span class="relativeIRI">&lt;shapeExpr&gt;</span>
}

<span class="relativeIRI">&lt;NodeConstraint&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:NodeConstraint]</span> ;
  sx:nodeKind <span class="valueSet">[sx:iri sx:bnode sx:literal sx:nonliteral]</span>?;
  sx:datatype <span class="keyword">IRI</span> ? ;
  &amp;<span class="relativeIRI">&lt;xsFacets&gt;</span>  ;
  sx:values @<span class="relativeIRI">&lt;valueSetValueList1Plus&gt;</span>?
}

<span class="relativeIRI">&lt;Shape&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:Shape]</span> ;
  sx:closed <span class="valueSet">[true false]</span>? ;
  sx:extra <span class="keyword">IRI</span>* ;
  sx:expression @<span class="relativeIRI">&lt;tripleExpression&gt;</span>? ;
  sx:semActs @<span class="relativeIRI">&lt;SemActList1Plus&gt;</span>? ;
  sx:annotation @<span class="relativeIRI">&lt;AnnotationList1Plus&gt;</span>? ;
}

<span class="relativeIRI">&lt;ShapeExternal&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:ShapeExternal]</span> ;
}

<span class="relativeIRI">&lt;SemAct&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:SemAct]</span> ;
  sx:name <span class="keyword">IRI</span> ;
  sx:code xsd:string?
}

<span class="relativeIRI">&lt;Annotation&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:Annotation]</span> ;
  sx:predicate <span class="keyword">IRI</span> ;
  sx:object @<span class="relativeIRI">&lt;objectValue&gt;</span>
}

<span class="comment"># <xsfacet> &lt;@stringFacet&gt; <span class="keyword">OR</span> &lt;@numericFacet&gt;</xsfacet></span>
<span class="relativeIRI">&lt;facet_holder&gt;</span> { <span class="comment"># hold labeled productions</span>
  $<span class="relativeIRI">&lt;xsFacets&gt;</span> ( &amp;<span class="relativeIRI">&lt;stringFacet&gt;</span> | &amp;<span class="relativeIRI">&lt;numericFacet&gt;</span> )* ;
  $<span class="relativeIRI">&lt;stringFacet&gt;</span> (
      sx:length xsd:integer
    | sx:minlength xsd:integer
    | sx:maxlength xsd:integer
    | sx:pattern xsd:string ; sx:flags xsd:string?
  );
  $<span class="relativeIRI">&lt;numericFacet&gt;</span> (
      sx:mininclusive   @<span class="relativeIRI">&lt;numericLiteral&gt;</span>
    | sx:minexclusive   @<span class="relativeIRI">&lt;numericLiteral&gt;</span>
    | sx:maxinclusive   @<span class="relativeIRI">&lt;numericLiteral&gt;</span>
    | sx:maxexclusive   @<span class="relativeIRI">&lt;numericLiteral&gt;</span>
    | sx:totaldigits    xsd:integer
    | sx:fractiondigits xsd:integer
  )
}
<span class="relativeIRI">&lt;numericLiteral&gt;</span> xsd:integer <span class="keyword">OR</span> xsd:decimal <span class="keyword">OR</span> xsd:double

<span class="relativeIRI">&lt;valueSetValue&gt;</span> @<span class="relativeIRI">&lt;objectValue&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;IriStem&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;IriStemRange&gt;</span>
                               <span class="keyword">OR</span> @<span class="relativeIRI">&lt;LiteralStem&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;LiteralStemRange&gt;</span>
                <span class="keyword">OR</span> @<span class="relativeIRI">&lt;Language&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;LanguageStem&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;LanguageStemRange&gt;</span>
<span class="relativeIRI">&lt;objectValue&gt;</span> <span class="keyword">IRI</span> <span class="keyword">OR</span> <span class="keyword">LITERAL</span> <span class="comment"># rdf:langString breaks on Annotation.object</span>
<span class="relativeIRI">&lt;Language&gt;</span> <span class="keyword">CLOSED</span> { a <span class="valueSet">[sx:Language]</span>; sx:languageTag xsd:string }
<span class="relativeIRI">&lt;IriStem&gt;</span> <span class="keyword">CLOSED</span> { a <span class="valueSet">[sx:IriStem]</span>; sx:stem xsd:string }
<span class="relativeIRI">&lt;IriStemRange&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:IriStemRange]</span>;
  sx:stem xsd:string <span class="keyword">OR</span> @<span class="relativeIRI">&lt;Wildcard&gt;</span>;
  sx:exclusion @<span class="relativeIRI">&lt;IriStemExclusionList1Plus&gt;</span>
}
<span class="relativeIRI">&lt;LiteralStem&gt;</span> <span class="keyword">CLOSED</span> { a <span class="valueSet">[sx:LiteralStem]</span>; sx:stem xsd:string }
<span class="relativeIRI">&lt;LiteralStemRange&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:LiteralStemRange]</span>;
  sx:stem xsd:string <span class="keyword">OR</span> @<span class="relativeIRI">&lt;Wildcard&gt;</span>;
  sx:exclusion @<span class="relativeIRI">&lt;LiteralStemExclusionList1Plus&gt;</span>
}
<span class="relativeIRI">&lt;LanguageStem&gt;</span> <span class="keyword">CLOSED</span> { a <span class="valueSet">[sx:LanguageStem]</span>; sx:stem xsd:string }
<span class="relativeIRI">&lt;LanguageStemRange&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:LanguageStemRange]</span>;
  sx:stem xsd:string <span class="keyword">OR</span> @<span class="relativeIRI">&lt;Wildcard&gt;</span>;
  sx:exclusion @<span class="relativeIRI">&lt;LanguageStemExclusionList1Plus&gt;</span>
}
<span class="relativeIRI">&lt;Wildcard&gt;</span> <span class="keyword">BNODE</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:Wildcard]</span>
}

<span class="relativeIRI">&lt;tripleExpression&gt;</span> @<span class="relativeIRI">&lt;TripleConstraint&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;OneOf&gt;</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;EachOf&gt;</span> <span class="keyword">OR</span> <span class="keyword">CLOSED</span> {  }

<span class="relativeIRI">&lt;OneOf&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:OneOf]</span> ;
  sx:min xsd:integer? ;
  sx:max xsd:integer? ;
  sx:expressions @<span class="relativeIRI">&lt;tripleExpressionList2Plus&gt;</span> ;
  sx:semActs @<span class="relativeIRI">&lt;SemActList1Plus&gt;</span>? ;
  sx:annotation @<span class="relativeIRI">&lt;AnnotationList1Plus&gt;</span>?
}

<span class="relativeIRI">&lt;EachOf&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:EachOf]</span> ;
  sx:min xsd:integer? ;
  sx:max xsd:integer? ;
  sx:expressions @<span class="relativeIRI">&lt;tripleExpressionList2Plus&gt;</span> ;
  sx:semActs @<span class="relativeIRI">&lt;SemActList1Plus&gt;</span>? ;
  sx:annotation @<span class="relativeIRI">&lt;AnnotationList1Plus&gt;</span>?
}

<span class="relativeIRI">&lt;tripleExpressionList2Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first @<span class="relativeIRI">&lt;tripleExpression&gt;</span> ;
  rdf:rest @<span class="relativeIRI">&lt;tripleExpressionList1Plus&gt;</span>
}
<span class="relativeIRI">&lt;tripleExpressionList1Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first @<span class="relativeIRI">&lt;tripleExpression&gt;</span> ;
  rdf:rest  <span class="valueSet">[rdf:nil]</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;tripleExpressionList1Plus&gt;</span>
}

<span class="relativeIRI">&lt;TripleConstraint&gt;</span> <span class="keyword">CLOSED</span> {
  a <span class="valueSet">[sx:TripleConstraint]</span> ;
  sx:inverse <span class="valueSet">[true false]</span>? ;
  sx:negated <span class="valueSet">[true false]</span>? ;
  sx:min xsd:integer? ;
  sx:max xsd:integer? ;
  sx:predicate <span class="keyword">IRI</span> ;
  sx:valueExpr @<span class="relativeIRI">&lt;shapeExpr&gt;</span>? ;
  sx:semActs @<span class="relativeIRI">&lt;SemActList1Plus&gt;</span>? ;
  sx:annotation @<span class="relativeIRI">&lt;AnnotationList1Plus&gt;</span>?
}

<span class="relativeIRI">&lt;IriList1Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first <span class="keyword">IRI</span> ;
  rdf:rest  <span class="valueSet">[rdf:nil]</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;IriList1Plus&gt;</span>
}

<span class="relativeIRI">&lt;SemActList1Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first @<span class="relativeIRI">&lt;SemAct&gt;</span> ;
  rdf:rest  <span class="valueSet">[rdf:nil]</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;SemActList1Plus&gt;</span>
}

<span class="relativeIRI">&lt;shapeExprList2Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first @<span class="relativeIRI">&lt;shapeExpr&gt;</span> ;
  rdf:rest  @<span class="relativeIRI">&lt;shapeExprList1Plus&gt;</span>
}
<span class="relativeIRI">&lt;shapeExprList1Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first @<span class="relativeIRI">&lt;shapeExpr&gt;</span> ;
  rdf:rest  <span class="valueSet">[rdf:nil]</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;shapeExprList1Plus&gt;</span>
}

<span class="relativeIRI">&lt;valueSetValueList1Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first @<span class="relativeIRI">&lt;valueSetValue&gt;</span> ;
  rdf:rest  <span class="valueSet">[rdf:nil]</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;valueSetValueList1Plus&gt;</span>
}

<span class="relativeIRI">&lt;AnnotationList1Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first @<span class="relativeIRI">&lt;Annotation&gt;</span> ;
  rdf:rest  <span class="valueSet">[rdf:nil]</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;AnnotationList1Plus&gt;</span>
}

<span class="relativeIRI">&lt;IriStemExclusionList1Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first <span class="keyword">IRI</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;IriStem&gt;</span> ;
  rdf:rest  <span class="valueSet">[rdf:nil]</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;IriStemExclusionList1Plus&gt;</span>
}

<span class="relativeIRI">&lt;LiteralStemExclusionList1Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first xsd:string <span class="keyword">OR</span> @<span class="relativeIRI">&lt;LiteralStem&gt;</span> ;
  rdf:rest  <span class="valueSet">[rdf:nil]</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;LiteralStemExclusionList1Plus&gt;</span>
}

<span class="relativeIRI">&lt;LanguageStemExclusionList1Plus&gt;</span> <span class="keyword">CLOSED</span> {
  rdf:first xsd:string <span class="keyword">OR</span> @<span class="relativeIRI">&lt;LanguageStem&gt;</span> ;
  rdf:rest  <span class="valueSet">[rdf:nil]</span> <span class="keyword">OR</span> @<span class="relativeIRI">&lt;LanguageStemExclusionList1Plus&gt;</span>
}
</pre>
        </div>
</section>

<section class="appendix normative">
  <h2>IANA Considerations</h2>

  <p>This section has been submitted to the Internet Engineering Steering
    Group (IESG) for review, approval, and registration with IANA.</p>

  <h3>text/shex</h3>
  <dl>
    <dt>Type name:</dt>
    <dd>text</dd>
    <dt>Subtype name:</dt>
    <dd>shex</dd>
    <dt>Required parameters:</dt>
    <dd>None</dd>
    <dt>Optional parameters:</dt>
    <dd>None</dd>
    <dt>Encoding considerations:</dt>
    <dd>8-bit text</dd>
    <dd>ShEx Compact Syntax (ShExC) is a text language which is encoded in UTF-8.</dd>
    <dt>Security considerations:</dt>
    <dd>Given that <a>ShExC</a> allows the substitution of long IRIs with short terms,
      <a>ShExC</a> documents may expand considerably when processed and, in the worst case,
      the resulting data might consume all of the recipient's resources. Applications
      should treat any data with due skepticism.</dd>
    <dt>Interoperability considerations:</dt>
    <dd>Not Applicable</dd>
    <dt>Published specification:</dt>
    <dd><a href="http://shex.io/shex-semantics/">http://shex.io/shex-semantics/</a></dd>
    <dt>Applications that use this media type:</dt>
    <dd>Any programming environment that requires the exchange of
      directed graphs. Implementations of ShEx have been created for
      JavaScript, Python, Ruby, and Java.
    </dd>
    <dt>Fragment Identifier Considerations:</dt>
    <dd>
      The structure of a ShEx schema is defined by its representation in JSON per <a href="#shexj">ShEx JSON Syntax (ShExJ)</a>.
      The JSON-LD context &lt;<a href="http://www.w3.org/ns/shex.jsonld">http://www.w3.org/ns/shex.jsonld</a>&gt; defines the RDF representation (ShExR) for every ShEx schema.
      A ShEx fragment identifies an instance of either the <a href="#dfn-shapeexpr">shapeExpr</a> or <a href="#dfn-tripleexpr">tripleExpr</a> ShExJ productions, as well as the RDF resource (see <a data-cite="RDF11-CONCEPTS#section-fragID" href="https://www.w3.org/TR/rdf11-concepts/#section-fragID">RDF 1.1 Concepts and Abstract Syntax</a> §6 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS<!---0.344445%--></a></cite><!---0.344445%-->]) in the corresponding ShExR.</dd>
    <dt>Restrictions on Usage:</dt>
    <dd>None</dd>
    <dt>Provisional Registrations:</dt>
    <dd>Not Applicable</dd>
    <dt>Additional information:</dt>
    <dd><dl>
      <dt>Deprecated alias names for this type:</dt>
      <dd>None</dd>
      <dt>Magic number(s):</dt>
      <dd></dd>
      <dt>File extension(s):</dt>
      <dd>.shex</dd>
      <dt>Macintosh file type code(s):</dt>
      <dd>TEXT</dd>
    </dl></dd>
    <dt>Intended usage:</dt>
    <dd>Common</dd>
    <dt>Other Information &amp; Comments:</dt>
    <dd>None</dd>
    <dt>Contact Person:</dt>
    <dd><dl>
      <dt>Contact Name:</dt>
      <dd>Eric Prud'hommeaux</dd>
      <dt>Contact Email Address:</dt>
      <dd>eric@w3.org</dd>
      <dt>Change controller:</dt>
      <dd>W3C</dd>
    </dl></dd>
  </dl>
</section>

    <section id="security">
      <h2 id="d-security-considerations"><bdi class="secno">D. </bdi>Security Considerations<a class="self-link" aria-label="§" href="#security"></a></h2>
      <p>
        Revealing the structure of an RDF graph can reveal information about the content of conformant data.
        For instance, a schema with a predicate to describe cancer stage indicates that conforming graphs describe patients with cancer.
      </p>
      <p>
        The process of testing a graph's conformance to a schema may involve many detailed queries which could draw resources to respond to API calls or SPARQL queries.
      </p>
      <p>
        ShEx has an extension mechanism which can, in principle, evalute arbitrary code, possibly as some trusted agent.
        Such extensions should not be executed if they don't come from a trusted source.
      </p>
      <p>
        Since <a href="#dfn-shex" class="internalDFN" data-link-type="dfn">ShEx</a> is intended to be a pure data exchange format for validating <a data-link-type="dfn" href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graphs</a>, the <a href="#dfn-shexj" class="internalDFN" data-link-type="dfn">ShExJ</a> serialization <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> be passed through a code execution mechanism such as JavaScript's <code>eval()</code> function to be parsed.
        An (invalid) document may contain code that, when executed, could lead to unexpected side effects compromising the security of a system.</p>
        <p>
          See also, <a href="#iana-considerations" class="sectionRef sec-ref">§ <bdi class="secno">C. </bdi>IANA Considerations</a>.
        </p>
    </section>
    
    
    
  

<section id="references" class="appendix">
      <h2 id="e-references"><bdi class="secno">E. </bdi>References<a class="self-link" aria-label="§" href="#references"></a></h2>
      
    <section id="normative-references">
        <h3 id="e-1-normative-references"><bdi class="secno">E.1 </bdi>Normative references<a class="self-link" aria-label="§" href="#normative-references"></a></h3>
      <dl class="bibliography">
        <dt id="bib-ecmascript-6.0">[ECMASCRIPT-6.0]</dt><dd><a href="http://www.ecma-international.org/ecma-262/6.0/index.html"><cite>ECMA-262 6th Edition, The ECMAScript 2015 Language Specification</cite></a>. Allen Wirfs-Brock.  Ecma International. June 2015. Standard. URL: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html">http://www.ecma-international.org/ecma-262/6.0/index.html</a></dd><dt id="bib-json-ld">[JSON-LD]</dt><dd><a href="https://www.w3.org/TR/json-ld/"><cite>JSON-LD 1.0</cite></a>. Manu Sporny; Gregg Kellogg; Markus Lanthaler.  W3C. 16 January 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/json-ld/">https://www.w3.org/TR/json-ld/</a></dd><dt id="bib-rdf11-concepts">[RDF11-CONCEPTS]</dt><dd><a href="https://www.w3.org/TR/rdf11-concepts/"><cite>RDF 1.1 Concepts and Abstract Syntax</cite></a>. Richard Cyganiak; David Wood; Markus Lanthaler.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf11-concepts/">https://www.w3.org/TR/rdf11-concepts/</a></dd><dt id="bib-rdf11-mt">[rdf11-mt]</dt><dd><a href="https://www.w3.org/TR/rdf11-mt/"><cite>RDF 1.1 Semantics</cite></a>. Patrick Hayes; Peter Patel-Schneider.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf11-mt/">https://www.w3.org/TR/rdf11-mt/</a></dd><dt id="bib-rfc2119">[RFC2119]</dt><dd><a href="https://tools.ietf.org/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a></dd><dt id="bib-rfc4647">[rfc4647]</dt><dd><a href="https://tools.ietf.org/html/rfc4647"><cite>Matching of Language Tags</cite></a>. A. Phillips; M. Davis.  IETF. September 2006. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc4647">https://tools.ietf.org/html/rfc4647</a></dd><dt id="bib-rfc7159">[rfc7159]</dt><dd><a href="https://tools.ietf.org/html/rfc7159"><cite>The JavaScript Object Notation (JSON) Data Interchange Format</cite></a>. T. Bray, Ed..  IETF. March 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7159">https://tools.ietf.org/html/rfc7159</a></dd><dt id="bib-rfc8174">[RFC8174]</dt><dd><a href="https://tools.ietf.org/html/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc8174">https://tools.ietf.org/html/rfc8174</a></dd><dt id="bib-shape-map">[shape-map]</dt><dd><a href="http://shex.io/shape-map/"><cite>ShapeMap Structure and Language</cite></a>. Eric Prud'hommeaux; Thomas Baker. URL: <a href="http://shex.io/shape-map/">http://shex.io/shape-map/</a></dd><dt id="bib-shex-vocab">[shex-vocab]</dt><dd><a href="http://www.w3.org/ns/shex#"><cite>Shape Expression Vocabulary</cite></a>. Gregg Kellogg. URL: <a href="http://www.w3.org/ns/shex#">http://www.w3.org/ns/shex#</a></dd><dt id="bib-sparql11-query">[sparql11-query]</dt><dd><a href="https://www.w3.org/TR/sparql11-query/"><cite>SPARQL 1.1 Query Language</cite></a>. Steven Harris; Andy Seaborne.  W3C. 21 March 2013. W3C Recommendation. URL: <a href="https://www.w3.org/TR/sparql11-query/">https://www.w3.org/TR/sparql11-query/</a></dd><dt id="bib-turtle">[turtle]</dt><dd><a href="https://www.w3.org/TR/turtle/"><cite>RDF 1.1 Turtle</cite></a>. Eric Prud'hommeaux; Gavin Carothers.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/turtle/">https://www.w3.org/TR/turtle/</a></dd><dt id="bib-xml">[XML]</dt><dd><a href="https://www.w3.org/TR/xml/"><cite>Extensible Markup Language (XML) 1.0 (Fifth Edition)</cite></a>. Tim Bray; Jean Paoli; Michael Sperberg-McQueen; Eve Maler; François Yergeau et al.  W3C. 26 November 2008. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xml/">https://www.w3.org/TR/xml/</a></dd><dt id="bib-xmlschema-2">[xmlschema-2]</dt><dd><a href="https://www.w3.org/TR/xmlschema-2/"><cite>XML Schema Part 2: Datatypes Second Edition</cite></a>. Paul V. Biron; Ashok Malhotra.  W3C. 28 October 2004. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmlschema-2/">https://www.w3.org/TR/xmlschema-2/</a></dd><dt id="bib-xpath-functions">[xpath-functions]</dt><dd><a href="https://www.w3.org/TR/xpath-functions/"><cite>XQuery 1.0 and XPath 2.0 Functions and Operators (Second Edition)</cite></a>. Ashok Malhotra; Jim Melton; Norman Walsh; Michael Kay.  W3C. 14 December 2010. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xpath-functions/">https://www.w3.org/TR/xpath-functions/</a></dd><dt id="bib-xpath-functions-31">[xpath-functions-31]</dt><dd><a href="https://www.w3.org/TR/xpath-functions-31/"><cite>XPath and XQuery Functions and Operators 3.1</cite></a>. Michael Kay.  W3C. 21 March 2017. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xpath-functions-31/">https://www.w3.org/TR/xpath-functions-31/</a></dd><dt id="bib-xpath20">[xpath20]</dt><dd><a href="https://www.w3.org/TR/xpath20/"><cite>XML Path Language (XPath) 2.0 (Second Edition)</cite></a>. Anders Berglund; Scott Boag; Don Chamberlin; Mary Fernandez; Michael Kay; Jonathan Robie; Jerome Simeon et al.  W3C. 14 December 2010. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xpath20/">https://www.w3.org/TR/xpath20/</a></dd>
      </dl></section></section><p role="navigation" id="back-to-top"><a href="#title"><abbr title="Back to Top">↑</abbr></a></p><script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script></body></html>
